(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{fAJX:function(e,t,i){"use strict";i.r(t),i.d(t,"OrderModule",(function(){return Sr}));var r=i("ofXK"),n=i("3Pt+"),a=i("tyNb"),o=i("fXoL");let s=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Db({type:e,selectors:[["app-orders-component"]],decls:1,vars:0,template:function(e,t){1&e&&o.Kb(0,"router-outlet")},directives:[a.j],styles:[""]}),e})();var d=i("NJqk"),c=i("5TcN"),l=i("ZgVV"),b=i("ZOsW"),u=i("njyG"),p=i("uoBr");function h(e,t){if(1&e&&(o.Pb(0,"ng-option",69),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.id),o.yb(1),o.xc(" ",e.name," ")}}function m(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.Pb(2,"div",70),o.Kb(3,"input",71),o.Kb(4,"label",72),o.Ob(),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.vc(8),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Zb(11,"number"),o.Ob(),o.Pb(12,"td"),o.Pb(13,"button",73),o.Wb("click",(function(){o.oc(e);const i=t.$implicit,r=o.Yb();return r.showDetailsPopup=!0,r.openDetailsModal(i)})),o.vc(14,"Detail"),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=t.index;o.yb(3),o.ec("id",i),o.yb(1),o.ec("for",i),o.yb(2),o.wc(e.emp_name),o.yb(2),o.wc(e.retailer_name),o.yb(2),o.wc(o.bc(11,5,e.order_total,"1.2-2"))}}function g(e,t){if(1&e&&(o.Pb(0,"ng-option",69),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.id),o.yb(1),o.xc(" ",e.name," ")}}function v(e,t){if(1&e&&(o.Pb(0,"ng-option",69),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e),o.yb(1),o.wc(e.name)}}const O=function(e,t){return["/orders/order-list-details",e,t]};function P(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.Pb(8,"ng-select",75),o.Wb("change",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).addOrderToAssignment(i)}))("ngModelChange",(function(i){return o.oc(e),t.$implicit.selectedSaleman=i})),o.tc(9,v,2,2,"ng-option",53),o.Ob(),o.Ob(),o.Pb(10,"td"),o.Pb(11,"a",76),o.vc(12,"View Orders"),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=t.index,r=o.Yb(2);o.yb(2),o.wc(e.date),o.yb(2),o.wc(e.emp_name),o.yb(2),o.wc(e.total_orders),o.yb(2),o.gc("name","select-saleman-",i,""),o.gc("id","select-saleman-",i,""),o.ec("multiple",!1)("ngModel",e.selectedSaleman),o.yb(1),o.ec("ngForOf",r.salesMen),o.yb(2),o.ec("routerLink",o.jc(9,O,e.employee_id,e.date))}}function _(e,t){if(1&e&&(o.Pb(0,"table",74),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"Date"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Order Booker"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Total Orders"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Assign To Salesman"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(13,"tbody"),o.tc(14,P,13,12,"tr",57),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("dtOptions",e.dtOptions),o.yb(14),o.ec("ngForOf",e.orders)}}function f(e,t){1&e&&(o.Pb(0,"div",42),o.Kb(1,"app-loader-white"),o.Ob())}function y(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",58),o.Pb(1,"div",59),o.Pb(2,"div",62),o.Pb(3,"button",77),o.Wb("click",(function(){return o.oc(e),o.Yb().assignSaleman()})),o.vc(4),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(3),o.ec("disabled",0===e.selectedOrders.length),o.yb(1),o.wc(0===e.selectedOrders.length?"Select Salesman":"Assign Salesman")}}let x=(()=>{class e{constructor(e,t,i){this.generalDataService=e,this.ordersService=t,this.toastService=i,this.orderBookers=[],this.salesMen=[],this.orders=[],this.dtOptions={},this.selectedOrders=[]}ngOnInit(){this.byOrderBooker=!0,this.dtOptions={pagingType:"simple_numbers"},this.getAllSalesMen(),this.getNewOrders()}getAllSalesMen(){this.generalDataService.getAllSalesMen().subscribe(e=>{200===e.status&&(this.salesMen=e.data)},e=>{401!==e.status&&1!==e.status&&this.toastService.showToaster({title:"Error:",message:"Salesmen not fetched, try again later.",type:"error"})})}getNewOrders(){this.loading=!0,this.ordersService.getNewOrders().subscribe(e=>{this.loading=!1,200===e.status&&(this.orders=e.data)},e=>{this.loading=!1,401!==e.status&&1!==e.status&&this.toastService.showToaster({title:"Error:",message:"New Orders not fetched, try again later.",type:"error"}),scrollTo(0,0)})}addOrderToAssignment(e){this.selectedOrders=this.selectedOrders.filter(t=>t.id!==e.id),this.selectedOrders.push({sales_man:e.selectedSaleman.id,employee_id:e.employee_id,id:e.id,date:e.date})}assignSaleman(){if(this.selectedOrders.length){const e={salesman:this.selectedOrders.map(e=>{const{sales_man:t,employee_id:i,date:r}=e;return{sales_man:t,employee_id:i,date:r}})};this.loading=!0,this.ordersService.assignSalesMan(e).subscribe(e=>{e.status&&(this.toastService.showToaster({title:"Salesman Assigned:",message:"Salesmen assigned to selected order.",type:"success"}),this.selectedOrders.forEach(e=>{this.orders=this.orders.filter(t=>t.id!==e.id)}),this.loading=!1,this.selectedOrders=[])},e=>{this.loading=!1,401!==e.status&&1!==e.status&&this.toastService.showToaster({title:"Error:",message:"Salesmen assignment is not working at the moment, try again later.",type:"error"}),scrollTo(0,0)})}else this.toastService.showToaster({title:"Error:",message:"Please select saleman to assign orders!",type:"error"})}openDetailsModal(e){document.body.classList.add("no-scroll")}closeDetailsModal(){document.body.classList.remove("no-scroll")}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(d.b),o.Jb(c.a),o.Jb(l.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-orders-list"]],decls:284,vars:14,consts:[["id","exampleModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",3,"ngClass"],["role","document",1,"modal-dialog","modal-full","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"close",2,"font-size","30px","outline","none",3,"click"],[1,"modal-body","p-0"],[1,"container"],[1,"row"],[1,"col-12"],[1,"card"],[1,"p-10",2,"border-bottom","solid 2px #000"],[1,"row","m-0"],[1,"col-8","OrderLogo"],["src","assets/images/sell-360.svg","alt",""],[1,"col-4","ord-no"],[1,"body",2,"padding","15px 20px"],[1,"form-body"],[1,"row","OrderInfo"],[1,"col-md-9"],[1,"col-md-3","p-0"],[1,"seprator-block"],[1,"Order-Detail-table","mt-30"],[1,"table"],[1,"order_items_body"],[1,"border-0"],[2,"background-color","#000","color","#fff"],[1,"clearfix"],[1,"modal-footer","button-list"],["type","button",1,"btn","btn-primary","btn-outline"],[1,"fa","fa-file-pdf"],[1,"fa","fa-envelope"],[1,"fa","fa-print"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],["routerLink","/orders"],[1,"col-lg-12"],[1,"header-tabs","mb-0",2,"min-height","47px"],[1,"col-auto"],["id","nav-tab","role","tablist",1,"nav","nav-tabs"],["id","ProcessedOrder-tab","data-toggle","tab","role","tab","aria-controls","ProcessedOrder","aria-selected","false",1,"nav-item","nav-link",3,"ngClass","click"],[1,"col-md-12"],["id","nav-tabContent",1,"tab-content"],["id","NewOrder","role","tabpanel","aria-labelledby","NewOrder-tab",1,"tab-pane","fade",3,"ngClass"],[1,"Product-Filter","border-0"],[1,"col-auto","pr-0"],[1,"CL-Product",2,"width","180px!important"],["type","text","id","datepicker","placeholder","Select Date",1,"form-control","pl-15"],[1,"col","pl-0"],[1,"_cust_filter"],[1,"form-s2"],["placeholder","Select Order Booker","name","order-booker","id","order-booker",1,"form-control","formselect",2,"width","100%!important",3,"multiple","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"card","p-15"],[1,"col-12","p-0",2,"min-height","360px"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],[4,"ngFor","ngForOf"],[1,"col-12","bottom-gray"],[1,"row","justify-content-end"],[1,"_cust_filter","m-0"],["placeholder","Select Salesman","name","select-saleman","id","select-saleman",1,"form-control","formselect",2,"width","100%!important",3,"ngModel","ngModelChange"],[1,"col-auto","pl-0"],["type","submit",1,"btn","btn-primary"],["id","ProcessedOrder","role","tabpanel","aria-labelledby","ProcessedOrder-tab",1,"tab-pane","fade",3,"ngClass"],[1,"card","p-15","mt-15"],["datatable","","class","table table-hover dt-responsive nowrap","id","example2","style","width:100%",3,"dtOptions",4,"ngIf"],["class","col-md-12",4,"ngIf"],["class","col-12 bottom-gray",4,"ngIf"],[3,"value"],[1,"custom-control","custom-checkbox","cus-che-table"],["type","checkbox","name","","value","",1,"custom-control-input",3,"id"],[1,"custom-control-label",3,"for"],[1,"btn","btn-default","btn-line","mb-0",3,"click"],["datatable","","id","example2",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],["placeholder","Select Salesman",1,"formselect",2,"width","95%!important",3,"name","multiple","ngModel","id","change","ngModelChange"],[1,"btn","btn-default","btn-line","mb-0",3,"routerLink"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"button",4),o.Wb("click",(function(){return t.showDetailsPopup=!1,t.closeDetailsModal()})),o.vc(5,"\xd7"),o.Ob(),o.Ob(),o.Pb(6,"div",5),o.Pb(7,"div",6),o.Pb(8,"div",7),o.Pb(9,"div",8),o.Pb(10,"div",9),o.Pb(11,"div",10),o.Pb(12,"div",11),o.Pb(13,"div",12),o.Kb(14,"img",13),o.Ob(),o.Pb(15,"div",14),o.vc(16," Order # "),o.Pb(17,"strong"),o.vc(18,"05485"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(19,"div",15),o.Pb(20,"div",7),o.Pb(21,"div",8),o.Pb(22,"div",16),o.Pb(23,"div",17),o.Pb(24,"div",18),o.Pb(25,"span"),o.vc(26,"Retailer Name: "),o.Ob(),o.Pb(27,"strong"),o.vc(28,"Chohan Store Township"),o.Ob(),o.Kb(29,"br"),o.Pb(30,"span"),o.vc(31,"Phone No: "),o.Ob(),o.Pb(32,"strong"),o.vc(33,"02222222221"),o.Ob(),o.Kb(34,"br"),o.Pb(35,"span"),o.vc(36,"Location: "),o.Ob(),o.Pb(37,"strong"),o.vc(38,"Madina Market Township, Lahore"),o.Ob(),o.Ob(),o.Pb(39,"div",19),o.Pb(40,"span"),o.vc(41,"Status: "),o.Ob(),o.Pb(42,"strong"),o.vc(43,"Awaiting"),o.Ob(),o.Kb(44,"br"),o.Pb(45,"span"),o.vc(46,"Booking Date: "),o.Ob(),o.Pb(47,"strong"),o.vc(48,"12/04/2020"),o.Ob(),o.Kb(49,"br"),o.Pb(50,"span"),o.vc(51,"Employee: "),o.Ob(),o.Pb(52,"strong"),o.vc(53,"Asad Ali"),o.Ob(),o.Ob(),o.Ob(),o.Kb(54,"div",20),o.Pb(55,"div",21),o.Pb(56,"table",22),o.Pb(57,"thead"),o.Pb(58,"tr"),o.Pb(59,"th"),o.Pb(60,"strong"),o.vc(61,"Code"),o.Ob(),o.Ob(),o.Pb(62,"th"),o.Pb(63,"strong"),o.vc(64,"Product Name"),o.Ob(),o.Ob(),o.Pb(65,"th"),o.Pb(66,"strong"),o.vc(67,"CTN"),o.Ob(),o.Ob(),o.Pb(68,"th"),o.Pb(69,"strong"),o.vc(70,"BOX/PCS"),o.Ob(),o.Ob(),o.Pb(71,"th"),o.Pb(72,"strong"),o.vc(73,"T.P"),o.Ob(),o.Ob(),o.Pb(74,"th"),o.Pb(75,"strong"),o.vc(76,"GR Amt"),o.Ob(),o.Ob(),o.Pb(77,"th"),o.Pb(78,"strong"),o.vc(79,"T.O"),o.Ob(),o.Ob(),o.Pb(80,"th"),o.Pb(81,"strong"),o.vc(82,"T.Disc"),o.Ob(),o.Ob(),o.Pb(83,"th"),o.Pb(84,"strong"),o.vc(85,"SPC.Disc"),o.Ob(),o.Ob(),o.Pb(86,"th"),o.Pb(87,"strong"),o.vc(88,"Net.Amt"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(89,"tbody",23),o.Pb(90,"tr"),o.Pb(91,"td"),o.vc(92,"5261"),o.Ob(),o.Pb(93,"td"),o.vc(94,"AasPas R5 (Chocolate BTNT) (24x36)"),o.Ob(),o.Pb(95,"td"),o.vc(96,"0"),o.Ob(),o.Pb(97,"td"),o.vc(98,"1"),o.Ob(),o.Pb(99,"td"),o.vc(100,"103.25"),o.Ob(),o.Pb(101,"td"),o.vc(102,"103.25"),o.Ob(),o.Pb(103,"td"),o.vc(104,"0"),o.Ob(),o.Pb(105,"td"),o.vc(106,"3%"),o.Ob(),o.Pb(107,"td"),o.vc(108,"0"),o.Ob(),o.Pb(109,"td"),o.vc(110,"100.00"),o.Ob(),o.Ob(),o.Pb(111,"tr"),o.Pb(112,"td"),o.vc(113,"5259"),o.Ob(),o.Pb(114,"td"),o.vc(115,"AasPas Rs2 (chocolate WO BTNT)"),o.Ob(),o.Pb(116,"td"),o.vc(117,"0"),o.Ob(),o.Pb(118,"td"),o.vc(119,"1"),o.Ob(),o.Pb(120,"td"),o.vc(121,"82.61"),o.Ob(),o.Pb(122,"td"),o.vc(123,"82.61"),o.Ob(),o.Pb(124,"td"),o.vc(125,"0"),o.Ob(),o.Pb(126,"td"),o.vc(127,"3%"),o.Ob(),o.Pb(128,"td"),o.vc(129,"5"),o.Ob(),o.Pb(130,"td"),o.vc(131,"75.00"),o.Ob(),o.Ob(),o.Pb(132,"tr"),o.Pb(133,"td"),o.vc(134,"5258"),o.Ob(),o.Pb(135,"td"),o.vc(136,"AasPas Rs5 (Sweet Sonf) (24x24)"),o.Ob(),o.Pb(137,"td"),o.vc(138,"0"),o.Ob(),o.Pb(139,"td"),o.vc(140,"9"),o.Ob(),o.Pb(141,"td"),o.vc(142,"103.26"),o.Ob(),o.Pb(143,"td"),o.vc(144,"929.34"),o.Ob(),o.Pb(145,"td"),o.vc(146,"0"),o.Ob(),o.Pb(147,"td"),o.vc(148,"3%"),o.Ob(),o.Pb(149,"td"),o.vc(150,"1"),o.Ob(),o.Pb(151,"td"),o.vc(152,"900.02"),o.Ob(),o.Ob(),o.Pb(153,"tr"),o.Kb(154,"td",24),o.Kb(155,"td",24),o.Kb(156,"td",24),o.Kb(157,"td",24),o.Kb(158,"td",24),o.Kb(159,"td",24),o.Kb(160,"td",24),o.Kb(161,"td",24),o.Pb(162,"td"),o.Pb(163,"strong"),o.vc(164,"Subtotal PKR."),o.Ob(),o.Ob(),o.Pb(165,"td"),o.Pb(166,"strong"),o.vc(167,"1115.20"),o.Ob(),o.Ob(),o.Ob(),o.Pb(168,"tr"),o.Kb(169,"td",24),o.Kb(170,"td",24),o.Kb(171,"td",24),o.Kb(172,"td",24),o.Kb(173,"td",24),o.Kb(174,"td",24),o.Kb(175,"td",24),o.Kb(176,"td",24),o.Pb(177,"td"),o.Pb(178,"strong"),o.vc(179,"Discount PKR."),o.Ob(),o.Ob(),o.Pb(180,"td"),o.Pb(181,"strong"),o.vc(182,"-40.18"),o.Ob(),o.Ob(),o.Ob(),o.Pb(183,"tr"),o.Kb(184,"td",24),o.Kb(185,"td",24),o.Kb(186,"td",24),o.Kb(187,"td",24),o.Kb(188,"td",24),o.Kb(189,"td",24),o.Kb(190,"td",24),o.Kb(191,"td",24),o.Pb(192,"td",25),o.Pb(193,"strong"),o.vc(194,"Total PKR."),o.Ob(),o.Ob(),o.Pb(195,"td",25),o.Pb(196,"strong"),o.vc(197,"1075.02"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Kb(198,"div",26),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(199,"div",27),o.Pb(200,"button",28),o.Kb(201,"i",29),o.Pb(202,"span"),o.vc(203," Save PDF"),o.Ob(),o.Ob(),o.Pb(204,"button",28),o.Kb(205,"i",30),o.Pb(206,"span"),o.vc(207," Send Email"),o.Ob(),o.Ob(),o.Pb(208,"button",28),o.Kb(209,"i",31),o.Pb(210,"span"),o.vc(211," Print"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(212,"div",6),o.Pb(213,"div",32),o.Pb(214,"div",33),o.Pb(215,"h2",34),o.vc(216,"Orders "),o.Pb(217,"span"),o.vc(218," Management"),o.Ob(),o.Ob(),o.Ob(),o.Pb(219,"div",33),o.Pb(220,"ol",35),o.Pb(221,"li"),o.Pb(222,"a",36),o.Pb(223,"span"),o.vc(224,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(225,"li"),o.Pb(226,"span"),o.vc(227,"List"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(228,"div",7),o.Pb(229,"div",37),o.Pb(230,"div",38),o.Pb(231,"div",7),o.Pb(232,"div",39),o.Pb(233,"div",40),o.Pb(234,"a",41),o.Wb("click",(function(){return t.byOrderBooker=!0})),o.vc(235,"Assign By Order Booker"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(236,"div",7),o.Pb(237,"div",42),o.Pb(238,"div",43),o.Pb(239,"div",44),o.Pb(240,"div",45),o.Pb(241,"div",7),o.Pb(242,"div",46),o.Pb(243,"div",47),o.Kb(244,"input",48),o.Ob(),o.Ob(),o.Pb(245,"div",49),o.Pb(246,"div",50),o.Pb(247,"div",51),o.Pb(248,"ng-select",52),o.Wb("ngModelChange",(function(e){return t.selectedOrderBooker=e})),o.tc(249,h,2,2,"ng-option",53),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Kb(250,"div",26),o.Ob(),o.Pb(251,"div",54),o.Pb(252,"div",55),o.Pb(253,"table",56),o.Pb(254,"thead"),o.Pb(255,"tr"),o.Pb(256,"th"),o.vc(257," Select "),o.Ob(),o.Pb(258,"th"),o.vc(259,"Retailer"),o.Ob(),o.Pb(260,"th"),o.vc(261,"Channel"),o.Ob(),o.Pb(262,"th"),o.vc(263,"Order Total"),o.Ob(),o.Pb(264,"th"),o.vc(265,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(266,"tbody"),o.tc(267,m,15,8,"tr",57),o.Ob(),o.Ob(),o.Ob(),o.Pb(268,"div",58),o.Pb(269,"div",59),o.Pb(270,"div",46),o.Pb(271,"div",60),o.Pb(272,"div",51),o.Pb(273,"ng-select",61),o.Wb("ngModelChange",(function(e){return t.selectedOrderBooker=e})),o.tc(274,g,2,2,"ng-option",53),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(275,"div",62),o.Pb(276,"button",63),o.vc(277,"Assign Orders"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(278,"div",64),o.Pb(279,"div",65),o.Pb(280,"div",55),o.tc(281,_,15,2,"table",66),o.tc(282,f,2,0,"div",67),o.Ob(),o.tc(283,y,5,2,"div",68),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.ec("ngClass",t.showDetailsPopup?"show active":""),o.yb(234),o.ec("ngClass",!0===t.byOrderBooker?"active":""),o.yb(5),o.ec("ngClass",!1===t.byOrderBooker?"active show":""),o.yb(9),o.ec("multiple",!1)("ngModel",t.selectedOrderBooker),o.yb(1),o.ec("ngForOf",t.orderBookers),o.yb(4),o.ec("dtOptions",t.dtOptions),o.yb(14),o.ec("ngForOf",t.orders),o.yb(6),o.ec("ngModel",t.selectedOrderBooker),o.yb(1),o.ec("ngForOf",t.orderBookers),o.yb(4),o.ec("ngClass",!0===t.byOrderBooker?"active show":""),o.yb(3),o.ec("ngIf",!t.loading),o.yb(1),o.ec("ngIf",t.loading),o.yb(1),o.ec("ngIf",!t.loading))},directives:[r.i,a.h,b.a,n.e,n.h,r.j,u.a,r.k,b.c,p.a],pipes:[r.d],styles:[".OrderLogo{text-align:left;padding-left:0}.OrderLogo img{width:auto;height:46px}._cust_filter{padding-left:0!important;padding-top:0!important}._cust_filter .form-s2 .ng-select{padding:0!important;height:30px!important}._cust_filter .form-s2 .ng-select .ng-select-container{width:100%;font-size:14px;border:none;border-radius:0;min-height:30px!important;height:30px!important}.nav-item{cursor:pointer;text-transform:capitalize!important}.CL-Product{padding-top:0!important;margin-left:0!important}.OrderInfo{font-size:14px}.dataTable .btn-default,.smBTN{color:#fff}.OrderInfo span{width:105px;float:left}.Order-Detail-table table td{border:1px solid #333;padding:5px!important;font-size:12px}.Order-Detail-table table th{border:1px solid #333!important;background-color:#ededed!important;color:#000;padding:5px!important;font-size:12px}.button-list .btn-primary{font-size:14px!important;letter-spacing:1px}.button-list .btn-primary .fa{padding-right:3px}.ord-no{padding-top:17px;font-size:14px;text-align:right}.table .select2-container--default .select2-selection--single{border-radius:0;border-color:#ddd}.select2-container .select2-selection--single,.table .select2-container--default .select2-selection--single .select2-selection__rendered{height:26px}.table .select2-container--default .select2-selection--single .select2-selection__arrow{height:24px}.cus-che-table .custom-control-label:after,.cus-che-table .custom-control-label:before{top:-7px;left:0}.cus-che-table{padding:0;margin:0;width:22px}.btn-primary{padding-top:4px;padding-bottom:4px;letter-spacing:1px}.bottom-gray{background-color:#f6f6f6;padding:10px;margin-top:20px}.active{display:block}#example2 .ng-select .ng-select-container{width:100%;font-size:14px;border-radius:0;min-height:25px!important;height:25px!important}#example2 .ng-select .ng-select-container div.ng-input{top:0!important}.ng-select .ng-clear{display:none!important}.Product-Filter{background-color:#f3f2f2;padding:15px 15px 0;box-shadow:0 0 20px 0 rgba(0,0,0,.2);margin-bottom:15px;border-bottom:2px solid #0038ba}.Product-Filter .nav-link{padding:6px 8px 0;cursor:pointer}.Product-Filter .nav{width:74px;float:right}.Product-Filter .nav .fa{color:#a6a5a5;font-size:20px}.Product-Filter .active .fa{color:#0038ba}.CL-Product{width:230px;position:relative;float:left;padding-right:15px}.CL-Product input{height:32px;border:1px solid #dedede;box-shadow:none;padding-left:30px;font-size:13px;letter-spacing:1px}._cust_filter .select2-container .select2-selection--single{background-color:#fff;border-color:#e4e4e4;font-size:14px;border-radius:0;height:32px}._cust_filter .select2-container--default .select2-selection--single .select2-selection__rendered{line-height:32px}.Product-Filter .btn-primary{color:#fff!important;cursor:pointer;margin-left:15px;padding-top:4px;padding-bottom:4px}.CL-Product .fa{position:absolute;top:8px;left:8px;color:#b5b5b5}._cust_filter{width:170px;float:left;margin-bottom:15px}._cust_filter select{border-radius:0;height:32px;border:1px solid #dedede}@media (max-width:1300px){.header-tabs .nav-tabs .nav-item.show .nav-link,.header-tabs .nav-tabs .nav-link,.header-tabs .nav-tabs .nav-link.active{font-size:14px;padding:12px;letter-spacing:.5px}}._cust_filter{width:230px;padding-right:10px}._cust_filter .select2-container .select2-selection--single{height:32px!important}._cust_filter .select2-container--default .select2-selection--single .select2-selection__rendered{line-height:30px}._cust_filter .form-s2 .select2-container--default .select2-selection--single .select2-selection__arrow{height:32px}.CL-Product{padding-right:10px}.Product-Filter .btn-primary{margin:0;letter-spacing:1px;float:left;box-shadow:none}@media (max-width:1170px){.header-tabs .nav-tabs .nav-item.show .nav-link,.header-tabs .nav-tabs .nav-link,.header-tabs .nav-tabs .nav-link.active{padding:12px 10px;letter-spacing:normal}}"],encapsulation:2}),e})();var S=i("yuE0");function C(e,t){if(1&e&&(o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.vc(8),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Ob(),o.Pb(11,"td"),o.vc(12),o.Zb(13,"decimal"),o.Ob(),o.Pb(14,"td"),o.vc(15),o.Zb(16,"number"),o.Ob(),o.Pb(17,"td"),o.vc(18),o.Zb(19,"number"),o.Ob(),o.Pb(20,"td"),o.vc(21),o.Zb(22,"number"),o.Ob(),o.Pb(23,"td"),o.vc(24),o.Zb(25,"number"),o.Ob(),o.Ob()),2&e){const e=t.$implicit;o.yb(2),o.wc(e.item_sku),o.yb(2),o.wc(e.item_name),o.yb(2),o.wc(e.parent_qty),o.yb(2),o.wc(e.child_qty),o.yb(2),o.wc(e.original_price),o.yb(2),o.wc(o.ac(13,10,e.original_price*e.quantity)),o.yb(3),o.wc(o.bc(16,12,e.scheme_discount*e.quantity,"1.2-2")),o.yb(3),o.wc(o.bc(19,15,e.merchant_discount_pkr*e.quantity,"1.2-2")),o.yb(3),o.wc(o.bc(22,18,e.special_discount*e.quantity,"1.2-2")),o.yb(3),o.wc(o.bc(25,21,e.final_price,"1.2-2"))}}function w(e,t){if(1&e&&(o.Pb(0,"div",10),o.Pb(1,"div",11),o.Pb(2,"div",12),o.Pb(3,"div",13),o.Pb(4,"div",14),o.Kb(5,"img",15),o.Ob(),o.Pb(6,"div",16),o.vc(7," Order # "),o.Pb(8,"strong"),o.vc(9),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(10,"div",17),o.Pb(11,"div",7),o.Pb(12,"div",10),o.Pb(13,"div",18),o.Pb(14,"div",19),o.Pb(15,"div",20),o.Pb(16,"span"),o.vc(17,"Retailer Name: "),o.Ob(),o.Pb(18,"strong"),o.vc(19),o.Ob(),o.Kb(20,"br"),o.Pb(21,"span"),o.vc(22,"Phone No: "),o.Ob(),o.Pb(23,"strong"),o.vc(24),o.Ob(),o.Kb(25,"br"),o.Pb(26,"span"),o.vc(27,"Location: "),o.Ob(),o.Pb(28,"strong"),o.vc(29),o.Ob(),o.Ob(),o.Pb(30,"div",21),o.Pb(31,"span"),o.vc(32,"Status: "),o.Ob(),o.Pb(33,"strong"),o.vc(34),o.Ob(),o.Kb(35,"br"),o.Pb(36,"span"),o.vc(37,"Booking Date: "),o.Ob(),o.Pb(38,"strong"),o.vc(39),o.Ob(),o.Kb(40,"br"),o.Pb(41,"span"),o.vc(42,"Employee: "),o.Ob(),o.Pb(43,"strong"),o.vc(44),o.Ob(),o.Ob(),o.Ob(),o.Kb(45,"div",22),o.Pb(46,"div",23),o.Pb(47,"table",24),o.Pb(48,"thead"),o.Pb(49,"tr"),o.Pb(50,"th"),o.Pb(51,"strong"),o.vc(52,"Code"),o.Ob(),o.Ob(),o.Pb(53,"th"),o.Pb(54,"strong"),o.vc(55,"Product Name"),o.Ob(),o.Ob(),o.Pb(56,"th"),o.Pb(57,"strong"),o.vc(58,"CTN"),o.Ob(),o.Ob(),o.Pb(59,"th"),o.Pb(60,"strong"),o.vc(61,"BOX/PCS"),o.Ob(),o.Ob(),o.Pb(62,"th"),o.Pb(63,"strong"),o.vc(64,"T.P"),o.Ob(),o.Ob(),o.Pb(65,"th"),o.Pb(66,"strong"),o.vc(67,"GR Amt"),o.Ob(),o.Ob(),o.Pb(68,"th"),o.Pb(69,"strong"),o.vc(70,"T.O"),o.Ob(),o.Ob(),o.Pb(71,"th"),o.Pb(72,"strong"),o.vc(73,"T.Disc"),o.Ob(),o.Ob(),o.Pb(74,"th"),o.Pb(75,"strong"),o.vc(76,"SPC.Disc"),o.Ob(),o.Ob(),o.Pb(77,"th"),o.Pb(78,"strong"),o.vc(79,"Net.Amt"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(80,"tbody",25),o.tc(81,C,26,24,"tr",26),o.Pb(82,"tr"),o.Kb(83,"td",27),o.Kb(84,"td",27),o.Kb(85,"td",27),o.Kb(86,"td",27),o.Kb(87,"td",27),o.Kb(88,"td",27),o.Kb(89,"td",27),o.Kb(90,"td",27),o.Pb(91,"td"),o.Pb(92,"strong"),o.vc(93,"Total Discount PKR."),o.Ob(),o.Ob(),o.Pb(94,"td"),o.Pb(95,"strong"),o.vc(96),o.Zb(97,"decimal"),o.Ob(),o.Ob(),o.Ob(),o.Pb(98,"tr"),o.Kb(99,"td",27),o.Kb(100,"td",27),o.Kb(101,"td",27),o.Kb(102,"td",27),o.Kb(103,"td",27),o.Kb(104,"td",27),o.Kb(105,"td",27),o.Kb(106,"td",27),o.Pb(107,"td",28),o.Pb(108,"strong"),o.vc(109,"Total PKR."),o.Ob(),o.Ob(),o.Pb(110,"td",28),o.Pb(111,"strong"),o.vc(112),o.Zb(113,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Kb(114,"div",29),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.yb(9),o.wc(null==e.orderDetail||null==e.orderDetail.retailer_detail?null:e.orderDetail.retailer_detail.id),o.yb(10),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.retailer_name," "),o.yb(5),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.retailer_phone," "),o.yb(5),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.retailer_address," "),o.yb(5),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.status," "),o.yb(5),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.order_date," "),o.yb(5),o.xc(" ",null==e.orderDetail?null:e.orderDetail.retailer_detail.employee_name," "),o.yb(37),o.ec("ngForOf",null==e.orderDetail?null:e.orderDetail.order_detail),o.yb(15),o.wc(o.ac(97,10,null==e.orderDetail?null:e.orderDetail.totalDiscount)),o.yb(16),o.wc(o.bc(113,12,null==e.orderDetail||null==e.orderDetail.retailer_detail?null:e.orderDetail.retailer_detail.order_total,"1.2-2"))}}function k(e,t){1&e&&(o.Pb(0,"div",10),o.Kb(1,"app-loader-white"),o.Ob())}function D(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.vc(8),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Zb(11,"number"),o.Ob(),o.Pb(12,"td"),o.Pb(13,"button",41),o.Wb("click",(function(){o.oc(e);const i=t.$implicit,r=o.Yb(3);return r.showDetails=!0,r.openDetailsModal(i.id)})),o.vc(14,"Detail"),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit;o.yb(2),o.wc(e.date),o.yb(2),o.wc(e.retailer),o.yb(2),o.xc("",e.channel," "),o.yb(2),o.wc(e.emp_name),o.yb(2),o.wc(o.bc(11,5,e.order_total,"1.2-2"))}}function I(e,t){if(1&e&&(o.Pb(0,"table",40),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"Date"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Retailer"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Channel"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Orders Booker"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Order Total"),o.Ob(),o.Pb(13,"th"),o.vc(14,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"tbody"),o.tc(16,D,15,8,"tr",26),o.Ob(),o.Ob()),2&e){const e=o.Yb(2);o.ec("dtOptions",e.dtOptions),o.yb(16),o.ec("ngForOf",e.orders)}}function M(e,t){1&e&&(o.Pb(0,"div",10),o.Kb(1,"app-loader-white"),o.Ob())}function T(e,t){if(1&e&&(o.Pb(0,"div",6),o.Pb(1,"div",30),o.Pb(2,"div",31),o.Pb(3,"h2",32),o.vc(4,"Orders "),o.Pb(5,"span"),o.vc(6," Management"),o.Ob(),o.Ob(),o.Ob(),o.Pb(7,"div",31),o.Pb(8,"ol",33),o.Pb(9,"li"),o.Pb(10,"a",34),o.Pb(11,"span"),o.vc(12,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(13,"li"),o.Pb(14,"span"),o.vc(15,"List"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(16,"div",7),o.Pb(17,"div",35),o.Pb(18,"div",11),o.Pb(19,"div",36),o.Pb(20,"h2"),o.vc(21,"Booked Order "),o.Pb(22,"span"),o.vc(23," Detail"),o.Ob(),o.Pb(24,"div",37),o.vc(25),o.Ob(),o.Ob(),o.Ob(),o.Pb(26,"div",38),o.tc(27,I,17,2,"table",39),o.tc(28,M,2,0,"div",8),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.yb(25),o.wc(e.orders.length||0),o.yb(2),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading)}}let A=(()=>{class e{constructor(e,t,i){this.route=e,this.ordersService=t,this.toastService=i,this.dtOptions={},this.orders=[],this.orderDetail=null,this.date=0,this.employeeId=0}ngOnInit(){this.showDetails=!1,this.date=this.route.snapshot.params.date,this.employeeId=this.route.snapshot.params.employeeId,this.dtOptions={pagingType:"simple_numbers"},this.getViewOrdersByEmployee()}getViewOrdersByEmployee(){this.loading=!0,this.ordersService.getViewOrdersByEmployee(this.employeeId,this.date.toString()).subscribe(e=>{this.loading=!1,200===e.status&&(this.orders=e.data)},e=>{this.loading=!1,401!==e.status&&1!==e.status&&this.toastService.showToaster({title:"Error:",message:"New Orders not fetched, try again later.",type:"error"}),scrollTo(0,0)})}getViewOrderDetailById(e){this.loading=!0,this.ordersService.getViewOrderDetailById(e).subscribe(e=>{this.loading=!1,200===e.status&&(this.orderDetail=e.data,this.orderDetail.subTotal=this.orderDetail.order_detail.map(e=>e.final_price).reduce((e,t)=>e+t,0),this.orderDetail.totalDiscount=this.orderDetail.order_detail.map(e=>e.original_price*e.quantity-e.unit_price_after_individual_discount*e.quantity).reduce((e,t)=>e+t,0),this.showDetails=!0)},e=>{this.loading=!1,401!==e.status&&1!==e.status&&this.toastService.showToaster({title:"Error:",message:"New Orders not fetched, try again later.",type:"error"}),scrollTo(0,0)})}openDetailsModal(e){this.orderDetail=null,this.getViewOrderDetailById(e)}closeDetailsModal(){document.body.classList.remove("no-scroll")}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(a.a),o.Jb(c.a),o.Jb(l.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-order-detail-list"]],decls:12,vars:4,consts:[["id","exampleModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade",2,"overflow-y","auto",3,"ngClass"],["role","document",1,"modal-dialog","modal-full","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","border-0"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",2,"font-size","30px","outline","none",3,"click"],[1,"modal-body","p-0"],[1,"container"],[1,"row"],["class","col-12",4,"ngIf"],["class","container",4,"ngIf"],[1,"col-12"],[1,"card"],[1,"p-10",2,"border-bottom","solid 2px #000"],[1,"row","m-0"],[1,"col-8","OrderLogo"],["src","assets/images/sell-360.svg","alt",""],[1,"col-4","ord-no"],[1,"body",2,"padding","15px 20px"],[1,"form-body"],[1,"row","OrderInfo"],[1,"col-md-9"],[1,"col-md-3","p-0"],[1,"seprator-block"],[1,"Order-Detail-table","mt-30"],[1,"table"],[1,"order_items_body"],[4,"ngFor","ngForOf"],[1,"border-0"],[2,"background-color","#000","color","#fff"],[1,"clearfix"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],["routerLink","/orders"],[1,"col-md-12"],[1,"header"],[1,"_list-total"],[1,"body"],["datatable","","class","table table-hover dt-responsive nowrap","id","example","style","width:100%",3,"dtOptions",4,"ngIf"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],[1,"btn","btn-default","btn-line","mb-0",3,"click"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"button",4),o.Wb("click",(function(){return t.showDetails=!1,t.closeDetailsModal()})),o.vc(5,"\xd7"),o.Ob(),o.Ob(),o.Pb(6,"div",5),o.Pb(7,"div",6),o.Pb(8,"div",7),o.tc(9,w,115,15,"div",8),o.tc(10,k,2,0,"div",8),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(11,T,29,3,"div",9)),2&e&&(o.ec("ngClass",t.showDetails?"show active":""),o.yb(9),o.ec("ngIf",!t.loading),o.yb(1),o.ec("ngIf",t.loading),o.yb(1),o.ec("ngIf",!t.showDetails))},directives:[r.i,r.k,r.j,p.a,a.h,u.a],pipes:[S.a,r.d],styles:[".OrderLogo[_ngcontent-%COMP%]{text-align:left;padding-left:0}.OrderLogo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:46px}.OrderInfo[_ngcontent-%COMP%]{font-size:14px}.OrderInfo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:105px;float:left}.Order-Detail-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #333;padding:5px!important;font-size:12px}.Order-Detail-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #333!important;background-color:#ededed!important;color:#000;padding:5px!important;font-size:12px}.button-list[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{font-size:14px!important;letter-spacing:1px}.button-list[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{padding-right:3px}.ord-no[_ngcontent-%COMP%]{padding-top:17px;font-size:14px;text-align:right}.active[_ngcontent-%COMP%]{display:block!important}"]}),e})();var R=i("oo4J"),L=i("AytR");const q=function(e,t,i){return["/orders","dispatch",e,t,i]};function N(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Zb(5,"titlecase"),o.Ob(),o.Pb(6,"td"),o.vc(7),o.Ob(),o.Pb(8,"td"),o.vc(9),o.Ob(),o.Pb(10,"td"),o.vc(11),o.Zb(12,"number"),o.Ob(),o.Pb(13,"td"),o.Pb(14,"button",25),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).loadBookingSheet(i)})),o.vc(15," BS "),o.Ob(),o.Pb(16,"a",26),o.vc(17,"Dispatch"),o.Ob(),o.Pb(18,"button",27),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).selectedAssignmentId=i.assignment_id})),o.vc(19," Revert "),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit;o.yb(2),o.wc(e.date),o.yb(2),o.wc(o.ac(5,6,e.sales_man)),o.yb(3),o.wc(e.emp_names||e.emp_name),o.yb(2),o.wc(e.total_orders),o.yb(2),o.wc(o.bc(12,8,e.order_total,"1.2-2")),o.yb(5),o.ec("routerLink",o.kc(11,q,e.assignment_id,e.sales_man_id,e.date))}}function B(e,t){if(1&e&&(o.Pb(0,"table",23),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"Date"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Sales Man"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Order Bookers"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Orders"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Booked Value"),o.Ob(),o.Pb(13,"th"),o.vc(14,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"tbody"),o.tc(16,N,20,15,"tr",24),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("dtOptions",e.dtOptions),o.yb(16),o.ec("ngForOf",e.ordersList)}}function Y(e,t){1&e&&(o.Pb(0,"div",8),o.Kb(1,"app-loader-white"),o.Ob())}let E=(()=>{class e{constructor(e,t,i){this.router=e,this.toastService=t,this.orderService=i,this.dtOptions={},this.ordersList=[],this.bookingSheetUrl=`${L.a.apiDomain}${R.a.BOOKING_SHEET_PDF}`}ngOnInit(){this.dtOptions={pagingType:"simple_numbers"},this.getDispatchOrderListing()}getDispatchOrderListing(){this.loading=!0,this.orderService.getDispatchOrdersListing().subscribe(e=>{this.loading=!1,200===e.status&&(this.ordersList=e.data)},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Dispatch Order list cannot be fetched at the moment! Please try again",title:"Error:"})})}revertOrder(){this.loading=!0,document.getElementById("close-revert").click(),this.orderService.revertOrder("assignment",this.selectedAssignmentId).subscribe(e=>{this.loading=!1,200===e.status?(this.toastService.showToaster({title:"Revet Success:",message:"The order reverted successfully!",type:"success"}),this.router.navigateByUrl("/orders")):this.toastService.showToaster({title:"Revet Error:",message:"The order cannot be reverted at the momnent, please try again later.",type:"error"})},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({title:"Revet Error:",message:"The order cannot be reverted at the momnent, please try again later.",type:"error"})})}loadBookingSheet(e){window.open(`${this.bookingSheetUrl}?emp=${e.sales_man_id}&date=${e.date}&assignmentId=${e.assignment_id}`)}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(a.f),o.Jb(l.a),o.Jb(c.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-create-dispatched"]],decls:41,vars:2,consts:[["id","order-revert","tabindex","-1","role","dialog","aria-labelledby","orderLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","top-borderRed"],[1,"modal-header"],["id","orderLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"modal-footer","border-0"],["type","submit",1,"btn","btn-primary",3,"click"],["type","button","id","close-revert","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],[1,"container"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],["routerLink","/orders"],[1,"row"],[1,"card"],[1,"body"],["datatable","","class","table table-hover dt-responsive nowrap","id","example","style","width: 100%",3,"dtOptions",4,"ngIf"],["class","col-md-12",4,"ngIf"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],[4,"ngFor","ngForOf"],[1,"btn","btn-default","mb-0",3,"click"],[1,"btn","btn-default","btn-line","mb-0",3,"routerLink"],["data-toggle","modal","data-target","#order-revert",1,"btn","btn-default","red-bg","mb-0",3,"click"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"h5",4),o.vc(5,"Cancel Order "),o.Kb(6,"span"),o.Ob(),o.Pb(7,"button",5),o.Pb(8,"span",6),o.vc(9,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(10,"div",7),o.Pb(11,"div",8),o.Pb(12,"p"),o.vc(13,"Are you sure you want to revert the order?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(14,"div",9),o.Pb(15,"button",10),o.Wb("click",(function(){return t.revertOrder()})),o.vc(16," Yes "),o.Ob(),o.Pb(17,"button",11),o.vc(18," No "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(19,"div",12),o.Pb(20,"div",13),o.Pb(21,"div",14),o.Pb(22,"h2",15),o.vc(23,"Create "),o.Pb(24,"span"),o.vc(25," Dispatch"),o.Ob(),o.Ob(),o.Ob(),o.Pb(26,"div",14),o.Pb(27,"ol",16),o.Pb(28,"li"),o.Pb(29,"a",17),o.Pb(30,"span"),o.vc(31,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(32,"li"),o.Pb(33,"span"),o.vc(34,"List"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(35,"div",18),o.Pb(36,"div",8),o.Pb(37,"div",19),o.Pb(38,"div",20),o.tc(39,B,17,2,"table",21),o.tc(40,Y,2,0,"div",22),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.yb(39),o.ec("ngIf",!t.loading),o.yb(1),o.ec("ngIf",t.loading))},directives:[a.h,r.k,u.a,r.j,p.a],pipes:[r.o,r.d],styles:[""]}),e})();var J=i("UYTb");const K=function(e,t,i){return["/orders","execute-order",e,t,i]};function F(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.vc(8),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Zb(11,"number"),o.Ob(),o.Pb(12,"td"),o.Pb(13,"button",27),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).loadBookingSheet(i)})),o.vc(14,"BS"),o.Ob(),o.Pb(15,"button",27),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).loadLoadSheet(i)})),o.vc(16,"LS"),o.Ob(),o.Pb(17,"button",27),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).loadBills(i)})),o.vc(18,"Bills"),o.Ob(),o.Pb(19,"button",28),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(2).selectedLoadId=i.load_id})),o.vc(20,"Revert"),o.Ob(),o.Pb(21,"button",29),o.vc(22,"Execute"),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit;o.yb(2),o.wc(e.date),o.yb(2),o.wc(e.sales_man),o.yb(2),o.xc("",e.emp_names," "),o.yb(2),o.wc(e.total_orders),o.yb(2),o.wc(o.bc(11,6,e.order_total,"1.2-2")),o.yb(11),o.ec("routerLink",o.kc(9,K,e.sales_man_id,e.date,e.load_id))}}function Q(e,t){if(1&e&&(o.Pb(0,"table",25),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"Date"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Sales Man"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Order Bookers"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Orders"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Amount"),o.Ob(),o.Pb(13,"th"),o.vc(14,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"tbody"),o.tc(16,F,23,13,"tr",26),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("dtOptions",e.dtOptions),o.yb(16),o.ec("ngForOf",e.ordersList)}}function $(e,t){1&e&&(o.Pb(0,"div",30),o.Kb(1,"app-loader-white"),o.Ob())}let z=(()=>{class e{constructor(e,t,i,r){this.router=e,this.orderService=t,this.toastServicer=i,this.storageService=r,this.dtOptions={},this.ordersList=[],this.bookingSheetUrl=`${L.a.apiDomain}${R.a.BOOKING_SHEET_PDF}`,this.distributorId=r.getItem("distributor").id}ngOnInit(){this.showExecuteOrder=!1,this.dtOptions={pagingType:"simple_numbers"},this.getExecutionList()}getExecutionList(){this.loading=!0,this.orderService.getExecutionList().subscribe(e=>{this.loading=!1,200===e.status?this.ordersList=e.data:(console.log("Error when fetching orders :>> ",e.message),this.toastServicer.showToaster({type:"error",message:"Cannot fetch orders list, please try again later!",title:"Error:"}))},e=>{this.loading=!1,1!==e.status&&401!==e.status&&(console.log("Cannot fetch orders list for execution :>> ",e.messge),this.toastServicer.showToaster({type:"error",message:"Cannot fetch orders list, please try again later!",title:"Error:"}))})}loadBookingSheet(e){window.open(`${this.bookingSheetUrl}?emp=${e.sales_man_id}&date=${e.date}&loadId=${e.load_id}`)}loadLoadSheet(e){window.open(`${L.a.apiDomain}${R.a.LS_PDF}/${e.load_id}/${e.sales_man_id}/${e.date}`)}loadBills(e){window.open(`${L.a.apiDomain}${R.a.BILLS}?type=bill&emp=${e.sales_man_id}&date=${e.date}&dist_id=${this.distributorId}&size=A4&status=processed&loadId=${e.load_id}`)}revertOrder(){this.loading=!0,document.getElementById("close-revert").click(),this.orderService.revertOrder("load",this.selectedLoadId).subscribe(e=>{this.loading=!1,200===e.status?(this.toastServicer.showToaster({title:"Revet Success:",message:"The order reverted successfully!",type:"success"}),this.router.navigateByUrl("/orders")):this.toastServicer.showToaster({title:"Revet Error:",message:"The order cannot be reverted at the momnent, please try again later.",type:"error"})},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastServicer.showToaster({title:"Revet Error:",message:"The order cannot be reverted at the momnent, please try again later.",type:"error"})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(a.f),o.Jb(c.a),o.Jb(l.a),o.Jb(J.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-orderexecution-list"]],decls:48,vars:3,consts:[["id","order-revert","tabindex","-1","role","dialog","aria-labelledby","orderLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","top-borderRed"],[1,"modal-header"],["id","orderLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"modal-footer","border-0"],["type","submit",1,"btn","btn-primary",3,"click"],["type","button","id","close-revert","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],[1,"container"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],["routerLink","/orders"],[1,"row"],[1,"card"],[1,"header"],[1,"_list-total"],[1,"body"],["datatable","","class","table table-hover dt-responsive nowrap","id","example","style","width:100%",3,"dtOptions",4,"ngIf"],["class","col-12",4,"ngIf"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],[4,"ngFor","ngForOf"],[1,"btn","btn-default","mb-0",3,"click"],["data-target","#order-revert","data-toggle","modal",1,"btn","btn-default","red-bg","mb-0",3,"click"],[1,"btn","btn-default","mb-0",3,"routerLink"],[1,"col-12"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"h5",4),o.vc(5,"Cancel Order "),o.Kb(6,"span"),o.Ob(),o.Pb(7,"button",5),o.Pb(8,"span",6),o.vc(9,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(10,"div",7),o.Pb(11,"div",8),o.Pb(12,"p"),o.vc(13,"Are you sure you want to revert the order?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(14,"div",9),o.Pb(15,"button",10),o.Wb("click",(function(){return t.revertOrder()})),o.vc(16,"Yes"),o.Ob(),o.Pb(17,"button",11),o.vc(18,"No"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(19,"div",12),o.Pb(20,"div",13),o.Pb(21,"div",14),o.Pb(22,"h2",15),o.vc(23,"Orders "),o.Pb(24,"span"),o.vc(25," Management"),o.Ob(),o.Ob(),o.Ob(),o.Pb(26,"div",14),o.Pb(27,"ol",16),o.Pb(28,"li"),o.Pb(29,"a",17),o.Pb(30,"span"),o.vc(31,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(32,"li"),o.Pb(33,"span"),o.vc(34,"List"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(35,"div",18),o.Pb(36,"div",8),o.Pb(37,"div",19),o.Pb(38,"div",20),o.Pb(39,"h2"),o.vc(40,"Execute "),o.Pb(41,"span"),o.vc(42," Orders"),o.Ob(),o.Pb(43,"div",21),o.vc(44),o.Ob(),o.Ob(),o.Ob(),o.Pb(45,"div",22),o.tc(46,Q,17,2,"table",23),o.tc(47,$,2,0,"div",24),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.yb(44),o.wc(t.ordersList.length),o.yb(2),o.ec("ngIf",!t.loading),o.yb(1),o.ec("ngIf",t.loading))},directives:[a.h,r.k,u.a,r.j,a.g,p.a],pipes:[r.d],styles:[".active[_ngcontent-%COMP%]{display:block;overflow-y:auto}"]}),e})(),W=(()=>{class e{constructor(){}setOrderPayloadItems(e,t){return e.items.map(i=>{var r,n,a,o,s;return{quantity_returned:i.dispatch_qty-i.stockQty>-1?i.dispatch_qty-i.stockQty:0,executed_qty:+i.stockQty,id:i.id||0,employee_id:e.employee_id,pref_id:i.pref_id,item_quantity_booker:i.item_quantity_booker,item_quantity_updated:i.item_quantity_updated||0,original_price:i.item_trade_price,scheme_discount:i.scheme_discount,unit_price_after_scheme_discount:i.unit_price_after_scheme_discount,merchant_discount:i.trade_discount,merchant_discount_pkr:i.trade_discount_pkr,unit_price_after_merchant_discount:i.unit_price_after_merchant_discount,special_discount:i.special_discount,unit_price_after_special_discount:i.unit_price_after_special_discount,booker_discount:i.extra_discount||0,unit_price_after_individual_discount:i.unit_price_after_individual_discount||i.price,unit_id:i.unit_id,unit_name:i.unit_name,brand_id:i.brand_id,item_id:i.item_id,item_name:i.item_name,scheme_id:(null===(r=i.selectedScheme)||void 0===r?void 0:r.id)||0,scheme_min_quantity:(null===(n=i.selectedScheme)||void 0===n?void 0:n.min_qty)||0,scheme_quantity_free:(null===(a=i.selectedScheme)||void 0===a?void 0:a.quantity_free)||0,scheme_rule:(null===(o=i.selectedScheme)||void 0===o?void 0:o.rule_name)||"",gift_value:i.gift_value||0,parent_pref_id:i.child||i.parent_pref_id,parent_unit_id:i.parent_unit_id,parent_brand_id:i.brand_id,parent_tp:i.parent_trade_price||i.parent_tp,parent_qty_sold:i.parent_qty_sold,parent_value_sold:i.net_amount,final_price:i.net_amount,campaign_id:(null===(s=i.selectedScheme)||void 0===s?void 0:s.id)||0,item_status:i.is_active||i.item_status,dispatch_status:0,dispatch_qty:+i.dispatch_qty,dispatch_amount:i.net_amount,reasoning:"",distributor_id:e.distributor_id,division_id:t.division_id||0,region_id:e.region_id,area_id:e.area_id,assigned_route_id:e.assigned_route_id,territory_id:e.territory_id,booked_order_value:i.booked_order_value||0,booked_total_qty:i.booked_total_qty||0,is_deleted:i.isDeleted,quantity:+i.stockQty,gross_sale_amount:i.original_amount,total_retail_price:i.item_retail_price*i.stockQty,tax_class_id:i.tax_class_id,tax_in_percentage:i.tax_class_amount,tax_in_value:i.tax_amount_value||0,total_tax_amount:i.tax_amount_pkr||0,total_amount_after_tax:i.net_amount,total_discount:i.scheme_discount*+i.stockQty+i.trade_discount_pkr*+i.stockQty+ +i.stockQty*i.special_discount+i.extra_discount_pkr,order_id:e.id}})}setOrderPayloadReturnedItems(e,t){return e.returned_items.map(i=>({quantity_returned:+i.stockQty,executed_qty:-i.stockQty,id:i.id||0,employee_id:e.employee_id,pref_id:i.pref_id,item_quantity_booker:0,item_quantity_updated:0,original_price:i.item_trade_price,scheme_discount:0,unit_price_after_scheme_discount:i.unit_price_after_scheme_discount,merchant_discount:0,merchant_discount_pkr:0,unit_price_after_merchant_discount:i.unit_price_after_merchant_discount,special_discount:0,unit_price_after_special_discount:i.unit_price_after_special_discount,booker_discount:i.extra_discount||0,unit_price_after_individual_discount:i.unit_price_after_individual_discount||i.unit_price_after_special_discount,unit_id:i.unit_id,unit_name:i.unit_name,brand_id:i.brand_id,item_id:i.item_id,item_name:i.item_name,scheme_id:0,scheme_min_quantity:0,scheme_quantity_free:0,return_type:i.returnType||i.return_type,scheme_rule:"",gift_value:0,parent_pref_id:i.child||i.parent_pref_id,parent_unit_id:i.parent_unit_id,parent_brand_id:i.brand_id,parent_tp:i.parent_trade_price||i.parent_tp,parent_qty_sold:0,parent_value_sold:i.net_amount,final_price:i.net_amount,campaign_id:0,item_status:i.is_active||i.item_status,dispatch_status:0,dispatch_qty:0,dispatch_amount:i.net_amount,reasoning:"",distributor_id:e.distributor_id,division_id:t.division_id||0,region_id:e.region_id,area_id:e.area_id,assigned_route_id:e.assigned_route_id,territory_id:e.territory_id,booked_order_value:0,booked_total_qty:0,is_deleted:i.isDeleted,quantity:0,gross_sale_amount:i.original_amount,total_retail_price:i.total_retail_price,tax_class_id:0,tax_in_percentage:0,tax_in_value:0,total_tax_amount:0,total_amount_after_tax:i.net_amount,total_discount:i.extra_discount?i.extra_discount*+i.stockQty:0,order_id:e.id}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac}),e})(),Z=(()=>{class e{constructor(){}setSpotSaleOrderContent(e,t,i){return{employee_id:t.employee_id,retailer_id:e.retailer_id,within_radius:0,status:"",status_code:0,order_total:0,ttl_qty_sold:0,ttl_products_sold:0,remarks:"",booking_region:t.region_id,booking_area:t.area_id,booking_territory:t.territory_id,invoice_number:"",freight_charges:0,booking_zone:0,booking_locality_id:e.locality_id,booking_neighbourhood_id:e.neighbourhood_id,sales_man_id:0,spot_sale:1,counter_sale:0,invoice_date:"",order_type:"spot",distributor_id:i,region_id:t.region_id,recovery:0,recovered:0,area_id:t.area_id,assigned_route_id:e.route_id,territory_id:t.territory_id,booked_order_value:0,booked_total_qty:0,booked_total_skus:0,gross_sale_amount:0,total_retail_price:0,total_tax_amount:0,total_amount_after_tax:0,total_discount:0,payment:{},items:[],returned_items:[]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac}),e})();var V=i("LCr2"),G=i("Unci"),U=i("tPJg"),H=i("VzUJ");class j{get id(){return this._id||0}set id(e){this._id=e}get shop_code(){return this._shop_code}set shop_code(e){this._shop_code=e}get invoice_number(){return this._invoice_number}set invoice_number(e){this._invoice_number=e}get retailer_name(){return this._retailer_name}set retailer_name(e){this._retailer_name=e}get retailer_id(){return this._retailer_id}set retailer_id(e){this._retailer_id=e}get aging(){return this._aging}set aging(e){this._aging=e}get agingValue(){return this._aging>0?this._aging:"N/A"}get amount(){return this._amount}set amount(e){this.maxAddedToCurrent=this.balance,this._amount=e}get invoice_discount(){return this._invoice_discount||0}set invoice_discount(e){e>this.amount?(this._invoice_discount=0,setTimeout(()=>{this._invoice_discount=this.amount},0)):this._invoice_discount=e}get balance(){return this.amount-this.invoice_discount}get maxAddedToCurrent(){return this._maxAddedToCurrent}set maxAddedToCurrent(e){this._maxAddedToCurrent=e}get added_to_current(){if(!(this._added_to_current>this.balance))return this._added_to_current;this._added_to_current=this.balance}set added_to_current(e){e>this.balance?(this._added_to_current=0,setTimeout(()=>{this._added_to_current=this.balance},0)):this._added_to_current=e}get is_added(){return this._is_added}set is_added(e){this._is_added=e}get order_id(){return this._order_id}set order_id(e){this._order_id=e}get parent_order_id(){return this._parent_order_id}set parent_order_id(e){this._parent_order_id=e}get isAddToBill(){return!(this.invoice_discount>0||this.added_to_current>0)}get recoverd_amount(){return this._recoverd_amount}set recoverd_amount(e){e>this.amount?(this._recoverd_amount=0,setTimeout(()=>{this._recoverd_amount=this.balance},0)):this._recoverd_amount=e||0}}const X=(e,t)=>{for(let i=0;i<e.length;i++){const r=ee(e[i]);t.push(r)}return t},ee=e=>{const t=new j;return t.added_to_current=e.added_to_current,t.aging=e.aging,t.amount=e.amount,t.invoice_discount=e.invoice_discount,t.invoice_number=e.invoice_number,t.is_added=e.is_added,t.parent_order_id=e.parent_order_id,t.recoverd_amount=e.recoverd_amount,t.retailer_id=e.retailer_id,t.retailer_name=e.retailer_name,t.order_id=e.order_id,t.id=e.id,t.shop_code=e.shop_code,t},te=e=>({id:e,operation:"remove"}),ie=(e,t,i)=>({invoice_number:e.invoice_number,parent_order_id:t,retailer_id:e.retailer_id,order_id:e.order_id||null,assignment_id:i,invoice_balance:e.amount,added_amount:e.added_to_current,invoice_discount:e.invoice_discount,recoverd_amount:e.recoverd_amount,operation:"add"});var re=i("Rb2t"),ne=i("8/39");function ae(e,t){1&e&&(o.Pb(0,"th"),o.vc(1,"Invoice DISC"),o.Ob())}function oe(e,t){1&e&&(o.Pb(0,"th"),o.vc(1,"Balance"),o.Ob())}function se(e,t){1&e&&(o.Pb(0,"th"),o.vc(1,"Assigned"),o.Ob())}function de(e,t){if(1&e){const e=o.Qb();o.Pb(0,"th"),o.Pb(1,"input",9,10),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().$implicit.invoice_discount=t}))("keydown",(function(t){return o.oc(e),o.Yb(3).isNumber(t)})),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(),t=e.index,i=e.$implicit,r=o.Yb(2);o.yb(1),o.ec("id",t)("ngModel",i.invoice_discount)("disabled",i.is_added&&null===r.executionData&&!r.assignment_idOutRoute)}}function ce(e,t){if(1&e&&(o.Pb(0,"th"),o.vc(1),o.Zb(2,"number"),o.Ob()),2&e){const e=o.Yb().$implicit;o.yb(1),o.xc(" ",o.bc(2,1,e.balance,"1.2-2")," ")}}function le(e,t){if(1&e&&(o.Pb(0,"th"),o.vc(1),o.Zb(2,"number"),o.Ob()),2&e){const e=o.Yb().$implicit;o.yb(1),o.xc(" ",o.bc(2,1,e.added_to_current,"1.2-2")," ")}}function be(e,t){if(1&e){const e=o.Qb();o.Pb(0,"input",11,12),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().$implicit.added_to_current=t}))("keydown",(function(t){return o.oc(e),o.Yb(3).isNumber(t)})),o.Ob()}if(2&e){const e=o.Yb(),t=e.$implicit,i=e.index,r=o.Yb(2);o.fc("max",t.balance),o.ec("id",i)("disabled",(0===t.balance||t.is_added)&&null===r.executionData)("ngModel",t.added_to_current)}}function ue(e,t){if(1&e){const e=o.Qb();o.Pb(0,"input",11,12),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().$implicit.recoverd_amount=t}))("keydown",(function(t){return o.oc(e),o.Yb(3).isNumber(t)})),o.Ob()}if(2&e){const e=o.Yb(),t=e.$implicit,i=e.index,r=o.Yb(2);o.fc("max",t.balance),o.ec("id",i)("disabled",(0===t.balance||t.is_added)&&null===r.executionData&&!r.assignment_idOutRoute)("ngModel",t.recoverd_amount)}}function pe(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",13),o.Wb("click",(function(){o.oc(e);const t=o.Yb(),i=t.index,r=t.$implicit;return o.Yb(2).addOrderBill(i,r.is_added)})),o.vc(1),o.Ob()}if(2&e){const e=o.Yb().$implicit,t=o.Yb(2);o.ec("disabled",e.isAddToBill)("ngClass",e.is_addedc&&null===t.executionData?"red-bg":"btn-line"),o.yb(1),o.xc(" ",e.is_added?"Remove Bill":"Add to Bill"," ")}}function he(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",14),o.Wb("click",(function(){o.oc(e);const t=o.Yb().index;return o.Yb(2).addOrderBill(t,!1)})),o.vc(1," Save "),o.Ob()}}function me(e,t){if(1&e&&(o.Pb(0,"tr"),o.Pb(1,"th"),o.vc(2),o.Ob(),o.Pb(3,"th"),o.vc(4),o.Ob(),o.Pb(5,"th"),o.vc(6),o.Ob(),o.Pb(7,"th"),o.vc(8),o.Ob(),o.Pb(9,"th"),o.vc(10),o.Zb(11,"number"),o.Ob(),o.tc(12,de,3,3,"th",4),o.tc(13,ce,3,4,"th",4),o.tc(14,le,3,4,"th",4),o.Pb(15,"th"),o.tc(16,be,2,4,"input",6),o.tc(17,ue,2,4,"input",6),o.Ob(),o.Pb(18,"th"),o.tc(19,pe,2,3,"button",7),o.tc(20,he,2,0,"button",8),o.Ob(),o.Ob()),2&e){const e=t.$implicit,i=o.Yb(2);o.yb(2),o.wc(e.shop_code),o.yb(2),o.xc(" ",e.invoice_number?e.invoice_number:"Opening Balance"," "),o.yb(2),o.wc(e.retailer_name),o.yb(2),o.wc(e.agingValue),o.yb(2),o.wc(o.bc(11,12,e.amount,"1.2-2")),o.yb(2),o.ec("ngIf",i.isRecoverydiscountActivated),o.yb(1),o.ec("ngIf",i.isRecoverydiscountActivated),o.yb(1),o.ec("ngIf",null!==i.executionData),o.yb(2),o.ec("ngIf",null===i.executionData&&!i.assignment_idOutRoute),o.yb(1),o.ec("ngIf",null!==i.executionData||i.assignment_idOutRoute),o.yb(2),o.ec("ngIf",null===i.executionData&&0===i.retailerId),o.yb(1),o.ec("ngIf",null!==i.executionData||i.retailerId>0)}}function ge(e,t){if(1&e&&(o.Pb(0,"table",3),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"Shop Code"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Invoice"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Shop Name"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Aging"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Pending AMNT"),o.Ob(),o.tc(13,ae,2,0,"th",4),o.tc(14,oe,2,0,"th",4),o.tc(15,se,2,0,"th",4),o.Pb(16,"th"),o.vc(17),o.Ob(),o.Pb(18,"th"),o.vc(19,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(20,"tbody"),o.tc(21,me,21,15,"tr",5),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("dtOptions",e.dtOptions),o.yb(13),o.ec("ngIf",e.isRecoverydiscountActivated),o.yb(1),o.ec("ngIf",e.isRecoverydiscountActivated),o.yb(1),o.ec("ngIf",null!==e.executionData),o.yb(2),o.xc(" ",null===e.executionData&&0===e.retailerId?"Add To Current":"Recovery"," "),o.yb(4),o.ec("ngForOf",e.retailer_credit_Invoices)}}function ve(e,t){1&e&&(o.Pb(0,"div",15),o.Kb(1,"app-loader-white"),o.Ob())}let Oe=(()=>{class e{constructor(e,t,i,r,n){this.orderService=e,this.route=t,this.storageService=i,this.dataService=r,this.toastService=n,this.executionData=null,this.retailerId=0,this.assignment_idOutRoute="",this.retailer_credit_Invoices=[],this.permissions=this.storageService.getItem(re.a.permissions),this.isRecoverydiscountActivated=this.permissions.Secondary_Orders.recovery_invoice_discount}ngOnInit(){console.log("this.retailerId",this.retailerId),this.assignmentId=null,this.dtOptions={pagingType:"simple_numbers"},this.executionData||0!==this.retailerId||(this.assignmentId=this.route.snapshot.paramMap.get("assignId")||null,this.orderService.orderRetailers.subscribe(e=>{e&&e.length&&(this.ordersRetailers=[...e])})),this.executionData&&(this.assignmentId=this.executionData.assignment_id),this.orderService.loadRetaillersRecovery.subscribe(e=>{e&&0===this.retailerId&&this.getCreditTabData()}),this.retailerId&&(this.assignmentId=this.assignment_idOutRoute.toString(),this.loading=!0,this.orderService.getOutOfRouteRecovery(this.retailerId).subscribe(e=>{console.log("getOutOfRouteRecovery => ",e.data.recoveries),X(e.data.recoveries||[],this.retailer_credit_Invoices),this.loading=!1}))}getCreditTabData(){this.loading=!0,this.orderService.getCreditdatailsData(this.assignmentId).subscribe(e=>{this.retailer_credit_Invoices=[],this.retailer_credit_Invoices=X(e.data,this.retailer_credit_Invoices),this.loading=!1})}isNumber(e,t="charges"){return this.dataService.isNumber(e,t)}addOrderBill(e,t){const i=this.retailer_credit_Invoices[e];if(t){const e=te(i.id);this.orderService.postRetailersCreditInvoices(e).subscribe(e=>{this.getCreditTabData(),this.toastService.showToaster({type:"success",message:"Remove Successfully",title:"Success:"})})}else{let t=i.parent_order_id;null===this.executionData&&0===this.retailerId?t=this.ordersRetailers.find(e=>e.retailer_id===i.retailer_id).id:console.log("retailer_credit_Invoices",i);const r=ie(i,t,this.assignmentId);this.retailerId>0&&(r.parent_order_id=null),this.orderService.postRetailersCreditInvoices(r).subscribe(t=>{console.log("postRetailersCreditInvoices => ",t.result),this.retailer_credit_Invoices[e].id=t.result.id,this.retailer_credit_Invoices[e].is_added=1,this.toastService.showToaster({type:"success",message:"Added Successfully",title:"Success:"})})}}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(c.a),o.Jb(a.a),o.Jb(J.a),o.Jb(ne.a),o.Jb(l.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-retailer-recovery"]],inputs:{executionData:"executionData",retailerId:"retailerId",assignment_idOutRoute:"assignment_idOutRoute"},decls:3,vars:2,consts:[[1,"col-12","PT-15"],["datatable","","class","table table-hover dt-responsive nowrap","id","example","style","width: 100%",3,"dtOptions",4,"ngIf"],["class","col-12",4,"ngIf"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],[4,"ngIf"],[4,"ngFor","ngForOf"],["type","number","ngModel","","name","recoveryAmount","class","form-control value_input","placeholder","0",3,"id","disabled","ngModel","max","ngModelChange","keydown",4,"ngIf"],["class","btn btn-default",3,"disabled","ngClass","click",4,"ngIf"],["class","btn btn-default btn-line",3,"click",4,"ngIf"],["type","number","name","recoveryDiscount","ngModel","","placeholder","0",1,"form-control","value_input",3,"id","ngModel","disabled","ngModelChange","keydown"],["recoveryDiscount","ngModel"],["type","number","ngModel","","name","recoveryAmount","placeholder","0",1,"form-control","value_input",3,"id","disabled","ngModel","max","ngModelChange","keydown"],["recoveryAmount","ngModel"],[1,"btn","btn-default",3,"disabled","ngClass","click"],[1,"btn","btn-default","btn-line",3,"click"],[1,"col-12"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.tc(1,ge,22,6,"table",1),o.tc(2,ve,2,0,"div",2),o.Ob()),2&e&&(o.yb(1),o.ec("ngIf",(null==t.retailer_credit_Invoices?null:t.retailer_credit_Invoices.length)&&!t.loading),o.yb(1),o.ec("ngIf",t.loading))},directives:[r.k,u.a,r.j,n.j,n.b,n.e,n.h,r.i,p.a],pipes:[r.d],styles:[""]}),e})();function Pe(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",27),o.Wb("click",(function(){return o.oc(e),o.Yb().cancelOrder()})),o.vc(1," Yes "),o.Ob()}}function _e(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",27),o.Wb("click",(function(){return o.oc(e),o.Yb().cancelSpotSale()})),o.vc(1," Yes "),o.Ob()}}function fe(e,t){if(1&e&&(o.Pb(0,"option",88),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.id),o.yb(1),o.xc(" ",e.name," ")}}function ye(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.Pb(6,"button",92),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(3).removeExpense(i.expense_type)})),o.vc(7," Delete "),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=o.Yb(3);o.yb(2),o.wc(i.getExpense(e.expense_type)),o.yb(2),o.wc(e.amount),o.yb(2),o.ec("id",e.type)}}function xe(e,t){if(1&e&&(o.Pb(0,"table",89),o.Pb(1,"thead"),o.Pb(2,"tr",90),o.Pb(3,"th"),o.vc(4,"Expense Type"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Amount"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(9,"tbody"),o.tc(10,ye,8,3,"tr",91),o.Ob(),o.Ob()),2&e){const e=o.Yb(2);o.ec("dtOptions",e.dtOPtions),o.yb(10),o.ec("ngForOf",null==e.finalLoad?null:e.finalLoad.expense_detail)}}function Se(e,t){1&e&&(o.Pb(0,"div",93),o.Pb(1,"div",94),o.Pb(2,"span",95),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}function Ce(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",7),o.Pb(1,"div",69),o.Pb(2,"div",70),o.Pb(3,"label",71),o.vc(4,"Expense Type"),o.Ob(),o.Pb(5,"div",72),o.Pb(6,"select",73,74),o.Pb(8,"option",75),o.vc(9,"Select Expense Type"),o.Ob(),o.tc(10,fe,2,2,"option",76),o.Ob(),o.Ob(),o.Ob(),o.Pb(11,"div",77),o.Pb(12,"div",78),o.Pb(13,"label",79),o.vc(14,"Amount"),o.Ob(),o.Pb(15,"input",80,81),o.Wb("keydown",(function(t){return o.oc(e),o.Yb().isNumber(t)})),o.Ob(),o.Ob(),o.Ob(),o.Pb(17,"div",82),o.Pb(18,"button",83),o.Wb("click",(function(){o.oc(e);const t=o.nc(7),i=o.nc(16);return o.Yb().addExpense(t,i)})),o.vc(19," Add "),o.Ob(),o.Ob(),o.Ob(),o.Pb(20,"div",84),o.Pb(21,"div",85),o.Pb(22,"div",8),o.Pb(23,"div",9),o.tc(24,xe,11,2,"table",86),o.tc(25,Se,4,0,"div",87),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(10),o.ec("ngForOf",null==e.finalLoad?null:e.finalLoad.expense_types),o.yb(14),o.ec("ngIf",!e.isExpenseAdded),o.yb(1),o.ec("ngIf",e.isExpenseAdded)}}function we(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-products-drawer",96),o.Wb("drawerClosed",(function(){return o.oc(e),o.Yb().closeNewProducts()}))("productSelected",(function(t){return o.oc(e),o.Yb().addNewProductToOrder(t)})),o.Ob()}if(2&e){const e=o.Yb();o.ec("selectedRetailer",e.selectedRetailer)("orderType","execution")("orderedProducts",null==e.orderDetails?null:e.orderDetails.items)("loadingProducts",e.loadingProduct)("allProducts",e.inventory)("productSchemes",e.schemes)("productMerchantDiscount",e.merchantDiscount)("specialDiscounts",e.specialDiscounts)}}function ke(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-returned-products",97),o.Wb("productReturned",(function(t){return o.oc(e),o.Yb().handleReturnedProduct(t)}))("closeReturned",(function(){return o.oc(e),o.Yb().closeReturnedModal()})),o.Ob()}if(2&e){const e=o.Yb();o.ec("productsList",e.allProducts)("orderReturnedItems",e.orderDetails.returned_items)}}function De(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",3),o.Pb(1,"h5",98),o.vc(2," Add "),o.Pb(3,"span"),o.vc(4," Cheque Information"),o.Ob(),o.Ob(),o.Pb(5,"button",99),o.Wb("click",(function(){return o.oc(e),o.Yb().paymentCancelled()})),o.Pb(6,"span",6),o.vc(7,"\xd7"),o.Ob(),o.Ob(),o.Ob()}}function Ie(e,t){1&e&&(o.Pb(0,"div",120),o.vc(1," Please select a payment method! "),o.Ob())}function Me(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please add Cheque Number! "),o.Ob())}function Te(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please add Payment Date! "),o.Ob())}function Ae(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please add Bank Name! "),o.Ob())}function Re(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please add Total Amount! "),o.Ob())}function Le(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Negative values not allowed "),o.Ob())}function qe(e,t){if(1&e&&(o.Pb(0,"span",121),o.vc(1),o.Zb(2,"number"),o.Ob()),2&e){const e=o.Yb(3);o.yb(1),o.xc(" Amount should not be greater than ",o.bc(2,1,null==e.cash?null:e.cash.amount_received,"1.2-2")," ")}}function Ne(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",116),o.Pb(1,"div",78),o.Pb(2,"label",110),o.vc(3,"Total Amount*"),o.Ob(),o.Pb(4,"input",122,123),o.Wb("focus",(function(t){return o.oc(e),o.Yb(2).focused(t)}))("blur",(function(t){return o.oc(e),o.Yb(2).left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).chequeAmount=t})),o.Ob(),o.Ob(),o.tc(6,Re,2,0,"span",113),o.tc(7,Le,2,0,"span",113),o.tc(8,qe,3,4,"span",113),o.Ob()}if(2&e){const e=o.nc(5),t=o.Yb(2);o.yb(4),o.ec("max",null==t.cash?null:t.cash.amount_received)("ngModel",t.chequeAmount),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&t.chequeAmount<0&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&t.chequeAmount>(null==t.cash?null:t.cash.amount_received)&&t.isAdded)}}function Be(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",9),o.Pb(1,"div",100),o.Pb(2,"div",101),o.Pb(3,"div",102),o.Pb(4,"div",103),o.Pb(5,"input",104),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCheque=t}))("click",(function(){o.oc(e);const t=o.Yb();return t.chequeAmount=null,t.currentFullPayment("Cheque Payment","Credit")})),o.Ob(),o.Pb(6,"label",105),o.vc(7,"Full Amount"),o.Ob(),o.Ob(),o.Ob(),o.Pb(8,"div",102),o.Pb(9,"div",103),o.Pb(10,"input",106),o.Wb("click",(function(){return o.oc(e),o.Yb().setPartial("Cheque Payment")}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCheque=t})),o.Ob(),o.Pb(11,"label",107),o.vc(12,"Partial Amount"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(13,Ie,2,0,"div",108),o.Pb(14,"div",8),o.Pb(15,"div",109),o.Pb(16,"div",78),o.Pb(17,"label",110),o.vc(18,"Cheque Number*"),o.Ob(),o.Pb(19,"input",111,112),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().chequeNumber=t})),o.Ob(),o.Ob(),o.tc(21,Me,2,0,"span",113),o.Ob(),o.Pb(22,"div",109),o.Pb(23,"div",78),o.Pb(24,"label",110),o.vc(25,"Date*"),o.Ob(),o.Pb(26,"input",114,115),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentDate=t})),o.Ob(),o.Ob(),o.tc(28,Te,2,0,"span",113),o.Ob(),o.Pb(29,"div",116),o.Pb(30,"div",78),o.Pb(31,"label",110),o.vc(32,"Bank Name*"),o.Ob(),o.Pb(33,"input",117,118),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().bankName=t})),o.Ob(),o.Ob(),o.tc(35,Ae,2,0,"span",113),o.Ob(),o.tc(36,Ne,9,5,"div",119),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.nc(20),t=o.nc(34),i=o.Yb();o.yb(5),o.ec("ngModel",i.paymentTypeCheque),o.yb(5),o.ec("ngModel",i.paymentTypeCheque),o.yb(3),o.ec("ngIf",""===i.paymentTypeCheque&&i.isAdded),o.yb(6),o.ec("ngModel",i.chequeNumber),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&i.isAdded),o.yb(5),o.ec("ngModel",i.paymentDate),o.yb(2),o.ec("ngIf","  "===i.paymentDate&&i.isAdded),o.yb(5),o.ec("ngModel",i.bankName),o.yb(2),o.ec("ngIf",(null==t.errors?null:t.errors.required)&&i.isAdded),o.yb(1),o.ec("ngIf","full"!==i.paymentTypeCheque)}}function Ye(e,t){1&e&&(o.Pb(0,"div",3),o.Pb(1,"h5",98),o.vc(2," Add "),o.Pb(3,"span"),o.vc(4,"Credit Information"),o.Ob(),o.Ob(),o.Pb(5,"button",20),o.Pb(6,"span",6),o.vc(7,"\xd7"),o.Ob(),o.Ob(),o.Ob())}function Ee(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please select a payment method! "),o.Ob())}function Je(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Please add Total Amount! "),o.Ob())}function Ke(e,t){1&e&&(o.Pb(0,"span",121),o.vc(1," Negative values not allowed "),o.Ob())}function Fe(e,t){if(1&e&&(o.Pb(0,"span",121),o.vc(1),o.Zb(2,"number"),o.Ob()),2&e){const e=o.Yb(3);o.yb(1),o.xc(" Amount should not be greater than ",o.bc(2,1,e.dueAmount-((null==e.cheque?null:e.cheque.amount_received)||0),"1.2-2")," ")}}function Qe(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",109),o.Pb(1,"div",78),o.Pb(2,"label",110),o.vc(3,"Amount*"),o.Ob(),o.Pb(4,"input",130,131),o.Wb("focus",(function(t){return o.oc(e),o.Yb(2).focused(t)}))("blur",(function(t){return o.oc(e),o.Yb(2).left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).creditAmount=t})),o.Ob(),o.Ob(),o.tc(6,Je,2,0,"span",113),o.tc(7,Ke,2,0,"span",113),o.tc(8,Fe,3,4,"span",113),o.Ob()}if(2&e){const e=o.nc(5),t=o.Yb(2);o.yb(4),o.ec("max",t.dueAmount-((null==t.cheque?null:t.cheque.amount_received)||0))("ngModel",t.creditAmount),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&t.creditAmount<0&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&t.creditAmount>t.dueAmount-((null==t.cheque?null:t.cheque.amount_received)||0)&&t.isAdded)}}function $e(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",100),o.Pb(1,"div",9),o.Pb(2,"div",101),o.Pb(3,"div",124),o.Pb(4,"div",103),o.Pb(5,"input",125),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCredit=t}))("click",(function(){o.oc(e);const t=o.Yb();return t.creditAmount=null,t.currentFullPayment("Credit","Cheque payment")})),o.Ob(),o.Pb(6,"label",126),o.vc(7,"Full Amount"),o.Ob(),o.Ob(),o.tc(8,Ee,2,0,"span",113),o.Ob(),o.Pb(9,"div",124),o.Pb(10,"div",103),o.Pb(11,"input",127),o.Wb("click",(function(){return o.oc(e),o.Yb().setPartial("Credit")}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCredit=t})),o.Ob(),o.Pb(12,"label",128),o.vc(13,"Partial Amount"),o.Ob(),o.Ob(),o.Ob(),o.tc(14,Qe,9,5,"div",129),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(5),o.ec("ngModel",e.paymentTypeCredit),o.yb(3),o.ec("ngIf",""===e.paymentTypeCredit&&e.isAdded),o.yb(3),o.ec("ngModel",e.paymentTypeCredit),o.yb(3),o.ec("ngIf","full"!==e.paymentTypeCredit)}}function ze(e,t){1&e&&(o.Pb(0,"div",132),o.Pb(1,"h5",121),o.vc(2,' You have to choose "Partial Amount" to use both Credit and Cheque Payment! '),o.Ob(),o.Ob())}function We(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-order-items-list",155),o.Wb("deleteReturned",(function(t){return o.oc(e),o.Yb(2).deleteReturnedProduct(t)}))("openDrawer",(function(){return o.oc(e),o.Yb(2).openProductsList()}))("openReturnedModal",(function(){return o.oc(e),o.Yb(2).openReturnedModal()}))("productUpdated",(function(){return o.oc(e),o.Yb(2).calculateReceivable()})),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("currentTab",e.currentTab)("orderDetail",e.orderDetails)("returnAmount",e.returnAmount)("dueAmount",e.dueAmount)("isChequeAdded",e.isChequeAdded)("isCreditAdded",e.isCreditAdded)("receivableAmount",e.receivableAmount)("totalPayment",e.totalPayment)("cheque",e.cheque)("credit",e.credit)("cash",e.cash)("orders",e.retailersList)("schemes",e.schemes)("selectedRetailer",e.selectedRetailer)("returnedProduct",e.returnedProduct)("allProducts",e.inventory)("specialDiscounts",e.specialDiscounts)("merchantDiscount",e.merchantDiscount)("newProduct",e.newProduct)("orderType","execution")("recoveryAmount",e.recoveryAmount)}}function Ze(e,t){1&e&&(o.Pb(0,"div",9),o.Kb(1,"app-loader-white"),o.Ob())}function Ve(e,t){1&e&&(o.Pb(0,"div",156),o.Pb(1,"div",157),o.Kb(2,"img",158),o.Pb(3,"strong"),o.vc(4,"Select order to see details"),o.Ob(),o.Ob(),o.Ob())}function Ge(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",167),o.Wb("click",(function(){o.oc(e);const t=o.Yb(3);return t.isCredit=!1,t.isFullyPaymentAdded("Cheque Payment")})),o.vc(1," Add Cheque "),o.Ob()}if(2&e){const e=o.Yb(3);o.ec("disabled",!e.selectedRetailer)}}function Ue(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",168),o.Wb("click",(function(){return o.oc(e),o.Yb(3).removeCheque()})),o.vc(1," Remove Cheque "),o.Ob()}if(2&e){const e=o.Yb(3);o.ec("disabled",!e.selectedRetailer)}}function He(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",169),o.Wb("click",(function(){o.oc(e);const t=o.Yb(3);return t.isCredit=!0,t.isFullyPaymentAdded("Credit")})),o.vc(1," Add Credit "),o.Ob()}if(2&e){const e=o.Yb(3);o.ec("disabled",!e.selectedRetailer)}}function je(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",170),o.Wb("click",(function(){return o.oc(e),o.Yb(3).removeCredit()})),o.vc(1," Remove Credit "),o.Ob()}if(2&e){const e=o.Yb(3);o.ec("disabled",!e.selectedRetailer)}}function Xe(e,t){1&e&&(o.Pb(0,"button",171),o.vc(1," Show Modal "),o.Ob())}function et(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",159),o.tc(1,Ge,2,1,"button",160),o.tc(2,Ue,2,1,"button",161),o.tc(3,He,2,1,"button",162),o.tc(4,je,2,1,"button",163),o.tc(5,Xe,2,0,"button",164),o.Pb(6,"button",165),o.Wb("click",(function(){return o.oc(e),o.Yb(2).saveExecutionQuantity()})),o.vc(7," Save Order "),o.Ob(),o.Pb(8,"button",166),o.vc(9," Cancel Order "),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.isChequeAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.isChequeAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.isCreditAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.isCreditAdded),o.yb(1),o.ec("ngIf",!e.savingOrder),o.yb(1),o.ec("disabled",e.savingOrder||!e.selectedRetailer),o.yb(2),o.ec("disabled",e.savingOrder||!e.selectedRetailer)}}function tt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",133),o.Pb(1,"div",134),o.Pb(2,"div",135),o.Pb(3,"div",136),o.Pb(4,"div",137),o.Pb(5,"strong"),o.vc(6,"Date:"),o.Ob(),o.Pb(7,"span",138),o.vc(8),o.Ob(),o.Ob(),o.Ob(),o.Pb(9,"div",139),o.Pb(10,"div",140),o.Pb(11,"strong"),o.vc(12,"Order Booker:"),o.Ob(),o.Pb(13,"b",141),o.vc(14),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",139),o.Pb(16,"div",140),o.Pb(17,"strong"),o.vc(18,"Territory:"),o.Ob(),o.Pb(19,"span",142),o.vc(20),o.Ob(),o.Ob(),o.Ob(),o.Pb(21,"div",136),o.Pb(22,"div",137),o.Pb(23,"strong"),o.vc(24,"Total Outlets:"),o.Ob(),o.Pb(25,"span",143),o.vc(26),o.Ob(),o.Ob(),o.Ob(),o.Pb(27,"div",144),o.Pb(28,"div",145),o.Pb(29,"strong"),o.vc(30,"Total Amount:"),o.Ob(),o.Pb(31,"span",146),o.vc(32),o.Zb(33,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(34,"div",147),o.Pb(35,"div",148),o.Pb(36,"app-retailer-sub-list",149),o.Wb("retailerChanged",(function(t){return o.oc(e),o.Yb().getOrderDetailsByRetailer(t)})),o.Ob(),o.Ob(),o.Pb(37,"div",150),o.Pb(38,"div",151),o.tc(39,We,1,21,"app-order-items-list",152),o.tc(40,Ze,2,0,"div",40),o.tc(41,Ve,5,0,"div",153),o.Ob(),o.tc(42,et,10,7,"div",154),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.ec("ngClass",1===e.currentTab?"show active":""),o.yb(8),o.wc((null==e.dispatchSummary?null:e.dispatchSummary.date)||"--"),o.yb(6),o.wc((null==e.dispatchSummary?null:e.dispatchSummary.order_bookers.join(", "))||"--"),o.yb(6),o.wc((null==e.dispatchSummary?null:e.dispatchSummary.territories.join(", "))||"--"),o.yb(6),o.wc((null==e.dispatchSummary?null:e.dispatchSummary.total_outlets)||"--"),o.yb(6),o.xc("Rs. ",o.bc(33,14,(null==e.dispatchSummary?null:e.dispatchSummary.total_amount)||0,"1.2-2"),""),o.yb(4),o.ec("loading",e.loading||e.savingOrder)("currentTab",e.currentTab)("retailers",e.retailersList)("orderType","execution"),o.yb(3),o.ec("ngIf",!e.savingOrder&&e.selectedRetailer),o.yb(1),o.ec("ngIf",e.savingOrder),o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.selectedRetailer),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.selectedRetailer)}}function it(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e),o.yb(1),o.yc("",e.employee_first_name," ",e.employee_last_name," ")}}function rt(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.route_id),o.yb(1),o.wc(e.name)}}function nt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",174),o.Pb(1,"div",175),o.Pb(2,"div",176),o.Pb(3,"ng-select",182),o.Wb("change",(function(t){return o.oc(e),o.Yb(2).getRetaielrsByRoute(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).selectedRoute=t})),o.tc(4,rt,2,2,"ng-option",76),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(3),o.ec("ngModel",e.selectedRoute),o.yb(1),o.ec("ngForOf",e.bookerRoutes)}}function at(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=o.Yb().$implicit;o.ec("value",e),o.yb(1),o.xc(" ",e.retailer_name,"")}}function ot(e,t){if(1&e&&(o.Nb(0),o.tc(1,at,2,2,"ng-option",184),o.Mb()),2&e){const e=t.$implicit;o.yb(1),o.ec("ngIf",!e.isAdded)}}function st(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",174),o.Pb(1,"div",175),o.Pb(2,"div",176),o.Pb(3,"ng-select",183),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb(2).spotRetailer=t})),o.tc(4,ot,2,1,"ng-container",91),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(3),o.ec("ngModel",e.spotRetailer),o.yb(1),o.ec("ngForOf",e.routeRetailers)}}function dt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",185),o.Wb("click",(function(){return o.oc(e),o.Yb(2).setSpotSaleRetailer()})),o.vc(1," Add Order "),o.Ob()}}function ct(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-order-items-list",186),o.Wb("openDrawer",(function(){return o.oc(e),o.Yb(2).openProductsList()}))("openReturnedModal",(function(){return o.oc(e),o.Yb(2).openReturnedModal()}))("productUpdated",(function(){return o.oc(e),o.Yb(2).calculateReceivable()}))("deleteReturned",(function(t){return o.oc(e),o.Yb(2).deleteReturnedProduct(t)})),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("currentTab",e.currentTab)("orderDetail",e.orderDetails)("returnAmount",e.returnAmount)("isChequeAdded",e.isChequeAdded)("isCreditAdded",e.isCreditAdded)("receivableAmount",e.receivableAmount)("totalPayment",e.totalPayment)("cheque",e.cheque)("credit",e.credit)("orders",e.spotSaleOrder.retailers)("cash",e.cash)("schemes",e.schemes)("dueAmount",e.dueAmount)("selectedRetailer",e.selectedRetailer)("orderType","execution")("allProducts",e.inventory)("specialDiscounts",e.specialDiscounts)("merchantDiscount",e.merchantDiscount)("newProduct",e.newProduct)}}function lt(e,t){1&e&&(o.Pb(0,"div",9),o.Kb(1,"app-loader-white"),o.Ob())}function bt(e,t){1&e&&(o.Pb(0,"div",156),o.Pb(1,"div",157),o.Kb(2,"img",158),o.Pb(3,"strong"),o.vc(4,"Select order to see details"),o.Ob(),o.Ob(),o.Ob())}function ut(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",191),o.Wb("click",(function(){o.oc(e);const t=o.Yb(3);return t.isCredit=!1,t.isFullyPaymentAdded("Cheque Payment")})),o.vc(1," Add Cheque "),o.Ob()}}function pt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",192),o.Wb("click",(function(){return o.oc(e),o.Yb(3).removeCheque()})),o.vc(1," Remove Cheque "),o.Ob()}}function ht(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",193),o.Wb("click",(function(){o.oc(e);const t=o.Yb(3);return t.isCredit=!0,t.isFullyPaymentAdded("Credit")})),o.vc(1," Add Credit "),o.Ob()}}function mt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",194),o.Wb("click",(function(){return o.oc(e),o.Yb(3).removeCredit()})),o.vc(1," Remove Credit "),o.Ob()}}function gt(e,t){1&e&&(o.Pb(0,"button",171),o.vc(1," Show Modal "),o.Ob())}function vt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",159),o.tc(1,ut,2,0,"button",187),o.tc(2,pt,2,0,"button",188),o.tc(3,ht,2,0,"button",189),o.tc(4,mt,2,0,"button",190),o.tc(5,gt,2,0,"button",164),o.Pb(6,"button",165),o.Wb("click",(function(){return o.oc(e),o.Yb(2).saveSpotSaleOrder()})),o.vc(7," Save Order "),o.Ob(),o.Pb(8,"button",166),o.vc(9," Cancel "),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.isChequeAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.isChequeAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.isCreditAdded),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.isCreditAdded),o.yb(1),o.ec("ngIf",!e.savingOrder),o.yb(1),o.ec("disabled",!(null!=e.orderDetails&&null!=e.orderDetails.items&&e.orderDetails.items.length||null!=e.orderDetails&&null!=e.orderDetails.returned_items&&e.orderDetails.returned_items.length)),o.yb(2),o.ec("disabled",!e.orderDetails)}}function Ot(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",172),o.Pb(1,"div",134),o.Pb(2,"div",135),o.Pb(3,"div",136),o.Pb(4,"div",137),o.Pb(5,"strong"),o.vc(6,"Date:"),o.Ob(),o.Pb(7,"span",138),o.vc(8),o.Ob(),o.Ob(),o.Ob(),o.Pb(9,"div",139),o.Pb(10,"div",140),o.Pb(11,"strong"),o.vc(12,"Order Booker:"),o.Ob(),o.Pb(13,"b",141),o.vc(14),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",139),o.Pb(16,"div",140),o.Pb(17,"strong"),o.vc(18,"Territory:"),o.Ob(),o.Pb(19,"span",142),o.vc(20),o.Ob(),o.Ob(),o.Ob(),o.Pb(21,"div",136),o.Pb(22,"div",137),o.Pb(23,"strong"),o.vc(24,"Total Outlets:"),o.Ob(),o.Pb(25,"span",143),o.vc(26),o.Ob(),o.Ob(),o.Ob(),o.Pb(27,"div",144),o.Pb(28,"div",145),o.Pb(29,"strong"),o.vc(30,"Total Amount:"),o.Ob(),o.Pb(31,"span",146),o.vc(32),o.Zb(33,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(34,"div",9),o.Pb(35,"div",173),o.Pb(36,"div",8),o.Pb(37,"div",174),o.Pb(38,"div",175),o.Pb(39,"div",176),o.Pb(40,"ng-select",177),o.Wb("change",(function(){return o.oc(e),o.Yb().getOrderBookerRoutes()}))("ngModelChange",(function(t){return o.oc(e),o.Yb().selectedOrderBooker=t})),o.tc(41,it,2,3,"ng-option",76),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(42,nt,5,2,"div",178),o.tc(43,st,5,2,"div",178),o.tc(44,dt,2,0,"button",179),o.Ob(),o.Ob(),o.Ob(),o.Pb(45,"div",147),o.Pb(46,"div",148),o.Pb(47,"app-retailer-sub-list",180),o.Wb("retailerChanged",(function(t){return o.oc(e),o.Yb().setCurrentSpotSaleOrder(t)})),o.Ob(),o.Ob(),o.Pb(48,"div",150),o.Pb(49,"div",151),o.tc(50,ct,1,19,"app-order-items-list",181),o.tc(51,lt,2,0,"div",40),o.tc(52,bt,5,0,"div",153),o.Ob(),o.tc(53,vt,10,7,"div",154),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.ec("ngClass",2===e.currentTab?"show active":""),o.yb(8),o.wc(e.spotSaleOrder.date),o.yb(6),o.wc(e.spotSaleOrder.orderBookerName),o.yb(6),o.wc(e.spotSaleOrder.territory),o.yb(6),o.wc(e.spotSaleOrder.retailers.length),o.yb(6),o.xc("Rs. ",o.bc(33,19,e.spotSaleOrder.order_total||0,"1.2-2"),""),o.yb(8),o.ec("ngModel",e.selectedOrderBooker),o.yb(1),o.ec("ngForOf",e.orderBookers),o.yb(1),o.ec("ngIf",e.selectedOrderBooker),o.yb(1),o.ec("ngIf",e.selectedRoute),o.yb(1),o.ec("ngIf",e.spotRetailer&&e.showAddRetailer),o.yb(3),o.ec("retailers",e.spotSaleOrder.retailers)("currentTab",e.currentTab)("orderType","execution")("isSpotSaleActive",e.isSpotSaleActive),o.yb(3),o.ec("ngIf",!e.savingOrder&&e.selectedRetailer),o.yb(1),o.ec("ngIf",e.savingOrder),o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.selectedRetailer),o.yb(1),o.ec("ngIf",!e.savingOrder&&e.selectedRetailer)}}function Pt(e,t){if(1&e&&(o.Pb(0,"div",195),o.Kb(1,"app-retailer-recovery",196),o.Ob()),2&e){const e=o.Yb();o.ec("ngClass",3===e.currentTab?"show active":""),o.yb(1),o.ec("executionData",e.executionData)}}function _t(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e),o.yb(1),o.yc("",e.employee_first_name," ",e.employee_last_name," ")}}function ft(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.route_id),o.yb(1),o.wc(e.name)}}function yt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",174),o.Pb(1,"div",175),o.Pb(2,"div",176),o.Pb(3,"ng-select",182),o.Wb("change",(function(t){return o.oc(e),o.Yb(2).getRetaielrsByRoute(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).selectedRoute=t})),o.tc(4,ft,2,2,"ng-option",76),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(3),o.ec("ngModel",e.selectedRoute),o.yb(1),o.ec("ngForOf",e.bookerRoutes)}}function xt(e,t){if(1&e&&(o.Pb(0,"ng-option",88),o.vc(1),o.Ob()),2&e){const e=o.Yb().$implicit;o.ec("value",e),o.yb(1),o.xc(" ",e.retailer_name,"")}}function St(e,t){if(1&e&&(o.Nb(0),o.tc(1,xt,2,2,"ng-option",184),o.Mb()),2&e){const e=t.$implicit;o.yb(1),o.ec("ngIf",!e.isAdded)}}function Ct(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",174),o.Pb(1,"div",175),o.Pb(2,"div",176),o.Pb(3,"ng-select",199),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb(2).recoveryRetailer=t}))("change",(function(){return o.oc(e),o.Yb(2).setRecoveryRetailer()})),o.tc(4,St,2,1,"ng-container",91),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(3),o.ec("ngModel",e.recoveryRetailer),o.yb(1),o.ec("ngForOf",e.routeRetailers)}}function wt(e,t){if(1&e&&o.Kb(0,"app-retailer-recovery",200),2&e){const e=o.Yb(2);o.ec("retailerId",null==e.recoveryRetailer?null:e.recoveryRetailer.retailer_id)("assignment_idOutRoute",e.executionData.assignment_id)}}function kt(e,t){1&e&&(o.Pb(0,"div",9),o.Kb(1,"app-loader-white"),o.Ob())}function Dt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",195),o.Pb(1,"div",9),o.Pb(2,"div",173),o.Pb(3,"div",8),o.Pb(4,"div",174),o.Pb(5,"div",175),o.Pb(6,"div",176),o.Pb(7,"ng-select",177),o.Wb("change",(function(){return o.oc(e),o.Yb().getOrderBookerRoutes()}))("ngModelChange",(function(t){return o.oc(e),o.Yb().selectedOrderBooker=t})),o.tc(8,_t,2,3,"ng-option",76),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(9,yt,5,2,"div",178),o.tc(10,Ct,5,2,"div",178),o.Ob(),o.Ob(),o.Ob(),o.Pb(11,"div",197),o.tc(12,wt,1,2,"app-retailer-recovery",198),o.tc(13,kt,2,0,"div",40),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.ec("ngClass",4===e.currentTab?"show active":""),o.yb(7),o.ec("ngModel",e.selectedOrderBooker),o.yb(1),o.ec("ngForOf",e.orderBookers),o.yb(1),o.ec("ngIf",e.selectedOrderBooker),o.yb(1),o.ec("ngIf",e.selectedRoute),o.yb(2),o.ec("ngIf",e.isRecvoryRetailerCanged),o.yb(1),o.ec("ngIf",e.isAdded)}}function It(e,t){if(1&e&&(o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.vc(8),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Ob(),o.Pb(11,"td"),o.vc(12),o.Ob(),o.Pb(13,"td"),o.vc(14),o.Ob(),o.Ob()),2&e){const e=t.$implicit;o.yb(2),o.wc(e.item_id),o.yb(2),o.wc(e.item_name),o.yb(2),o.wc(e.unit_name),o.yb(2),o.wc(e.total_dispatch_qty),o.yb(2),o.wc(e.total_return_qty),o.yb(2),o.wc(e.total_sold_qty),o.yb(2),o.wc(e.total_cancel_qty)}}function Mt(e,t){if(1&e&&(o.Pb(0,"table",217),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th"),o.vc(4,"SN"),o.Ob(),o.Pb(5,"th"),o.vc(6,"Product Name"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Unit"),o.Ob(),o.Pb(9,"th"),o.vc(10,"Issue QTY."),o.Ob(),o.Pb(11,"th"),o.vc(12,"Return QTY."),o.Ob(),o.Pb(13,"th"),o.vc(14,"Sold QTY."),o.Ob(),o.Pb(15,"th"),o.vc(16,"Inventory Return"),o.Ob(),o.Ob(),o.Ob(),o.Pb(17,"tbody"),o.tc(18,It,15,7,"tr",91),o.Ob(),o.Ob()),2&e){const e=o.Yb(3);o.ec("dtOptions",e.dtOPtions),o.yb(18),o.ec("ngForOf",null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.contents)}}function Tt(e,t){1&e&&(o.Pb(0,"button",218),o.vc(1," Add Expense "),o.Ob())}function At(e,t){1&e&&(o.Pb(0,"button",219),o.Pb(1,"div",220),o.Pb(2,"span",95),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}function Rt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",221),o.Pb(1,"a",222),o.Wb("click",(function(){return o.oc(e),o.Yb(3).generateDSR()})),o.vc(2,"Generate DSR"),o.Ob(),o.Ob()}}function Lt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",9),o.Pb(1,"button",223),o.Wb("click",(function(){return o.oc(e),o.Yb(3).checkRecieveable()})),o.vc(2," Mark Complete "),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(3);o.yb(1),o.ec("disabled",0==+e.amountReceived)}}function qt(e,t){1&e&&(o.Pb(0,"div",9),o.Pb(1,"button",224),o.Pb(2,"div",220),o.Pb(3,"span",95),o.vc(4,"Loading..."),o.Ob(),o.Ob(),o.Ob(),o.Ob())}function Nt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",8),o.Pb(1,"div",203),o.Pb(2,"div",204),o.Pb(3,"h2",205),o.vc(4,"Delivery "),o.Pb(5,"span"),o.vc(6," Challan"),o.Ob(),o.Ob(),o.Ob(),o.tc(7,Mt,19,2,"table",206),o.Ob(),o.Pb(8,"div",102),o.Pb(9,"div",207),o.Pb(10,"div",208),o.Pb(11,"h2",209),o.vc(12," Cash "),o.Pb(13,"span"),o.vc(14,"Report"),o.Ob(),o.tc(15,Tt,2,0,"button",210),o.tc(16,At,4,0,"button",211),o.Ob(),o.Pb(17,"div",212),o.Pb(18,"strong"),o.vc(19,"Gross Amount:"),o.Ob(),o.Pb(20,"span"),o.vc(21),o.Zb(22,"number"),o.Ob(),o.Ob(),o.Pb(23,"div",212),o.Pb(24,"strong"),o.vc(25,"Trade Offer:"),o.Ob(),o.Pb(26,"span"),o.vc(27),o.Zb(28,"number"),o.Ob(),o.Ob(),o.Pb(29,"div",212),o.Pb(30,"strong"),o.vc(31,"Trade Discount:"),o.Ob(),o.Pb(32,"span"),o.vc(33),o.Zb(34,"number"),o.Ob(),o.Ob(),o.Pb(35,"div",212),o.Pb(36,"strong"),o.vc(37,"Special Discount:"),o.Ob(),o.Pb(38,"span"),o.vc(39),o.Zb(40,"number"),o.Ob(),o.Ob(),o.Pb(41,"div",212),o.Pb(42,"strong"),o.vc(43,"Extra Discount:"),o.Ob(),o.Pb(44,"span"),o.vc(45),o.Zb(46,"number"),o.Ob(),o.Ob(),o.Pb(47,"div",212),o.Pb(48,"strong"),o.vc(49,"Total Tax:"),o.Ob(),o.Pb(50,"span"),o.vc(51),o.Zb(52,"number"),o.Ob(),o.Ob(),o.Pb(53,"div",213),o.Pb(54,"strong"),o.vc(55,"Total Net Sale:"),o.Ob(),o.Pb(56,"span"),o.vc(57),o.Zb(58,"number"),o.Ob(),o.Ob(),o.Pb(59,"div",212),o.Pb(60,"strong"),o.vc(61,"Expense:"),o.Ob(),o.Pb(62,"span"),o.vc(63),o.Zb(64,"number"),o.Ob(),o.Ob(),o.Pb(65,"div",212),o.Pb(66,"strong"),o.vc(67,"Return Amount:"),o.Ob(),o.Pb(68,"span"),o.vc(69),o.Zb(70,"number"),o.Ob(),o.Ob(),o.Pb(71,"div",212),o.Pb(72,"strong"),o.vc(73,"Recovery:"),o.Ob(),o.Pb(74,"span"),o.vc(75),o.Zb(76,"number"),o.Ob(),o.Ob(),o.Pb(77,"div",213),o.Pb(78,"strong"),o.vc(79,"Total Net Receivable:"),o.Ob(),o.Pb(80,"span"),o.vc(81),o.Zb(82,"number"),o.Ob(),o.Ob(),o.Pb(83,"div",212),o.Pb(84,"strong"),o.vc(85,"Cheque:"),o.Ob(),o.Pb(86,"span"),o.vc(87),o.Zb(88,"number"),o.Ob(),o.Ob(),o.Pb(89,"div",212),o.Pb(90,"strong"),o.vc(91,"Credit:"),o.Ob(),o.Pb(92,"span"),o.vc(93),o.Zb(94,"number"),o.Ob(),o.Ob(),o.Pb(95,"div",212),o.Pb(96,"strong"),o.vc(97,"Cash:"),o.Ob(),o.Pb(98,"span"),o.vc(99),o.Zb(100,"number"),o.Ob(),o.Ob(),o.Pb(101,"div",214),o.Pb(102,"strong"),o.vc(103,"AMT. Received:"),o.Ob(),o.Pb(104,"input",215),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb(2).amountReceived=t}))("keydown",(function(t){return o.oc(e),o.Yb(2).isNumber(t)})),o.Ob(),o.Ob(),o.Pb(105,"div",213),o.Pb(106,"strong"),o.vc(107,"Balance AMT:"),o.Ob(),o.Pb(108,"span"),o.vc(109),o.Zb(110,"number"),o.Ob(),o.Ob(),o.Pb(111,"div",212),o.Pb(112,"div",8),o.tc(113,Rt,3,0,"div",216),o.tc(114,Lt,3,1,"div",40),o.tc(115,qt,5,0,"div",40),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(7),o.ec("ngIf",null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.contents),o.yb(8),o.ec("ngIf",!e.isAdded),o.yb(1),o.ec("ngIf",e.isAdded),o.yb(5),o.wc(o.bc(22,22,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_gross_amount,"1.2-2")),o.yb(6),o.wc(o.bc(28,25,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_trade_offer,"1.2-2")),o.yb(6),o.wc(o.bc(34,28,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_trade_discount,"1.2-2")),o.yb(6),o.wc(o.bc(40,31,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_special_discount,"1.2-2")),o.yb(6),o.wc(o.bc(46,34,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_booker_discount,"1.2-2")),o.yb(6),o.wc(o.bc(52,37,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_tax_amount,"1.2-2")),o.yb(6),o.wc(o.bc(58,40,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_net_amount,"1.2-2")),o.yb(6),o.wc(o.bc(64,43,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_expense,"1.2-2")),o.yb(6),o.wc(o.bc(70,46,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_return_amount,"1.2-2")),o.yb(6),o.wc(o.bc(76,49,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_recovered_amount,"1.2-2")),o.yb(6),o.wc(o.bc(82,52,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_net_after_recovery,"1.2-2")),o.yb(6),o.wc(o.bc(88,55,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_cheque_amount,"1.2-2")),o.yb(6),o.wc(o.bc(94,58,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_credit_amount,"1.2-2")),o.yb(6),o.wc(o.bc(100,61,null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_cash_amount,"1.2-2")),o.yb(5),o.ec("ngModel",e.amountReceived),o.yb(5),o.wc(o.bc(110,64,(null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_amount_recieveable)-e.amountReceived||0,"1.2-2")),o.yb(4),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading)}}function Bt(e,t){1&e&&(o.Pb(0,"div",9),o.Kb(1,"app-loader-white"),o.Ob())}function Yt(e,t){if(1&e&&(o.Pb(0,"div",201),o.Pb(1,"div",134),o.Pb(2,"div",135),o.Pb(3,"div",136),o.Pb(4,"div",137),o.Pb(5,"strong"),o.vc(6,"Date:"),o.Ob(),o.Pb(7,"span",138),o.vc(8),o.Ob(),o.Ob(),o.Ob(),o.Pb(9,"div",139),o.Pb(10,"div",140),o.Pb(11,"strong"),o.vc(12,"Order Booker:"),o.Ob(),o.Pb(13,"b",141),o.vc(14),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",139),o.Pb(16,"div",140),o.Pb(17,"strong"),o.vc(18,"Territory:"),o.Ob(),o.Pb(19,"span",142),o.vc(20),o.Ob(),o.Ob(),o.Ob(),o.Pb(21,"div",136),o.Pb(22,"div",137),o.Pb(23,"strong"),o.vc(24,"Total Outlets:"),o.Ob(),o.Pb(25,"span",143),o.vc(26),o.Ob(),o.Ob(),o.Ob(),o.Pb(27,"div",144),o.Pb(28,"div",145),o.Pb(29,"strong"),o.vc(30,"Total Amount:"),o.Ob(),o.Pb(31,"span",146),o.vc(32),o.Zb(33,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(34,"div",197),o.tc(35,Nt,116,67,"div",202),o.tc(36,Bt,2,0,"div",40),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("ngClass",5===e.currentTab?"show active":""),o.yb(8),o.wc((null==e.finalLoad||null==e.finalLoad.dsr||null==e.finalLoad.dsr.executed_date?null:e.finalLoad.dsr.executed_date.split(" ")[0])||"--"),o.yb(6),o.wc("--"),o.yb(6),o.wc((null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.territory)||"--"),o.yb(6),o.wc((null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_orders)||"--"),o.yb(6),o.xc("Rs. ",o.bc(33,8,(null==e.finalLoad||null==e.finalLoad.dsr?null:e.finalLoad.dsr.total_net_amount)||0,"1.2-2"),""),o.yb(3),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading)}}let Et=(()=>{class e{constructor(e,t,i,r,n,a,o,s,d,c){this.change=e,this.route=t,this.router=i,this.orderService=r,this.executionService=n,this.toastService=a,this.generalDataService=o,this.dataService=s,this.spotSaleService=d,this.storageService=c,this.dtOPtions={},this.orderDetails={},this.spotSaleOrder={},this.currentSpotSale={},this.recoveryListing=[],this.outOfRouteRecovery=[],this.orderBookers=[],this.bookerRoutes=[],this.routeRetailers=[],this.retailersList=[],this.schemes=[],this.inventory=[],this.allProducts=[],this.specialDiscounts=[],this.discountSlabs=[],this.isRecvoryRetailerCanged=!1,this.billsData=null,this.spotSaleOrderId=null}ngOnInit(){this.currentTab=1,this.dtOPtions={pagingType:"simple_numbers"},this.showAddRetailer=!0,this.getSchemesData(),this.setPaymentInitalValues(),this.setSpotSaleOrder(),this.salemanId=+this.route.snapshot.paramMap.get("saleManId"),this.orderDate=this.route.snapshot.paramMap.get("date"),this.selectedLoadId=+this.route.snapshot.paramMap.get("loadId"),this.salemanId&&this.orderDate&&this.selectedLoadId?(this.getOrdersBySalemanAndDate(),this.getOrderBookers()):this.router.navigateByUrl("/orders/execution-list")}setSpotSaleOrder(){this.spotSaleOrder={retailers:[],orders:[],order_total:0,date:(new Date).toISOString().split("T")[0],territory:"--",total_outlets:"--",orderBookerName:"--"}}setPaymentInitalValues(){this.netAmount=0,this.creditAmount=0,this.amountReceived=0,this.chequeAmount=0,this.returnAmount=0,this.dueAmount=0,this.receivableAmount=0,this.recoveryAmount=0,this.totalPayment=0,this.isChequeAdded=!1,this.isCreditAdded=!1,this.paymentDate=(new Date).toISOString().split("T")[0],this.distributorId=this.storageService.getItem("distributor").id}addNewProductToOrder(e){this.newProduct=e}getSchemesData(){this.orderService.getSchemes().subscribe(e=>{200===e.status&&(this.schemes=e.data)},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",title:"Error:",message:"Order details not fetched, please try again later!"})})}getOrdersBySalemanAndDate(){this.loading=!0,this.orderService.getExectedOrdersListing(this.salemanId,this.orderDate,this.selectedLoadId).subscribe(e=>{this.loading=!1,200===e.status?(this.executionData={assignment_id:e.data.assignment_id},this.retailersList=e.data.retailers,this.allProducts=e.data.all_products,this.loadId=e.data.load_id,this.spotSaleOrder.retailers=e.data.spot_sale_orders,this.inventory=e.data.executed_products,this.specialDiscounts=e.data.special_discount,this.dispatchSummary=e.data.summary,this.recoveryListing=e.data.out_of_route_recovery.map(e=>(e.recovery=e.amount_received,e.retailer_id=e.id,e.recoveryAdded=!0,e)),this.outOfRouteRecovery=e.data.out_of_route_recovery.map(e=>({retailer_id:e.id,amount:e.amount_received,booker_id:e.booker_id})),e.data.is_dsr&&this.changeTab(4)):this.toastService.showToaster({type:"error",title:"Error:",message:"Order details not fetched, please try again later!"})},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",title:"Error:",message:"Order details not fetched, please try again later!"})})}getOrderBookers(){this.generalDataService.getOrderBookers(this.distributorId).subscribe(e=>{200===e.status&&(this.orderBookers=e.data)},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",title:"Error:",message:"Bookers not fetched, please try again later!"})})}getOrderBookerRoutes(){this.spotSaleOrder.orderBookerName=`${this.selectedOrderBooker.employee_first_name} ${this.selectedOrderBooker.employee_last_name}`,this.selectedRoute=null,this.bookerRoutes=[],this.spotRetailer=null,this.routeRetailers=[],this.generalDataService.getOrderBookerRoutes(this.selectedOrderBooker.employee_id).subscribe(e=>{200===e.status&&(this.bookerRoutes=e.data)},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",title:"Error:",message:"Routes not fetched, please try again later!"})})}getRetaielrsByRoute(e){this.spotRetailer=null,this.routeRetailers=[],this.generalDataService.getRetailersByRoute(e).subscribe(e=>{200===e.status&&(this.routeRetailers=e.data,this.spotSaleOrder.retailers.length&&(this.routeRetailers=this.routeRetailers.map(e=>(this.spotSaleOrder.retailers.findIndex(t=>t.retailer_id===e.retailer_id)>-1&&(e.isAdded=!0),e))),this.retailersList.length&&(this.routeRetailers=this.routeRetailers.map(e=>(this.retailersList.findIndex(t=>t.retailer_id===e.retailer_id)>-1&&(e.isAdded=!0),e))))},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",title:"Error:",message:"Retailers not fetched, please try again later!"})})}setSpotSaleRetailer(){var e;if(this.spotSaleOrder.territory=this.spotRetailer.territory,!this.spotSaleOrder.retailers.find(e=>e.retailer_id===this.spotRetailer.retailer_id)){(null===(e=this.spotSaleOrder.retailers)||void 0===e?void 0:e.length)||(this.spotSaleOrder.retailers=[]),this.spotRetailer.isAdded=!0,delete this.spotRetailer.id,this.spotRetailer.region_id=this.selectedOrderBooker.region_id;const t=this.spotSaleService.setSpotSaleOrderContent(this.spotRetailer,this.selectedOrderBooker,this.distributorId);this.spotSaleOrder.orders.push(t);const i=JSON.parse(JSON.stringify(this.spotSaleOrder.retailers));i.push(this.spotRetailer),this.spotSaleOrder.retailers=JSON.parse(JSON.stringify(i)),this.showAddRetailer=!1,this.change.detectChanges()}}getOrderDetailsByRetailer(e){var t;(null===(t=this.selectedRetailer)||void 0===t?void 0:t.id)!==e.id&&(this.savingOrder=!0,this.newProduct=null,this.returnedProduct=null,this.paymentTypeCredit="",this.paymentTypeCheque="",this.resetPaymentValues(),this.setPaymentInitalValues(),this.selectedRetailer=JSON.parse(JSON.stringify(e)),this.orderService.getOrderDetails(e.id).subscribe(e=>{this.savingOrder=!1,200===e.status&&(this.orderDetails=e.data,this.orderDetails.returned_items=this.orderDetails.returned_items,this.recoveryAmount=this.orderDetails.recovery,this.orderDetails.recovered=+this.orderDetails.recovered.toFixed(2),this.orderDetails.payment&&this.orderDetails.payment.length&&this.orderDetails.payment.forEach(e=>{"Cheque"===e.payment_mode?this.setCheque(e):"Credit"===e.payment_mode?this.setCredit(e):"Cash"===e.payment_mode&&this.setCash(e)}),this.orderDetails.returned_items.length?this.setOrderDetailReturnedItems():this.receivableAmount=this.orderDetails.total_amount_after_tax+this.orderDetails.recovered,this.setOrderDetailItems(),this.calculateReceivable())},e=>{this.savingOrder=!1,1!==e.status&&401!==e.status&&(console.log("Error while getting order detail data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Order Detail. Please try again",title:"Error:"}))}),this.getDiscountSlabs())}setCash(e){this.cash={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Cash",payment_detail:"",dispatched_bill_amount:0,return_amount:this.returnAmount||0,recovery:0,amount_received:e.amount_received}}setCredit(e){this.paymentTypeCredit=e.amount_received<this.orderDetails.order_total?"partial":"full",this.credit={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Credit",payment_detail:"",dispatched_bill_amount:0,recovery:0,amount_received:e.amount_received},this.isCreditAdded=!0}setCheque(e){this.paymentTypeCheque=e.amount_received<this.orderDetails.order_total?"partial":"full";const t=JSON.parse(e.payment_detail);this.cheque={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Cheque",payment_detail:{cheque_amount:e.amount_received,bank_name:t.bank_name,cheque_number:t.cheque_number,cheque_date:t.cheque_date},dispatched_bill_amount:0,recovery:0,amount_received:e.amount_received},this.isChequeAdded=!0}setOrderDetailReturnedItems(){this.orderDetails.returned_items=this.orderDetails.returned_items.map(e=>(e.item_trade_price=e.original_price,e.stockQty=e.quantity_returned,e.extra_discount=e.booker_discount,e.extra_discount_pkr=e.booker_discount*e.quantity_returned,e.productType="returned",e.special_discount_pkr=0,e.trade_discount=0,e.trade_discount_pkr=0,e.net_amount=e.final_price,e.gross_amount=e.gross_sale_amount,e.original_amount=e.gross_sale_amount,e))}setOrderDetailItems(){this.orderDetails.items=this.orderDetails.items.map(e=>{const t=this.inventory.find(t=>t.item_id===e.item_id);if(t)return e.parent_trade_price=JSON.parse(JSON.stringify(t.parent_trade_price)),e.parent_unit_id=JSON.parse(JSON.stringify(t.parent_unit_id)),e.parent_quantity=JSON.parse(JSON.stringify(t.quantity)),e.child=JSON.parse(JSON.stringify(t.child)),e.item_retail_price=JSON.parse(JSON.stringify(t.item_retail_price)),e.extra_discount=JSON.parse(JSON.stringify(e.booker_discount)),e.tax_class_amount=JSON.parse(JSON.stringify(t.tax_class_amount)),e.tax_class_id=JSON.parse(JSON.stringify(t.tax_class_id)),e.tax_class_type=JSON.parse(JSON.stringify(t.tax_class_type)),e.pref_id=JSON.parse(JSON.stringify(t.pref_id)),e.unit_id=JSON.parse(JSON.stringify(t.unit_id)),e.unit_name=JSON.parse(JSON.stringify(t.unit_name)),e.brand_id=JSON.parse(JSON.stringify(t.brand_id)),e.is_active=JSON.parse(JSON.stringify(t.is_active)),e.item_trade_price=JSON.parse(JSON.stringify(t.item_trade_price)),e.stockQty=JSON.parse(JSON.stringify(e.executed_qty)),e.net_amount=JSON.parse(JSON.stringify(e.final_price)),e.gross_amount=e.item_trade_price*e.stockQty,e.extra_discount_pkr=e.stockQty*e.extra_discount,e.original_amount=e.item_trade_price*e.stockQty,e.special_discount_pkr=e.special_discount,e.trade_discount=JSON.parse(JSON.stringify(e.merchant_discount)),e.trade_discount_pkr=JSON.parse(JSON.stringify(e.merchant_discount_pkr)),e.tax_amount_pkr=JSON.parse(JSON.stringify(e.total_tax_amount||0)),e.selectedScheme=this.schemes.find(t=>t.id===e.scheme_id),e}),this.orderDetails.items=this.orderDetails.items.filter(e=>e)}setCurrentSpotSaleOrder(e){this.isSpotSaleActive?this.toastService.showToaster({type:"error",message:"Please complete the current order to move forward!",title:"Spot Sale Error:"}):e.id?(this.isSpotSaleActive=!0,this.getOrderDetailsByRetailer(e)):(this.resetPaymentValues(),this.setPaymentInitalValues(),this.selectedRetailer=Object.assign({},e),this.isSpotSaleActive=!0,this.orderDetails=this.spotSaleOrder.orders.find(t=>t.retailer_id===e.retailer_id),this.getDiscountSlabs(),this.newProduct=null)}getDiscountSlabs(){this.discountSlabs.length?this.setMerchantDiscount():this.orderService.getDiscountSlabs().subscribe(e=>{200===e.status&&(this.discountSlabs=e.data,this.setMerchantDiscount())},e=>{1!==e.status&&401!==e.status&&(console.log("Error while getting order detail data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Merchant Discounts. Please try again",title:"Error:"}))})}setMerchantDiscount(){this.merchantDiscount=this.discountSlabs.find(e=>e.region_id===this.selectedRetailer.region_id&&this.selectedRetailer.segment_id===e.segment_id&&e.channel_id===(this.selectedRetailer.retailer_type_id||this.selectedRetailer.type_id))}handleReturnedProduct(e){this.orderDetails.returned_items.push(e),this.calculateReceivable()}deleteReturnedProduct(e){var t;e.id?(null===(t=this.inventory.find(t=>t.item_id===e.item_id))||void 0===t?void 0:t.available_qty)>=e.quantity_returned||"damage"===e.return_type?(e.stockQty=0,e.isDeleted=!0):this.toastService.showToaster({title:"Returned Product:",message:"The selected product is part of other order please remove from other orders and delete!",type:"error"}):this.orderDetails.returned_items=this.orderDetails.returned_items.filter(t=>t.item_id!==e.item_id),document.getElementById("close-prod-del").click(),this.calculateReceivable()}calculateReceivable(){const e=this.orderDetails.returned_items.filter(e=>!e.isDeleted).map(e=>e.net_amount);this.returnAmount=this.dataService.calculateItemsBill(e);const t=this.orderDetails.items.map(e=>e.net_amount);this.netAmount=this.dataService.calculateItemsBill(t),this.dueAmount=this.netAmount+this.returnAmount,this.receivableAmount=this.netAmount+this.orderDetails.recovered+this.returnAmount,this.selectedRetailer.order_total=this.dueAmount,2===this.currentTab&&(this.spotSaleOrder.retailers.find(e=>e.retailer_id===this.selectedRetailer.retailer_id).order_total=this.dueAmount),this.calculatePayments()}openProductsList(){this.isPaymentAdded()||(this.showProducts=!0,document.body.classList.add("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.add("d-block"),document.getElementById("order-container").classList.add("blur-div"))}isPaymentAdded(){return!(!this.isChequeAdded&&!this.isCreditAdded||(this.toastService.showToaster({title:"Payment Added:",message:"Please remove the payment to proceed!",type:"error"}),0))}closeNewProducts(){this.showProducts=!1,document.body.classList.remove("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.remove("d-block"),document.getElementById("order-container").classList.remove("blur-div")}openReturnedModal(){this.isPaymentAdded()||(this.showReturned=!0)}closeReturnedModal(){this.showReturned=!1}changeTab(e){this.currentTab=e,1===this.currentTab&&(this.retailersList=this.retailersList.map(e=>(e.isActive=!1,e)),this.selectedRetailer=null,this.orderDetails=null),2===this.currentTab&&(this.selectedRetailer&&(this.orderDetails.items=[],this.orderDetails.returned_items=[],this.selectedRetailer.isActive=!1,this.spotSaleOrder.retailers=this.spotSaleOrder.retailers.map(e=>(e.isActive=!1,e)),this.selectedRetailer=null,this.orderDetails=null),this.resetPaymentValues(),this.setPaymentInitalValues()),3===this.currentTab?this.orderService.setLoadRetaillersRecovery(!0):4===this.currentTab?(this.selectedOrderBooker=null,this.selectedRoute=null,this.recoveryRetailer=null):5===this.currentTab&&(this.isAdded=!1,this.getExecutionFinalLoad())}focused(e){e.target.parentElement.classList.add("focused")}left(e){e.target.value||e.target.parentElement.classList.remove("focused")}isNumber(e){return this.dataService.isNumber(e)}isFullyPaymentAdded(e){if(this.receivableAmount<=0){const e={type:"error",message:`Your receivable amount (${this.receivableAmount.toFixed(2)}) is not enough to add payment!`,title:"Payment cannot be added"};this.toastService.showToaster(e)}else"Credit"===e?this.paymentTypeCredit="":this.paymentTypeCheque="",this.selectedRetailer?"full"!==this.paymentTypeCheque&&"full"!==this.paymentTypeCredit||this.addedPayment===e?document.getElementById("open-modal-payment").click():this.toastService.showToaster({type:"error",message:`You already selected Full payment for ${this.addedPayment} please remove it if you want to add ${this.currentPayment}!`,title:"Full Payment selected for "+this.addedPayment}):this.toastService.showToaster({type:"error",message:"Please select order to add payment details!",title:"Payment cannot be added"})}currentFullPayment(e,t){"full"!==this.paymentTypeCheque&&"full"!==this.paymentTypeCredit||this.addedPayment===e?(this.addedPayment=e,this.currentPayment=t):this.toastService.showToaster({type:"error",message:`You already selected Full payment for ${this.addedPayment} please remove it if you want to add ${this.currentPayment}!`,title:"Full Payment selected for "+this.addedPayment})}setPartial(e){e===this.addedPayment&&(this.credit&&"Credit"===e&&(this.cash.amount_received=this.cash.amount_received+this.credit.amount_received,this.credit.amount_received=0),this.cheque&&"Cheque Payment"===e&&(this.cash.amount_received=this.cash.amount_received+this.cheque.amount_received,this.cheque.amount_received=0),this.addedPayment="",this.currentPayment="",this.alreadyFullPayment=!1)}checkPaymentHasValues(){return this.isCredit?"full"===this.paymentTypeCredit?this.paymentTypeCredit.length>0:this.paymentTypeCredit.length>0&&this.creditAmount>-1&&this.creditAmount<=this.dueAmount-(this.cheque?this.cheque.amount_received:0):"full"===this.paymentTypeCheque?this.paymentTypeCheque.length>0&&this.bankName.length>0&&this.chequeNumber.length>0&&this.paymentDate.length>0:this.paymentTypeCheque.length>0&&this.chequeAmount>-1&&this.chequeAmount<=this.cash.amount_received&&this.bankName.length>0&&this.chequeNumber.length>0&&this.paymentDate.length>0}removeCheque(){this.cheque=null,this.isChequeAdded=!1,this.paymentTypeCheque="",this.calculatePayments()}removeCredit(){this.credit=null,this.isCreditAdded=!1,this.paymentTypeCredit="",this.calculatePayments()}makePayment(){this.isCredit&&(this.credit={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Credit",payment_detail:"",dispatched_bill_amount:0,recovery:0,amount_received:"full"===this.paymentTypeCredit?JSON.parse(JSON.stringify(this.dueAmount-(this.cheque?this.cheque.amount_received:0))):JSON.parse(JSON.stringify(this.creditAmount))},this.isCreditAdded=!0),this.isCredit||(this.cheque={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Cheque",payment_detail:{cheque_amount:"full"===this.paymentTypeCheque?JSON.parse(JSON.stringify(this.receivableAmount)):JSON.parse(JSON.stringify(this.chequeAmount)),bank_name:JSON.parse(JSON.stringify(this.bankName)),cheque_number:JSON.parse(JSON.stringify(this.chequeNumber)),cheque_date:JSON.parse(JSON.stringify(this.paymentDate))},dispatched_bill_amount:0,recovery:0,amount_received:"full"===this.paymentTypeCheque?JSON.parse(JSON.stringify(this.receivableAmount)):JSON.parse(JSON.stringify(this.chequeAmount))},this.isChequeAdded=!0),this.calculatePayments()}addPaymentMethod(){this.isAdded=!0,this.checkPaymentHasValues()&&(this.isAdded=!1,this.makePayment(),document.getElementById("open-modal-payment").click())}paymentCancelled(){this.isAdded=!1,this.paymentTypeCredit="",this.paymentTypeCheque=""}resetPaymentValues(){this.chequeAmount=null,this.paymentDate=(new Date).toISOString().split("T")[0],this.bankName="",this.chequeNumber=null,this.creditAmount=null,this.cash=null,this.cheque=null,this.credit=null}calculatePayments(){this.cash={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:1===this.currentTab?"Execution":"Spot",payment_mode:"Cash",payment_detail:"",dispatched_bill_amount:0,return_amount:this.returnAmount||0,recovery:0,amount_received:Math.round(100*(this.receivableAmount+Number.EPSILON))/100},this.cheque&&(this.cheque.return_amount=this.returnAmount||0,this.cash.amount_received=this.cash.amount_received-this.cheque.amount_received),this.credit&&(this.credit.return_amount=this.returnAmount||0,this.cash.amount_received=this.cash.amount_received-this.credit.amount_received),this.totalPayment=this.cheque?this.cash.amount_received+this.cheque.amount_received:this.cash.amount_received,2===this.currentTab&&(this.spotSaleOrder.retailers.find(e=>e.retailer_id===this.selectedRetailer.retailer_id).order_total=this.dueAmount),this.selectedRetailer.order_total=this.dueAmount,1===this.currentTab&&(this.retailersList.find(e=>e.id===this.selectedRetailer.id).order_total=this.dueAmount),2===this.currentTab&&(this.spotSaleOrder.retailers.find(e=>e.retailer_id===this.selectedRetailer.retailer_id).order_total=this.dueAmount),this.orderDetails.order_total=this.dueAmount,this.orderDetails.total_amount_after_tax=this.dueAmount}saveExecutionQuantity(){this.orderDetails.items=this.executionService.setOrderPayloadItems(this.orderDetails,this.selectedRetailer),this.orderDetails.returned_items=this.executionService.setOrderPayloadReturnedItems(this.orderDetails,this.selectedRetailer),this.cash.amount_received=this.cash.amount_received>-1?this.cash.amount_received:this.netAmount,this.orderDetails.payment={total_payment:this.totalPayment>-1?this.totalPayment:this.netAmount,detail:[this.cash]},this.credit&&this.orderDetails.payment.detail.push(this.credit),this.cheque&&this.orderDetails.payment.detail.push(this.cheque),this.savingOrder=!0,this.orderService.saveExecutionQuantityOrder(this.orderDetails).subscribe(e=>{this.savingOrder=!1,200===e.status&&(this.inventory=e.data.executed_products,this.toastService.showToaster({message:`Order for ${this.selectedRetailer.retailer_name.toUpperCase()} execution updated successfully!`,title:"Order execution:",type:"success"}),this.newProduct=null,this.orderDetails.items=[],this.orderDetails.returned_items=[],this.selectedRetailer.isActive=!1,1===this.currentTab&&(this.retailersList.find(e=>e.id===this.selectedRetailer.id).isActive=!1),2===this.currentTab&&(this.spotSaleOrder.retailers.find(e=>e.id===this.selectedRetailer.id).isActive=!1),this.selectedRetailer=null,this.resetPaymentValues(),this.setPaymentInitalValues())},e=>{this.savingOrder=!1,1!==e.status&&401!==e.status&&(console.log("Error in Save Order for execution ::>> ",e),this.toastService.showToaster({message:"Something went wrong execution cannot be save at the moment!",title:"Error:",type:"error"}))})}openBillsModal(){document.getElementById("billsPrintPaperModalTrigger").click()}getBills(e="A4"){document.getElementById("close-bills").click(),window.open(`${L.a.apiDomain}${R.a.BILLS}?type=bill&emp=${this.billsData.salesman_id}&date=${this.billsData.order_date}&dist_id=${this.billsData.distributorId}&size=${e}&status=processed&orderID=${this.spotSaleOrderId}`,"_blank")}saveSpotSaleOrder(){if(this.orderDetails.items.map(e=>e.stockQty).filter(e=>!e).length)return this.toastService.showToaster({message:"Please provide quantities for all the items",title:"Error:",type:"error"});this.savingOrder=!0,this.orderDetails.load_id=this.loadId,this.orderDetails.processed_at=this.orderDate,this.orderDetails.processed_by=this.distributorId,this.orderDetails.sales_man_id=this.salemanId,this.orderDetails.dispatched_by=this.distributorId,this.orderDetails.dispatched_at=this.orderDate,this.orderDetails.status="Processed",this.billsData={load_id:this.loadId,distributorId:this.distributorId,salesman_id:this.salemanId,order_date:this.orderDate},this.orderDetails.items=this.executionService.setOrderPayloadItems(this.orderDetails,this.selectedRetailer),this.orderDetails.returned_items=this.executionService.setOrderPayloadReturnedItems(this.orderDetails,this.selectedRetailer),this.orderDetails.payment={total_payment:this.totalPayment,detail:[this.cash]},this.credit&&this.orderDetails.payment.detail.push(this.credit),this.cheque&&this.orderDetails.payment.detail.push(this.cheque),this.orderService.saveSpotSaleOrder(this.orderDetails).subscribe(e=>{if(this.savingOrder=!1,this.isSpotSaleActive=!1,200===e.status){this.openBillsModal();const t={type:"success",message:`Spot Sale for ${this.selectedRetailer.retailer_name.toUpperCase()} saved successfully!`,title:"Spot Sale Saved:"};this.newProduct=null,this.toastService.showToaster(t),this.inventory=e.data.executed_products,this.selectedRetailer.id=e.data.order.id,this.spotSaleOrderId=e.data.order.id;const i=this.spotSaleOrder.orders.findIndex(e=>e.retailer_id===this.orderDetails.retailer_id),r=this.spotSaleOrder.retailers.findIndex(e=>e.retailer_id===this.selectedRetailer.retailer_id);this.spotSaleOrder.retailers[r].id=e.data.order.id,this.spotSaleOrder.retailers[r].order_total=e.data.order.order_total,this.spotSaleOrder.orders[i]=JSON.parse(JSON.stringify(e.data.order)),this.orderDetails=JSON.parse(JSON.stringify(e.data.order));const n=this.spotSaleOrder.orders.find(e=>0===e.order_total);this.showAddRetailer=!n,this.setOrderDetailItems(),this.setOrderDetailReturnedItems()}},e=>{this.savingOrder=!1,this.isSpotSaleActive=!1})}validateCancel(){var e;if(null===(e=this.orderDetails.returned_items)||void 0===e?void 0:e.length){let e=!0;const t=this.orderDetails.returned_items.find(t=>{var i;if((null===(i=this.inventory.find(e=>e.item_id===t.item_id))||void 0===i?void 0:i.available_qty)<t.quantity_returned&&"damage"!==t.return_type)return e=!1,t});return!e&&t&&this.toastService.showToaster({title:"Returned Product:",message:"The selected order has returned products which or part of other orders, cannot cancel the order!",type:"error"}),e}return!0}cancelOrder(){document.getElementById("close-del").click(),this.validateCancel()&&(this.savingOrder=!0,this.orderService.canceleExecutionOrder(this.orderDetails.id).subscribe(e=>{this.savingOrder=!1,200===e.status&&(this.toastService.showToaster({message:`Order for ${this.selectedRetailer.retailer_name.toUpperCase()} canceled!`,title:"Order Execution:",type:"success"}),this.newProduct=null,this.selectedRetailer=null,this.orderDetails.items=[],this.setPaymentInitalValues(),this.getOrdersBySalemanAndDate())},e=>{this.savingOrder=!1,1!==e.status&&401!==e.status&&(console.log("Error in Save Order for dispatch ::>> ",e),this.toastService.showToaster({message:"Something went wrong order cannot be canceled at the moment!",title:"Error:",type:"error"}))}))}cancelSpotSale(){this.orderDetails.id?this.cancelSpotSaleOrder():(this.removeSpotOrder(),document.getElementById("close-del").click())}cancelSpotSaleOrder(){document.getElementById("close-del").click(),this.validateCancel()&&(this.savingOrder=!0,this.orderService.cancelSpotSaleOrder(this.orderDetails.id).subscribe(e=>{this.savingOrder=!1,this.isSpotSaleActive=!1,200===e.status&&(this.toastService.showToaster({message:`Order for ${this.selectedRetailer.retailer_name.toUpperCase()} canceled!`,title:"Spot Order:",type:"success"}),this.newProduct=null,this.inventory=e.data.executed_products,this.removeSpotOrder())},e=>{this.savingOrder=!1,this.isSpotSaleActive=!1,1!==e.status&&401!==e.status&&(console.log("Error in cancel spot sale Order ::>> ",e),this.toastService.showToaster({message:"Something went wrong order cannot be canceled at the moment!",title:"Error:",type:"error"}))}))}removeSpotOrder(){this.selectedRetailer.isAdded=!1,this.spotSaleOrder.retailers=this.spotSaleOrder.retailers.filter(e=>e.retailer_id!==this.selectedRetailer.retailer_id),this.spotSaleOrder.orders=this.spotSaleOrder.orders.filter(e=>e.retailer_id!==this.selectedRetailer.retailer_id),this.orderDetails.items=[],this.orderDetails.returned_items=[],this.isSpotSaleActive=!1,this.selectedRetailer=null;const e=this.spotSaleOrder.orders.find(e=>0===e.order_total);this.showAddRetailer=!e,this.resetPaymentValues(),this.setPaymentInitalValues()}getExecutionFinalLoad(){this.loading=!0,this.orderService.getExecutionFinalLoad(this.loadId,this.outOfRouteRecovery).subscribe(e=>{this.loading=!1,200===e.status&&(this.finalLoad=e.data,this.recoveryListing=e.data.out_of_route_recovery.map(e=>(e.recovery=e.amount_received,e.retailer_id=e.id,e.recoveryAdded=!0,e)),this.outOfRouteRecovery=e.data.out_of_route_recovery.map(e=>({retailer_id:e.id,amount:e.amount_received,booker_id:e.booker_id})))},e=>{this.loading=!1,1!==e.status&&401!==e.status&&(console.log("Error while fetching execution delivery challan :>> ",e),this.toastService.showToaster({message:"Delivery challan not fetched, please try again later!",title:"Delivery Challan Error:",type:"error"}))})}getExpense(e){return this.finalLoad.expense_types.find(t=>t.id===e).name}addExpense(e,t){if(e.value&&t.value){const i=JSON.parse(JSON.stringify(this.finalLoad.expense_detail)),r=i.findIndex(t=>t.expense_type===+e.value);r>-1?i[r].amount=t.value:i.push({expense_type:+e.value,amount:+t.value}),e.value="",t.value="",this.finalLoad.expense_detail=JSON.parse(JSON.stringify(i)),this.setIsExpenseAdded()}else this.toastService.showToaster({type:"error",title:"Expense Error:",message:"Please select expense type and add amount!"})}removeExpense(e){this.finalLoad.expense_detail=this.finalLoad.expense_detail.filter(t=>t.expense_type!==e),this.setIsExpenseAdded()}setIsExpenseAdded(){this.isExpenseAdded=!0,setTimeout(()=>{this.isExpenseAdded=!1},500)}saveExpense(){document.getElementById("close-expense").click(),this.isAdded=!0,this.finalLoad.expense_detail=this.finalLoad.expense_detail.map(e=>({expense_type:+e.expense_type,amount:+e.amount})),this.orderService.saveExecutionExpense(this.loadId,this.salemanId,this.orderDate,this.finalLoad.expense_detail).subscribe(e=>{this.isAdded=!1,200===e.status&&(this.toastService.showToaster({title:"Expense Saved:",message:"Expense saved successfully!",type:"success"}),this.finalLoad=e.data)},e=>{this.isAdded=!1,1!==e.status&&401!==e.status&&(console.log("Error while saving expenses :>> ",e),this.toastService.showToaster({title:"Expense Error:",message:"Expense not saved, please try again before marking complete!",type:"error"}))})}checkRecovery(e){+e.recovery>e.balance&&(this.toastService.showToaster({title:"Recovery Error:",message:"Recovered amount cannot be greater than credit!",type:"error"}),e.recovery=0)}setRecoveryRetailer(){this.isRecvoryRetailerCanged=!1,console.log("recovery retailer changed id = ",this.recoveryRetailer.retailer_id),setTimeout(()=>{this.isRecvoryRetailerCanged=!0},0)}addRevoery(e){e.recoveryAdded=!0,this.outOfRouteRecovery.push({retailer_id:e.retailer_id,amount:+e.recovery,booker_id:e.booker_id||this.selectedOrderBooker.employee_id})}removeRecovery(e){e.order_payment_id?this.orderService.removeOutOfRuoteRecovery(e.order_payment_id).subscribe(t=>{200===t.status&&this.resetRecoveryValues(e)}):this.resetRecoveryValues(e)}resetRecoveryValues(e){this.isAdded=!0,e.recoveryAdded=!1,e.recovery=0,this.outOfRouteRecovery=this.outOfRouteRecovery.filter(t=>t.retailer_id!==e.retailer_id),this.recoveryListing=this.recoveryListing.filter(t=>t.retailer_id!==e.retailer_id),setTimeout(()=>{this.isAdded=!1},500)}checkRecieveable(){0==+this.amountReceived?this.toastService.showToaster({title:"Execution Error:",message:"Please add received amount!",type:"error"}):document.getElementById("show-complete").click()}amountReceivedMax(){const e=this.finalLoad.dsr.total_amount_recieveable.toFixed(2);+this.amountReceived>+e&&(this.toastService.showToaster({title:"Execution Error:",message:`Received amount cannot be greater than ${this.finalLoad.dsr.total_amount_recieveable}!`,type:"error"}),this.amountReceived=0)}markCompelet(){var e,t,i,r,n,a;document.getElementById("close-complete").click(),this.loading=!0,this.orderService.markCompeleteExecution(this.loadId,{saleman_id:this.salemanId,total_amount_recieved:+this.amountReceived,dsr_id:null===(t=null===(e=this.finalLoad)||void 0===e?void 0:e.dsr)||void 0===t?void 0:t.id,net_receivable:null===(r=null===(i=this.finalLoad)||void 0===i?void 0:i.dsr)||void 0===r?void 0:r.total_net_after_recovery,balance:(null===(a=null===(n=this.finalLoad)||void 0===n?void 0:n.dsr)||void 0===a?void 0:a.total_net_after_recovery)-this.amountReceived,execution_date:this.orderDate}).subscribe(e=>{this.loading=!1,200===e.status&&(this.toastService.showToaster({title:"Execution Completed:",message:"Execution completed successfully!",type:"success"}),this.router.navigateByUrl("/orders/execution-list"))},e=>{this.loading=!1,console.log("Execution complete Error :>> ",e),1!==e.status&&401!==e.status&&this.toastService.showToaster({title:"Execution Error:",message:"Execution not completed, please try again later!",type:"error"})})}generateDSR(){window.open(`${L.a.apiDomain}${R.a.DSR_PDF}/${this.finalLoad.dsr.id}`)}ngOnDestroy(){this.change.detach()}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(o.h),o.Jb(a.a),o.Jb(a.f),o.Jb(c.a),o.Jb(W),o.Jb(l.a),o.Jb(d.b),o.Jb(d.a),o.Jb(Z),o.Jb(J.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-execute-order"]],decls:147,vars:23,consts:[["id","billsModalCounterSale","tabindex","-1","role","dialog","aria-labelledby","billsModalCounterSaleLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","top_border"],[1,"modal-header"],["id","billsModalCounterSaleLabel",1,"modal-title"],["type","button","id","close-bills","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-12"],[1,"heading3"],[1,"row","print-icon-div","pb-0"],[1,"col-6","pl-0"],[3,"click"],["src","assets/images/a4.svg","alt","",1,"print-icon"],[1,"col-6","pr-0"],["src","assets/images/a5.svg","alt","",1,"print-icon"],["id","order-del","tabindex","-1","role","dialog","aria-labelledby","orderLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-content","top-borderRed"],["id","orderLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],[1,"col-md-12"],[1,"modal-footer","border-0"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","submit","id","close-del","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],["id","order-complete","tabindex","-1","role","dialog","aria-labelledby","orderCompleteLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-content"],["type","button",1,"btn","btn-primary",3,"click"],["type","submit","id","close-complete","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],["hidden","","data-target","#order-complete","data-toggle","modal","id","show-complete"],["id","expenseModal","tabindex","-1","role","dialog","aria-labelledby","expenseLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered",2,"max-width","850px"],[1,"modal-content","top-borderBlue"],["id","expnseLabel",1,"modal-title"],["class","modal-body",4,"ngIf"],["type","button","id","close-expense","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],[3,"selectedRetailer","orderType","orderedProducts","loadingProducts","allProducts","productSchemes","productMerchantDiscount","specialDiscounts","drawerClosed","productSelected",4,"ngIf"],[3,"productsList","orderReturnedItems","productReturned","closeReturned",4,"ngIf"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["class","modal-header",4,"ngIf"],["class","col-12",4,"ngIf"],["id","floating-label","class","form-wrap p-0",4,"ngIf"],["class","form-wrap p-10",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button","id","close-payment-modal","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel",3,"click"],["id","order-container",1,"container","mw-1280"],[1,"card","daily-operations"],["id","pills-tab","role","tablist",1,"nav","nav-pills","nav_M","mb-3"],[1,"nav-item"],["id","pills-home-tab",1,"nav-link",3,"ngClass"],[1,"wz-icon"],[1,"fa","fa-list-ul"],["id","pills-sale-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-dollar-sign"],["id","pills--load-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-redo"],["id","pills-load-tab",1,"nav-link",3,"ngClass"],["id","pills-final-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-check"],["id","pills-tabContent",1,"tab-content"],["class","tab-pane tab_M p-0 PT-10 fade","id","pills-home","role","tabpanel","aria-labelledby","pills-home-tab",3,"ngClass",4,"ngIf"],["class","tab-pane tab_M p-0 PT-10 fade","id","pills-sale","role","tabpanel","aria-labelledby","pills-sale-tab",3,"ngClass",4,"ngIf"],["class","tab-pane tab_M p-0 PT-20 fade","id","pills-load","role","tabpanel","aria-labelledby","pills-load-tab",3,"ngClass",4,"ngIf"],["class","tab-pane tab_M p-0 PT-10 fade","id","pills-final","role","tabpanel","aria-labelledby","pills-final-tab",3,"ngClass",4,"ngIf"],[1,"col-md-12","text-center"],[1,"execFooter"],["type","submit",1,"btn","btn-primary","m-0","mr-2",3,"disabled","click"],["type","submit",1,"btn","btn-primary","m-0",3,"disabled","click"],["data-toggle","modal","data-target","#billsModalCounterSale","id","billsPrintPaperModalTrigger","hidden","",1,"btn","btn-default","mb-0"],[1,"row","mb-20"],[1,"col-md-4","pr-0"],[1,"font12","mb-5"],["data-select2-id","39",1,"form-s2","focused"],["id","expense_type","placeholder","Expense Type","tabindex","-1","aria-hidden","true","value","",1,"form-control","formselect","expense_id","select2-hidden-accessible",2,"width","100%","font-size","12px"],["expenseType",""],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3","pr-0"],[1,"form-group","focused"],[1,"control-label"],["type","number","id","expense-amount","placeholder","",1,"form-control","expense_amount",3,"keydown"],["expenseAmount",""],[1,"col-2",2,"padding-top","29px"],["type","button",1,"btn","btn-primary","add_expense_btn",3,"click"],[1,"expense_table"],["id","expenseAddedTable_wrapper",1,"dataTables_wrapper","dt-bootstrap4","no-footer"],["class","table","datatable","","id","expenseAddedTable","style","width: 100%","role","grid","aria-describedby","expenseAddedTable_info",3,"dtOptions",4,"ngIf"],["class","col-md-12","style","text-align: center; padding: 30px",4,"ngIf"],[3,"value"],["datatable","","id","expenseAddedTable","role","grid","aria-describedby","expenseAddedTable_info",1,"table",2,"width","100%",3,"dtOptions"],["role","row"],[4,"ngFor","ngForOf"],[1,"btn","btn-default","red-bg","mb-0","remove_expense",3,"id","click"],[1,"col-md-12",2,"text-align","center","padding","30px"],["role","status",1,"spinner-border",2,"width","5rem","height","5rem","color","#0038ba"],[1,"sr-only"],[3,"selectedRetailer","orderType","orderedProducts","loadingProducts","allProducts","productSchemes","productMerchantDiscount","specialDiscounts","drawerClosed","productSelected"],[3,"productsList","orderReturnedItems","productReturned","closeReturned"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["id","floating-label",1,"form-wrap","p-0"],[1,"row","pt-10"],[1,"col-4"],[1,"custom-control","custom-radio"],["type","radio","name","payment","id","payment1","value","full",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","payment1",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["type","radio","name","payment","id","payment2","value","partial",1,"custom-control-input",3,"ngModel","click","ngModelChange"],["for","payment2",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["class","col-12 input-error",4,"ngIf"],[1,"col-md-6","PT-10"],[1,"control-label","mb-10"],["type","text","id","chequeNum","name","cheque_num","required","","autocomplete","off",1,"form-control","cheque_num",3,"ngModel","focus","blur","ngModelChange"],["chequNo","ngModel"],["class","input-error",4,"ngIf"],["type","date","id","datepicker","required","","placeholder","","autocomplete","off","name","payment_date",1,"form-control","cheque_date",3,"ngModel","focus","blur","ngModelChange"],["payDate","ngModel"],[1,"col-md-6","PT-5"],["type","text","name","cheque_bank_name","id","chequeBankName","required","","autocomplete","off",1,"form-control","cheque_bank_name",3,"ngModel","focus","blur","ngModelChange"],["bank_Name","ngModel"],["class","col-md-6 PT-5",4,"ngIf"],[1,"col-12","input-error"],[1,"input-error"],["type","number","min","0","name","cheque_amount","required","","id","Amount1","autocomplete","off",1,"form-control","cheque_amount",3,"max","ngModel","focus","blur","ngModelChange"],["cheqAmount","ngModel"],[1,"col-6"],["type","radio","name","payment","id","Amount1","value","full",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","Amount1",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["type","radio","name","payment","id","Amount2","value","partial",1,"custom-control-input",3,"ngModel","click","ngModelChange"],["for","Amount2",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["class","col-md-6 PT-10",4,"ngIf"],["type","number","min","0","name","cheque_amount","required","","autocomplete","off",1,"form-control","cheque_amount",3,"max","ngModel","focus","blur","ngModelChange"],["credAmount","ngModel"],[1,"form-wrap","p-10"],["id","pills-home","role","tabpanel","aria-labelledby","pills-home-tab",1,"tab-pane","tab_M","p-0","PT-10","fade",3,"ngClass"],[1,"topstats"],[1,"row","m-0"],[1,"col","pr-0"],[1,"gary-box"],[1,"execution_date"],[1,"col-auto","pr-0"],[1,"gary-box","min-w"],[1,"execution_bookers","float-right"],[1,"execution_territories"],[1,"execution_order"],[1,"col"],[1,"gary-box",2,"min-width","200px"],[1,"execution_amount"],[1,"row","m-0","grayTopborder"],["id","orderList-id",1,"col-4","p-0"],[3,"loading","currentTab","retailers","orderType","retailerChanged"],[1,"col","p-0"],[1,"rightHeight"],[3,"currentTab","orderDetail","returnAmount","dueAmount","isChequeAdded","isCreditAdded","receivableAmount","totalPayment","cheque","credit","cash","orders","schemes","selectedRetailer","returnedProduct","allProducts","specialDiscounts","merchantDiscount","newProduct","orderType","recoveryAmount","deleteReturned","openDrawer","openReturnedModal","productUpdated",4,"ngIf"],["class","no-content",4,"ngIf"],["class","col-md-12 bottom-act-btn",4,"ngIf"],[3,"currentTab","orderDetail","returnAmount","dueAmount","isChequeAdded","isCreditAdded","receivableAmount","totalPayment","cheque","credit","cash","orders","schemes","selectedRetailer","returnedProduct","allProducts","specialDiscounts","merchantDiscount","newProduct","orderType","recoveryAmount","deleteReturned","openDrawer","openReturnedModal","productUpdated"],[1,"no-content"],[1,"no-content-container",2,"margin","auto","display","table","text-align","center","color","#b7b7b7"],["src","assets/images/select order-icon.svg","alt",""],[1,"col-md-12","bottom-act-btn"],["class","btn btn-primary float-left mr-2 font13",3,"disabled","click",4,"ngIf"],["class","btn btn-primary float-left font13 mr-2 red-bg",3,"disabled","click",4,"ngIf"],["class","btn btn-primary float-left font13",3,"disabled","click",4,"ngIf"],["class","btn btn-primary float-left font13 red-bg",3,"disabled","click",4,"ngIf"],["id","open-modal-payment","style","display: none","data-toggle","modal","data-target","#exampleModal2",4,"ngIf"],[1,"btn","btn-primary","mr-2","save_order_execution","font13",3,"disabled","click"],["data-toggle","modal","data-target","#order-del",1,"btn","btn-cancel","cancel_order_btn","font13",3,"disabled"],[1,"btn","btn-primary","float-left","mr-2","font13",3,"disabled","click"],[1,"btn","btn-primary","float-left","font13","mr-2","red-bg",3,"disabled","click"],[1,"btn","btn-primary","float-left","font13",3,"disabled","click"],[1,"btn","btn-primary","float-left","font13","red-bg",3,"disabled","click"],["id","open-modal-payment","data-toggle","modal","data-target","#exampleModal2",2,"display","none"],["id","pills-sale","role","tabpanel","aria-labelledby","pills-sale-tab",1,"tab-pane","tab_M","p-0","PT-10","fade",3,"ngClass"],[1,"Product-Filter","border-0"],[1,"col-3","pr-0"],[1,"_cust_filter","p-0","m-0","w-100"],[1,"form-s2"],["name","order-booker","placeholder","Select Order Booker",1,"formselect",2,"width","100% !important",3,"ngModel","change","ngModelChange"],["class","col-3 pr-0",4,"ngIf"],["class","btn add_button addpr addReturn add-ordr",3,"click",4,"ngIf"],[3,"retailers","currentTab","orderType","isSpotSaleActive","retailerChanged"],[3,"currentTab","orderDetail","returnAmount","isChequeAdded","isCreditAdded","receivableAmount","totalPayment","cheque","credit","orders","cash","schemes","dueAmount","selectedRetailer","orderType","allProducts","specialDiscounts","merchantDiscount","newProduct","openDrawer","openReturnedModal","productUpdated","deleteReturned",4,"ngIf"],["name","booker-route","placeholder","Select Route",1,"formselect",2,"width","100% !important",3,"ngModel","change","ngModelChange"],["name","spot-retailer","placeholder","Select Retailer",1,"formselect",2,"width","100% !important",3,"ngModel","ngModelChange"],[3,"value",4,"ngIf"],[1,"btn","add_button","addpr","addReturn","add-ordr",3,"click"],[3,"currentTab","orderDetail","returnAmount","isChequeAdded","isCreditAdded","receivableAmount","totalPayment","cheque","credit","orders","cash","schemes","dueAmount","selectedRetailer","orderType","allProducts","specialDiscounts","merchantDiscount","newProduct","openDrawer","openReturnedModal","productUpdated","deleteReturned"],["class","btn btn-primary float-left mr-2 font13",3,"click",4,"ngIf"],["class","btn btn-primary float-left font13 mr-2 red-bg",3,"click",4,"ngIf"],["class","btn btn-primary float-left font13",3,"click",4,"ngIf"],["class","btn btn-primary float-left font13 red-bg",3,"click",4,"ngIf"],[1,"btn","btn-primary","float-left","mr-2","font13",3,"click"],[1,"btn","btn-primary","float-left","font13","mr-2","red-bg",3,"click"],[1,"btn","btn-primary","float-left","font13",3,"click"],[1,"btn","btn-primary","float-left","font13","red-bg",3,"click"],["id","pills-load","role","tabpanel","aria-labelledby","pills-load-tab",1,"tab-pane","tab_M","p-0","PT-20","fade",3,"ngClass"],[3,"executionData"],[1,"col-12","PT-10"],[3,"retailerId","assignment_idOutRoute",4,"ngIf"],["name","spot-retailer","placeholder","Select Retailer",1,"formselect",2,"width","100% !important",3,"ngModel","ngModelChange","change"],[3,"retailerId","assignment_idOutRoute"],["id","pills-final","role","tabpanel","aria-labelledby","pills-final-tab",1,"tab-pane","tab_M","p-0","PT-10","fade",3,"ngClass"],["class","row",4,"ngIf"],[1,"col-8","PB-30","pr-0"],[1,"header","PT-10","PB-10","mb-15"],[1,"w-100"],["datatable","","class","table table-hover dt-responsive nowrap","id","example3","style","width: 100%",3,"dtOptions",4,"ngIf"],[1,"cash-report"],[1,"header"],[1,"cash-title","w-100","mb-15"],["class","btn btn-primary add-expense","data-toggle","modal","data-target","#expenseModal",4,"ngIf"],["class","btn btn-primary add-expense","disabled","",4,"ngIf"],[1,"report_value"],[1,"report_value",2,"color","#0038ba"],[1,"report_value",2,"height","40px","line-height","22px"],["type","number","placeholder","0",1,"form-control","value_input","amount_recieved_cashReport",3,"ngModel","ngModelChange","keydown"],["class","col-12 PB-10",4,"ngIf"],["datatable","","id","example3",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtOptions"],["data-toggle","modal","data-target","#expenseModal",1,"btn","btn-primary","add-expense"],["disabled","",1,"btn","btn-primary","add-expense"],["role","status",1,"spinner-border","text-light"],[1,"col-12","PB-10"],[1,"btn","btn-primary","w-100",3,"click"],[1,"btn","btn-primary","w-100",3,"disabled","click"],["type","submit","disabled","",1,"btn","btn-primary","w-100","mr-2"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"h5",4),o.vc(5," Print bill for this order"),o.Kb(6,"span"),o.Ob(),o.Pb(7,"button",5),o.Pb(8,"span",6),o.vc(9,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(10,"div",7),o.Pb(11,"div",8),o.Pb(12,"div",9),o.Pb(13,"h3",10),o.vc(14,"Select paper size for print"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",11),o.Pb(16,"div",12),o.Pb(17,"a",13),o.Wb("click",(function(){return t.getBills("A4")})),o.Kb(18,"img",14),o.Pb(19,"strong"),o.vc(20,"A4 Portrait Paper"),o.Ob(),o.Ob(),o.Ob(),o.Pb(21,"div",15),o.Pb(22,"a",13),o.Wb("click",(function(){return t.getBills("A5")})),o.Kb(23,"img",16),o.Pb(24,"strong"),o.vc(25,"A5 Landscape Paper"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(26,"div",17),o.Pb(27,"div",1),o.Pb(28,"div",18),o.Pb(29,"div",3),o.Pb(30,"h5",19),o.vc(31,"Cancel Order "),o.Kb(32,"span"),o.Ob(),o.Pb(33,"button",20),o.Pb(34,"span",6),o.vc(35,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(36,"div",7),o.Pb(37,"div",21),o.Pb(38,"p"),o.vc(39,"Are you sure you want to cancel the order?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(40,"div",22),o.tc(41,Pe,2,0,"button",23),o.tc(42,_e,2,0,"button",23),o.Pb(43,"button",24),o.vc(44," No "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(45,"div",25),o.Pb(46,"div",1),o.Pb(47,"div",26),o.Pb(48,"div",3),o.Pb(49,"h5",19),o.vc(50," Complete Execution "),o.Kb(51,"span"),o.Ob(),o.Pb(52,"button",20),o.Pb(53,"span",6),o.vc(54,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(55,"div",7),o.Pb(56,"div",21),o.Pb(57,"p"),o.vc(58,"Are you sure you want to Mark the order as Completed?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(59,"div",22),o.Pb(60,"button",27),o.Wb("click",(function(){return t.markCompelet()})),o.vc(61," Yes "),o.Ob(),o.Pb(62,"button",28),o.vc(63," No "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(64,"button",29),o.vc(65," show complete\n"),o.Ob(),o.Pb(66,"div",30),o.Pb(67,"div",31),o.Pb(68,"div",32),o.Pb(69,"div",3),o.Pb(70,"h5",33),o.vc(71,"Add "),o.Pb(72,"span"),o.vc(73,"Expense"),o.Ob(),o.Ob(),o.Pb(74,"button",20),o.Pb(75,"span",6),o.vc(76,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.tc(77,Ce,26,3,"div",34),o.Pb(78,"div",22),o.Pb(79,"button",27),o.Wb("click",(function(){return t.saveExpense()})),o.vc(80," Save "),o.Ob(),o.Pb(81,"button",35),o.vc(82," Cancel "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(83,we,1,8,"app-products-drawer",36),o.tc(84,ke,1,2,"app-returned-products",37),o.Pb(85,"div",38),o.Pb(86,"div",1),o.Pb(87,"div",2),o.tc(88,De,8,0,"div",39),o.tc(89,Be,37,10,"div",40),o.tc(90,Ye,8,0,"div",39),o.tc(91,$e,15,4,"div",41),o.tc(92,ze,3,0,"div",42),o.Pb(93,"div",22),o.Pb(94,"button",43),o.Wb("click",(function(){return t.addPaymentMethod()})),o.vc(95," Add "),o.Ob(),o.Pb(96,"button",44),o.Wb("click",(function(){return t.paymentCancelled()})),o.vc(97," Cancel "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(98,"div",45),o.Pb(99,"div",8),o.Pb(100,"div",21),o.Pb(101,"div",46),o.Pb(102,"ul",47),o.Pb(103,"li",48),o.Pb(104,"a",49),o.Pb(105,"span"),o.vc(106,"Orders"),o.Ob(),o.Pb(107,"span",50),o.Kb(108,"i",51),o.Ob(),o.Ob(),o.Ob(),o.Pb(109,"li",48),o.Pb(110,"a",52),o.Pb(111,"span"),o.vc(112,"Spot Sale"),o.Ob(),o.Pb(113,"span",50),o.Kb(114,"i",53),o.Ob(),o.Ob(),o.Ob(),o.Pb(115,"li",48),o.Pb(116,"a",54),o.Pb(117,"span"),o.vc(118,"Load Recovery"),o.Ob(),o.Pb(119,"span",50),o.Kb(120,"i",55),o.Ob(),o.Ob(),o.Ob(),o.Pb(121,"li",48),o.Pb(122,"a",56),o.Pb(123,"span"),o.vc(124,"Recovery"),o.Ob(),o.Pb(125,"span",50),o.Kb(126,"i",55),o.Ob(),o.Ob(),o.Ob(),o.Pb(127,"li",48),o.Pb(128,"a",57),o.Pb(129,"span"),o.vc(130,"Final"),o.Ob(),o.Pb(131,"span",50),o.Kb(132,"i",58),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(133,"div",59),o.tc(134,tt,43,17,"div",60),o.tc(135,Ot,54,22,"div",61),o.tc(136,Pt,2,2,"div",62),o.tc(137,Dt,14,7,"div",62),o.tc(138,Yt,37,11,"div",63),o.Pb(139,"div",64),o.Pb(140,"div",65),o.Pb(141,"button",66),o.Wb("click",(function(){return t.changeTab(t.currentTab-1)})),o.vc(142," Previous "),o.Ob(),o.Pb(143,"button",67),o.Wb("click",(function(){return t.changeTab(t.currentTab+1)})),o.vc(144," Next "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(145,"button",68),o.vc(146," Bill "),o.Ob(),o.Ob()),2&e&&(o.yb(41),o.ec("ngIf",1===t.currentTab),o.yb(1),o.ec("ngIf",2===t.currentTab),o.yb(35),o.ec("ngIf",t.finalLoad),o.yb(6),o.ec("ngIf",t.showProducts),o.yb(1),o.ec("ngIf",t.showReturned),o.yb(4),o.ec("ngIf",!t.isCredit),o.yb(1),o.ec("ngIf",!t.isCredit),o.yb(1),o.ec("ngIf",t.isCredit),o.yb(1),o.ec("ngIf",t.isCredit),o.yb(1),o.ec("ngIf","partial"===t.paymentTypeCheque&&"full"===t.paymentTypeCredit||"full"===t.paymentTypeCheque&&"partial"===t.paymentTypeCredit),o.yb(2),o.ec("disabled","partial"===t.paymentTypeCheque&&"full"===t.paymentTypeCredit||"full"===t.paymentTypeCheque&&"partial"===t.paymentTypeCredit),o.yb(10),o.ec("ngClass",1===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",2===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",3===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",4===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",5===t.currentTab?"active":""),o.yb(6),o.ec("ngIf",1===t.currentTab),o.yb(1),o.ec("ngIf",2===t.currentTab),o.yb(1),o.ec("ngIf",3===t.currentTab),o.yb(1),o.ec("ngIf",4===t.currentTab),o.yb(1),o.ec("ngIf",5===t.currentTab),o.yb(3),o.ec("disabled",1===t.currentTab||t.isSpotSaleActive||t.loading),o.yb(2),o.ec("disabled",t.isSpotSaleActive||t.loading||5===t.currentTab))},directives:[r.k,r.i,n.i,n.o,r.j,u.a,V.a,G.a,n.l,n.b,n.e,n.h,n.m,n.j,U.a,H.a,p.a,b.a,b.c,Oe],pipes:[r.d],styles:[".mw-1280{max-width:1280px}.retailerTable .table thead th{font-size:12px;padding:5px 8px!important}.retailerTable .table td{font-size:12px!important;padding:5px 4px!important;vertical-align:middle;line-height:1}.ProList-div{max-height:57vh;flex:1;overflow-y:auto;overflow-x:hidden;padding:10px;font-size:14px}.ProList-div .table img{margin-top:-2px;margin-bottom:-2px;margin-left:4px}.APS-list input{height:32px;border:1px solid #eae9e9;box-shadow:none;padding-left:30px;font-size:13px;letter-spacing:1px}.APS-list .fa{position:absolute;top:8px;left:8px;color:#b5b5b5}._selectProList .header .add_button{padding:4px 8px 3px;right:15px}._selectProList .APS-list{padding:0;width:100%;margin-top:10px;position:relative;float:right}.topstats{margin-top:10px;font-size:13px;margin-bottom:5px}.topstats .gary-box{line-height:1;background-color:#f9f9f9;border-bottom:1px solid #d1d1d1;padding:10px}.topstats .gary-box span{font-family:Rationale,sans-serif;color:#0038ba;font-size:18px;float:right;margin-top:-4px}.min-w{min-width:240px}.order-list{font-size:12px;background:#fff;padding:6px 10px;border:1px solid #eaeaea;position:relative;transition:all .2s;transform:translateZ(0);transform:scale(.97);cursor:pointer}.order-list.active{border-color:#0038ba}.order-list.active,.order-list:hover{box-shadow:0 0 22px 0 rgba(0,0,0,.18);transform:scale(1);z-index:3}.order-list span{display:block}.order-list span .fa{color:#b5b5b5}.order-list span.or-val{font-family:Rationale,sans-serif;font-size:16.5px;line-height:1;color:#0038ba}.order-list .ord-no{font-family:Poppins,sans-serif;line-height:1;font-size:35px;font-weight:800;padding-top:0;color:#ececec;position:absolute;right:80px;top:7px}.addPR-head{padding:15px 15px 0 20px!important;background:none!important}#orderList-id{flex:0 0 300px;max-width:300px;width:300px}.value_input{padding:2px;margin:0!important;font-size:12px;box-shadow:none;height:22px;width:52px}.total-valu-div{width:280px;min-height:173px;font-size:13px;padding-left:20px;padding-right:20px;margin-left:auto;margin-right:0;padding-top:5px;background-color:#f7f7f7;border:1px solid #ececec}.total-valu-div .row{border-bottom:1px solid #e8e6e6}.total-valu-div .row .col-6{padding:2px;line-height:1.5;font-family:proximanova-semibold,sans-serif!important}.total-valu-div span{font-family:Rationale,sans-serif;line-height:1.1;font-size:18px;text-align:right;display:block}.ProListHeight{height:calc(100vh - 200px)}.rightHeight{height:calc(100vh - 249px);overflow-y:auto}.productSearch{position:relative}.productSearch input{height:32px;border:1px solid #eae9e9;box-shadow:none;padding-left:30px;font-size:13px;letter-spacing:1px}.productSearch .fa{position:absolute;top:8px;left:8px;color:#b5b5b5}.AddProductTable{padding:0;margin:0}.AddProductTable tr{border-bottom:1px solid #eee}.AddProductTable td{padding-bottom:7px;padding-top:7px}.ProListDiv{padding:0;display:table}.ProListDiv .PR_Name{display:table-cell;vertical-align:middle;font-size:14px;letter-spacing:1px;line-height:16px}.ProListDiv .PrList_img{width:35px;height:35px;margin-right:8px;border:1px solid #e0e0e0}.AddProductTable .btn-default{padding:5px 8px;font-size:13px;border-radius:0;-khtml-border-radius:0;background:linear-gradient(90deg,#1e54d3,#0038ba);color:#fff;text-align:center;margin:0;line-height:1;min-width:74px;letter-spacing:1px;float:right;border:none!important}.se_cus-type .form-control{border:1px solid #eee;background-color:#fff}.ng-option,.ng-select .ng-select-container,.ng-select span{text-transform:capitalize}.ng-select .ng-clear-wrapper{display:none}.daily-operations .nav_M .nav-link.active,.daily-operations .nav_M a{padding-top:15px}.cash-report{background-color:#f8f8f8;min-height:calc(100vh - 210px)}.cash-report .header{background:linear-gradient(0deg,#f8f8f8,#f8f8f8 50%);padding:15px 20px}.cash-report .report_value{background-color:#fff;font-size:13px;position:relative;padding:10px;letter-spacing:.5px;margin-bottom:5px;margin-top:5px;box-shadow:0 2px 8px 0 rgba(79,79,79,.1);line-height:1}.cash-report .report_value span{font-family:Rationale,sans-serif;line-height:1;font-size:18px;float:right;margin-top:-2px}.totalcash span{font-size:20px!important;color:#0038ba}.add-ordr{float:left;position:static;margin-left:10px}.Product-Filter{background-color:#f3f2f2;padding:10px 15px!important;box-shadow:0 0 20px 0 rgb(0 0 0/20%);margin:15px 0!important;border-bottom:2px solid #0038ba}._cust_filter{padding-left:0!important;padding-top:0!important;float:left}._cust_filter .form-s2 .ng-select{padding:0!important;height:30px!important}._cust_filter .form-s2 .ng-select .ng-select-container{width:100%;font-size:14px;border:none;border-radius:0;min-height:30px!important;height:30px!important}.cash-report .value_input{width:85px}.addsalesman{font-size:11px;width:100%;line-height:1;margin-top:5px}.add-expense{font-size:13px;padding:2px 10px;position:absolute;right:0}.red-bg{border:1px solid #f12300}.wz-icon .fa{color:#fff}.addpr{padding:4px 8px;font-size:12px;top:11px;right:15px;cursor:pointer}.daily-operations .tab-content{padding-bottom:10px}.bottom-act-btn{text-align:right;padding-top:15px;padding-bottom:15px}.bottom-act-btn .btn{letter-spacing:1px;font-size:12px;padding:4px 12px;box-shadow:none}.execFooter{background:#f6f6f6;padding-top:10px;padding-bottom:10px;margin-top:5px}.cash-report .value_input{float:right;width:95px}.input-error{color:red;font-size:13px;float:left}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.red-bg{background:red!important;color:#fff!important}.print-icon-div,.print-icon-div a{text-align:center;padding:15px}.print-icon-div a{display:inline-block;border:1px solid #e9ecef;width:100%;text-decoration:none;color:#282828;font-size:13px}.print-icon-div a:HOVER{border:1px solid #0038ba;color:#0038ba;box-shadow:0 0 20px 0 rgba(0,0,0,.3)}.print-icon{filter:grayscale(1);width:45px;opacity:.7;display:block;margin:10px auto 15px}.print-icon-div a:HOVER .print-icon{filter:none;opacity:1}.heading3{margin:0;font-size:16px}.select-date,.select-date:focus{box-shadow:none;border:none;background-color:#f6f6f6;font-size:14px;height:30px;width:200px}.no-content{width:100%;height:65vh;display:flex}.no-content .no-content-container{margin:auto;display:table;text-align:center;color:#b7b7b7}.no-content .no-content-container img{width:70px;height:70px;margin:auto auto 10px;display:block}"],encapsulation:2}),e})();var Jt=i("XSw2"),Kt=i("qew9");function Ft(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Quantity! "),o.Ob())}function Qt(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Quantity should be greater than 0! "),o.Ob())}function $t(e,t){1&e&&(o.Pb(0,"div",107),o.vc(1," Trade Offer: "),o.Ob())}function zt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div"),o.Pb(1,"div",108),o.Pb(2,"input",109),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb(2).selectedProduct.selectedScheme=t}))("click",(function(){o.oc(e);const i=t.$implicit,r=o.Yb(2);return r.selectedProduct.pref_id&&r.selectedProduct.stockQty&&r.calculateProductDiscounts(r.selectedProduct,i)})),o.Ob(),o.Pb(3,"label",110),o.vc(4),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=t.index,r=o.Yb(2);o.yb(2),o.gc("id","byTerritory-",i,""),o.ec("ngModel",r.selectedProduct.selectedScheme)("value",e),o.yb(1),o.gc("for","byTerritory-",i,""),o.yb(1),o.wc(e.title)}}function Wt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",97),o.Pb(1,"div",8),o.Pb(2,"div",98),o.vc(3,"Add Quantity:"),o.Ob(),o.Pb(4,"div",99),o.Pb(5,"input",100,101),o.Wb("keyup",(function(){o.oc(e);const t=o.Yb();return t.setQuantity(t.selectedProduct)}))("keydown",(function(t){return o.oc(e),o.Yb().isNumber(t,"quantity")}))("ngModelChange",(function(t){return o.oc(e),o.Yb().selectedProduct.stockQty=t})),o.Ob(),o.tc(7,Ft,2,0,"span",102),o.tc(8,Qt,2,0,"span",102),o.Ob(),o.Pb(9,"div",98),o.vc(10,"Unit:"),o.Ob(),o.Pb(11,"div",99),o.vc(12),o.Ob(),o.tc(13,$t,2,0,"div",103),o.Pb(14,"div",104),o.tc(15,zt,5,5,"div",105),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.nc(6),t=o.Yb();o.yb(5),o.ec("ngModel",t.selectedProduct.stockQty)("max",999999),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&t.isAdded),o.yb(1),o.ec("ngIf",0==+t.selectedProduct.stockQty&&t.isAdded&&!(null!=e.errors&&e.errors.required)),o.yb(4),o.xc(" ",t.selectedProduct.unit_name," "),o.yb(1),o.ec("ngIf",t.selectedProduct.schemes.length),o.yb(2),o.ec("ngForOf",t.selectedProduct.schemes)}}function Zt(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",3),o.Pb(1,"h5",18),o.vc(2," Add "),o.Pb(3,"span"),o.vc(4," Cheque Information"),o.Ob(),o.Ob(),o.Pb(5,"button",111),o.Wb("click",(function(){return o.oc(e),o.Yb().paymentCancelled()})),o.Pb(6,"span",6),o.vc(7,"\xd7"),o.Ob(),o.Ob(),o.Ob()}}function Vt(e,t){1&e&&(o.Pb(0,"div",132),o.vc(1," Please select a payment method! "),o.Ob())}function Gt(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Cheque Number! "),o.Ob())}function Ut(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Payment Date! "),o.Ob())}function Ht(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Bank Name! "),o.Ob())}function jt(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Total Amount! "),o.Ob())}function Xt(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Zero value not allowed "),o.Ob())}function ei(e,t){if(1&e&&(o.Pb(0,"span",106),o.vc(1),o.Zb(2,"number"),o.Ob()),2&e){const e=o.Yb(3);o.yb(1),o.xc(" Amount should not be greater than ",o.bc(2,1,null==e.cash?null:e.cash.amount_received,"1.2-2")," ")}}function ti(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",128),o.Pb(1,"div",121),o.Pb(2,"label",122),o.vc(3,"Total Amount*"),o.Ob(),o.Pb(4,"input",133,134),o.Wb("focus",(function(t){return o.oc(e),o.Yb(2).focused(t)}))("blur",(function(t){return o.oc(e),o.Yb(2).left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).chequeAmount=t})),o.Ob(),o.Ob(),o.tc(6,jt,2,0,"span",102),o.tc(7,Xt,2,0,"span",102),o.tc(8,ei,3,4,"span",102),o.Ob()}if(2&e){const e=o.nc(5),t=o.Yb(2);o.yb(4),o.ec("max",null==t.cash?null:t.cash.amount_received)("ngModel",t.chequeAmount),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&t.isAdded),o.yb(1),o.ec("ngIf",0==+t.chequeAmount&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&t.chequeAmount>(null==t.cash?null:t.cash.amount_received)&&t.isAdded)}}function ii(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",9),o.Pb(1,"div",112),o.Pb(2,"div",113),o.Pb(3,"div",114),o.Pb(4,"div",108),o.Pb(5,"input",115),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCheque=t}))("click",(function(){o.oc(e);const t=o.Yb();return t.chequeAmount=null,t.currentFullPayment("Cheque Payment","Credit")})),o.Ob(),o.Pb(6,"label",116),o.vc(7,"Full Amount"),o.Ob(),o.Ob(),o.Ob(),o.Pb(8,"div",114),o.Pb(9,"div",108),o.Pb(10,"input",117),o.Wb("click",(function(){return o.oc(e),o.Yb().setPartial("Cheque Payment")}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCheque=t})),o.Ob(),o.Pb(11,"label",118),o.vc(12,"Partial Amount"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(13,Vt,2,0,"div",119),o.Pb(14,"div",8),o.Pb(15,"div",120),o.Pb(16,"div",121),o.Pb(17,"label",122),o.vc(18,"Cheque Number*"),o.Ob(),o.Pb(19,"input",123,124),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().chequeNumber=t})),o.Ob(),o.Ob(),o.tc(21,Gt,2,0,"span",102),o.Ob(),o.Pb(22,"div",120),o.Pb(23,"div",125),o.Pb(24,"label",122),o.vc(25,"Date*"),o.Ob(),o.Pb(26,"input",126,127),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentDate=t})),o.Ob(),o.Ob(),o.tc(28,Ut,2,0,"span",102),o.Ob(),o.Pb(29,"div",128),o.Pb(30,"div",121),o.Pb(31,"label",122),o.vc(32,"Bank Name*"),o.Ob(),o.Pb(33,"input",129,130),o.Wb("focus",(function(t){return o.oc(e),o.Yb().focused(t)}))("blur",(function(t){return o.oc(e),o.Yb().left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb().bankName=t})),o.Ob(),o.Ob(),o.tc(35,Ht,2,0,"span",102),o.Ob(),o.tc(36,ti,9,5,"div",131),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.nc(20),t=o.nc(34),i=o.Yb();o.yb(5),o.ec("ngModel",i.paymentTypeCheque),o.yb(5),o.ec("ngModel",i.paymentTypeCheque),o.yb(3),o.ec("ngIf",""===i.paymentTypeCheque&&i.isAdded),o.yb(6),o.ec("ngModel",i.chequeNumber),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&i.isAdded),o.yb(5),o.ec("ngModel",i.paymentDate),o.yb(2),o.ec("ngIf","  "===i.paymentDate&&i.isAdded),o.yb(5),o.ec("ngModel",i.bankName),o.yb(2),o.ec("ngIf",(null==t.errors?null:t.errors.required)&&i.isAdded),o.yb(1),o.ec("ngIf","full"!==i.paymentTypeCheque)}}function ri(e,t){1&e&&(o.Pb(0,"div",3),o.Pb(1,"h5",18),o.vc(2," Add "),o.Pb(3,"span"),o.vc(4,"Credit Information"),o.Ob(),o.Ob(),o.Pb(5,"button",135),o.Pb(6,"span",6),o.vc(7,"\xd7"),o.Ob(),o.Ob(),o.Ob())}function ni(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please select a payment method! "),o.Ob())}function ai(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Please add Total Amount! "),o.Ob())}function oi(e,t){1&e&&(o.Pb(0,"span",106),o.vc(1," Zero value not allowed "),o.Ob())}function si(e,t){if(1&e&&(o.Pb(0,"span",106),o.vc(1),o.Ob()),2&e){const e=o.Yb(3);o.yb(1),o.xc(" Amount should not be greater than ",null==e.cash?null:e.cash.amount_received," ")}}function di(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",120),o.Pb(1,"div",121),o.Pb(2,"label",122),o.vc(3,"Amount*"),o.Ob(),o.Pb(4,"input",142,143),o.Wb("focus",(function(t){return o.oc(e),o.Yb(2).focused(t)}))("blur",(function(t){return o.oc(e),o.Yb(2).left(t)}))("ngModelChange",(function(t){return o.oc(e),o.Yb(2).creditAmount=t})),o.Ob(),o.Ob(),o.tc(6,ai,2,0,"span",102),o.tc(7,oi,2,0,"span",102),o.tc(8,si,2,1,"span",102),o.Ob()}if(2&e){const e=o.nc(5),t=o.Yb(2);o.yb(4),o.ec("max",null==t.cash?null:t.cash.amount_received)("ngModel",t.creditAmount),o.yb(2),o.ec("ngIf",(null==e.errors?null:e.errors.required)&&t.isAdded),o.yb(1),o.ec("ngIf",0==+t.creditAmount&&t.isAdded),o.yb(1),o.ec("ngIf",!(null!=e.errors&&e.errors.required)&&+t.creditAmount>(null==t.cash?null:t.cash.amount_received)&&t.isAdded)}}function ci(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",112),o.Pb(1,"div",9),o.Pb(2,"div",113),o.Pb(3,"div",136),o.Pb(4,"div",108),o.Pb(5,"input",137),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCredit=t}))("click",(function(){o.oc(e);const t=o.Yb();return t.creditAmount=null,t.currentFullPayment("Credit","Cheque payment")})),o.Ob(),o.Pb(6,"label",138),o.vc(7,"Full Amount"),o.Ob(),o.Ob(),o.tc(8,ni,2,0,"span",102),o.Ob(),o.Pb(9,"div",136),o.Pb(10,"div",108),o.Pb(11,"input",139),o.Wb("click",(function(){return o.oc(e),o.Yb().setPartial("Credit")}))("ngModelChange",(function(t){return o.oc(e),o.Yb().paymentTypeCredit=t})),o.Ob(),o.Pb(12,"label",140),o.vc(13,"Partial Amount"),o.Ob(),o.Ob(),o.Ob(),o.tc(14,di,9,5,"div",141),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(5),o.ec("ngModel",e.paymentTypeCredit),o.yb(3),o.ec("ngIf",""===e.paymentTypeCredit&&e.isAdded),o.yb(3),o.ec("ngModel",e.paymentTypeCredit),o.yb(3),o.ec("ngIf","full"!==e.paymentTypeCredit)}}function li(e,t){1&e&&(o.Pb(0,"div",144),o.Pb(1,"h5",106),o.vc(2,' You have to choose "Partial Amount" to use both Credit and Cheque Payment! '),o.Ob(),o.Ob())}function bi(e,t){1&e&&(o.Pb(0,"div",153),o.vc(1," Scheme "),o.Ob())}function ui(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",154),o.Wb("click",(function(){o.oc(e);const t=o.Yb().$implicit;return o.Yb(2).openQuantityModal(t)})),o.vc(1," Add "),o.Ob()}}function pi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",155),o.Wb("click",(function(){o.oc(e);const t=o.Yb().$implicit;return o.Yb(2).removeProductFromOrder(t)})),o.vc(1," Remove "),o.Ob()}}function hi(e,t){if(1&e&&(o.Pb(0,"tr"),o.Pb(1,"td"),o.Pb(2,"div",146),o.tc(3,bi,2,0,"div",147),o.Kb(4,"img",148),o.Pb(5,"div",149),o.vc(6),o.Pb(7,"span",150),o.vc(8),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(9,"td"),o.tc(10,ui,2,0,"button",151),o.tc(11,pi,2,0,"button",152),o.Ob(),o.Ob()),2&e){const e=t.$implicit;o.yb(3),o.ec("ngIf",null==e.schemes?null:e.schemes.length),o.yb(1),o.fc("src",e.thumbnail,o.pc),o.yb(2),o.xc(" ",e.item_name," "),o.yb(2),o.xc(" SKU: ",e.item_sku," "),o.yb(2),o.ec("ngIf",!e.isAdded),o.yb(1),o.ec("ngIf",e.isAdded)}}function mi(e,t){if(1&e&&(o.Pb(0,"table",145),o.Pb(1,"tbody"),o.tc(2,hi,12,6,"tr",105),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.yb(2),o.ec("ngForOf",e.dispProducts)}}function gi(e,t){1&e&&(o.Pb(0,"div",156),o.Pb(1,"h2",157),o.vc(2,"Loading Products..."),o.Ob(),o.Ob())}function vi(e,t){if(1&e&&(o.Pb(0,"ng-option",158),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.employee_id),o.yb(1),o.wc(e.employee_first_name+" "+e.employee_last_name)}}function Oi(e,t){1&e&&(o.Pb(0,"ng-option",61),o.vc(1,"Select Employee First"),o.Ob())}function Pi(e,t){1&e&&(o.Pb(0,"ng-option",61),o.vc(1,"Select Route"),o.Ob())}function _i(e,t){if(1&e&&(o.Pb(0,"ng-option",158),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e.route_id),o.yb(1),o.xc("",e.name," ")}}function fi(e,t){1&e&&(o.Pb(0,"ng-option",61),o.vc(1,"Select Route First"),o.Ob())}function yi(e,t){1&e&&(o.Pb(0,"ng-option",61),o.vc(1,"Select Retailer"),o.Ob())}function xi(e,t){if(1&e&&(o.Pb(0,"ng-option",158),o.vc(1),o.Ob()),2&e){const e=t.$implicit;o.ec("value",e),o.yb(1),o.xc(" ",e.retailer_name,"")}}function Si(e,t){1&e&&(o.Pb(0,"div",73),o.vc(1," E. Disc. "),o.Ob())}function Ci(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",81),o.Pb(1,"input",167),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb().$implicit.extra_discount=t}))("keyup",(function(){o.oc(e);const t=o.Yb().$implicit;return o.Yb().calculateExtraDiscount(t)}))("keydown",(function(t){return o.oc(e),o.Yb(2).isNumber(t)})),o.Ob(),o.Ob()}if(2&e){const e=o.Yb().$implicit,t=o.Yb();o.yb(1),o.ec("readonly",t.isCreditAdded||t.isChequeAdded||+e.stockQty<1)("ngModel",e.extra_discount)}}function wi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",159),o.Kb(1,"a",160),o.Pb(2,"div",161),o.Pb(3,"div",71),o.Pb(4,"div",162),o.vc(5),o.Pb(6,"span",150),o.vc(7),o.Ob(),o.Ob(),o.Ob(),o.Pb(8,"div",72),o.Pb(9,"div",81),o.vc(10),o.Ob(),o.Ob(),o.Pb(11,"div",81),o.Pb(12,"input",163),o.Wb("keyup",(function(){o.oc(e);const i=t.$implicit;return o.Yb().setQuantity(i)}))("keydown",(function(t){return o.oc(e),o.Yb().isNumber(t,"quantity")}))("ngModelChange",(function(i){return o.oc(e),t.$implicit.stockQty=i})),o.Ob(),o.Ob(),o.Pb(13,"div",81),o.vc(14),o.Ob(),o.Pb(15,"div",81),o.vc(16),o.Zb(17,"number"),o.Ob(),o.Pb(18,"div",81),o.vc(19),o.Zb(20,"number"),o.Ob(),o.Pb(21,"div",81),o.vc(22),o.Zb(23,"number"),o.Ob(),o.tc(24,Ci,2,2,"div",164),o.Pb(25,"div",81),o.vc(26),o.Zb(27,"number"),o.Ob(),o.Pb(28,"div",83),o.vc(29),o.Zb(30,"number"),o.Ob(),o.Pb(31,"a",165),o.Wb("click",(function(){o.oc(e);const i=t.$implicit,r=t.index;return o.Yb().removeProductFromOrder(i,r)})),o.Kb(32,"i",166),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=o.Yb();o.yb(5),o.xc(" ",e.item_name," "),o.yb(2),o.xc(" SKU: ",e.item_sku," "),o.yb(3),o.xc(" ",e.unit_name," "),o.yb(2),o.ec("disabled",i.isChequeAdded||i.isCreditAdded)("ngModel",e.stockQty),o.yb(2),o.xc(" ",e.item_trade_price," "),o.yb(2),o.xc(" ",o.bc(17,14,+e.stockQty*e.scheme_discount||0,"1.2-2")," "),o.yb(3),o.yc(" ",e.trade_discount||0,"% (",o.bc(20,17,+e.stockQty*e.trade_discount_pkr,"1.2-2"),") "),o.yb(3),o.xc(" ",o.bc(23,20,+e.stockQty*e.special_discount||0,"1.2-2")," "),o.yb(2),o.ec("ngIf",i.permissions.extra_discount),o.yb(2),o.xc(" ",o.bc(27,23,e.tax_amount_pkr||0,"1.2-2")," "),o.yb(3),o.xc(" ",o.bc(30,26,e.net_amount||0,"1.2-2")," "),o.yb(2),o.ec("disabled",i.isChequeAdded||i.isCreditAdded)}}function ki(e,t){1&e&&(o.Pb(0,"div",159),o.Pb(1,"h6",168),o.vc(2,"Add products to counter sale..."),o.Ob(),o.Ob())}function Di(e,t){1&e&&(o.Pb(0,"button",169),o.Pb(1,"div",170),o.Pb(2,"span",171),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}const Ii=function(){return["/home"]};function Mi(e,t){1&e&&(o.Pb(0,"button",172),o.vc(1," Cancel "),o.Ob()),2&e&&o.ec("routerLink",o.hc(1,Ii))}function Ti(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",173),o.Wb("click",(function(){return o.oc(e),o.Yb().setOrderFields()})),o.vc(1," Save Order "),o.Ob()}}function Ai(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",174),o.Wb("click",(function(){o.oc(e);const t=o.Yb();return t.isCredit=!1,t.isFullyPaymentAdded("Cheque Payment")})),o.vc(1," Add Cheque "),o.Ob()}}function Ri(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",175),o.Wb("click",(function(){return o.oc(e),o.Yb().removeCheque()})),o.vc(1," Remove Cheque "),o.Ob()}}function Li(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",176),o.Wb("click",(function(){o.oc(e);const t=o.Yb();return t.isCredit=!0,t.isFullyPaymentAdded("Credit")})),o.vc(1," Add Credit "),o.Ob()}}function qi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",177),o.Wb("click",(function(){return o.oc(e),o.Yb().removeCredit()})),o.vc(1," Remove Credit "),o.Ob()}}function Ni(e,t){1&e&&(o.Pb(0,"button",178),o.vc(1," Show Modal "),o.Ob())}let Bi=(()=>{class e{constructor(e,t,i,r,n,a){this.router=e,this.generalDataService=t,this.storageService=i,this.ordersService=r,this.toastService=n,this.dataService=a,this.selectedProduct={},this.schemeItemIds=[],this.allProducts=[],this.dispProducts=[],this.specialDiscounts=[],this.prefrences=[],this.orderBookers=[],this.routes=[],this.retailers=[],this.selectedProducts=[],this.selectedProductsIds=[],this.schemes=[],this.subInventory=[],this.discountSlabs=[],this.permissions=this.storageService.getItem(re.a.permissions)}ngOnInit(){this.grossAmount=0,this.tradeOffer=0,this.tradeDiscount=0,this.specialDiscount=0,this.extraDiscount=0,this.tax=0,this.dueAmount=0,this.totalAmountAfterScheme=0,this.notes="",this.paymentDate=(new Date).toISOString().split("T")[0],this.paymentTypeCheque="",this.paymentTypeCredit="",this.addedPayment="",this.currentPayment="",this.getSchemesData(),this.getOrderBookers(),this.getCounterSaleData()}getOrderBookers(){this.distributorId=this.storageService.getItem("distributor").id,this.generalDataService.getOrderBookers(this.distributorId).subscribe(e=>{200===e.status?this.orderBookers=e.data:this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch order bookers. Please try again",title:"Error:"})})}getCounterSaleData(){this.loadingProducts=!0,this.ordersService.getCounterSaleData().subscribe(e=>{this.loadingProducts=!1,200===e.status?(this.allProducts=e.data.inventory.map(e=>(e.net_amount=0,e.isAdded=!1,e)),this.specialDiscounts=e.data.special_discount,this.dispProducts=JSON.parse(JSON.stringify(this.allProducts)),this.subInventory=e.data.sub_inventory):this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{this.loadingProducts=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch counter sale data. Please try again",title:"Error:"})})}resetValues(){this.selectedProducts=[],this.selectedProductsIds=[],this.grossAmount=0,this.tradeOffer=0,this.tradeDiscount=0,this.specialDiscount=0,this.extraDiscount=0,this.credit=null,this.cheque=null,this.cash=null,this.tax=0,this.dueAmount=0,this.notes="",this.paymentDate=(new Date).toISOString().split("T")[0],this.paymentTypeCheque="",this.paymentTypeCredit="",this.addedPayment="",this.allProducts=this.allProducts.map(e=>(e.isAdded=!1,e)),this.dispProducts=JSON.parse(JSON.stringify(this.allProducts))}getSchemesData(){this.ordersService.getSchemes().subscribe(e=>{200===e.status?this.schemes=e.data:this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch Trade Offers. Please try again",title:"Error:"})})}getDiscountSlabs(){this.selectedSegment=this.selectedRetailer.segment_id,this.resetValues(),this.ordersService.getDiscountSlabs().subscribe(e=>{200===e.status&&(this.discountSlabs=e.data,this.merchantDiscount=this.discountSlabs.find(e=>e.region_id===this.selectedRegion&&this.selectedSegment===e.segment_id&&e.channel_id===this.selectedRetailer.type_id))},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch Trade Discount. Please try again",title:"Error:"})})}focused(e){e.target.parentElement.classList.add("focused")}left(e){e.target.value||e.target.parentElement.classList.remove("focused")}isFullyPaymentAdded(e){"Credit"===e?this.paymentTypeCredit="":this.paymentTypeCheque="",0===this.selectedProducts.length&&0===this.dueAmount?this.toastService.showToaster({type:"error",message:"Please select products first!",title:"Payment cannot be added"}):"full"!==this.paymentTypeCheque&&"full"!==this.paymentTypeCredit||this.addedPayment===e?(document.getElementById("open-modal-payment").click(),this.focusForPaymentValues()):this.toastService.showToaster({type:"error",message:`You already selected Full payment for ${this.addedPayment} please remove it if you want to add ${this.currentPayment}!`,title:"Full Payment selected for "+this.addedPayment})}focusForPaymentValues(){this.isCredit&&this.creditAmount?document.getElementById("Amount2").parentElement.classList.add("focused"):(this.chequeAmount&&document.getElementById("Amount1").parentElement.classList.add("focused"),this.bankName&&document.getElementById("chequeBankName").parentElement.classList.add("focused"),this.chequeNumber&&document.getElementById("chequeNum").parentElement.classList.add("focused"))}currentFullPayment(e,t){"full"!==this.paymentTypeCheque&&"full"!==this.paymentTypeCredit||this.addedPayment===e?(this.addedPayment=e,this.currentPayment=t):this.toastService.showToaster({type:"error",message:`You already selected Full payment for ${this.addedPayment} please remove it if you want to add ${this.currentPayment}!`,title:"Full Payment selected for "+this.addedPayment})}setPartial(e){e===this.addedPayment&&(this.credit&&"Credit"===e&&(this.cash.amount_received=this.cash.amount_received+this.credit.amount_received,this.credit.amount_received=0),this.cheque&&"Cheque Payment"===e&&(this.cash.amount_received=this.cash.amount_received+this.cheque.amount_received,this.cheque.amount_received=0),this.addedPayment="",this.currentPayment="",this.alreadyFullPayment=!1)}checkPaymentHasValues(){return this.isCredit?"full"===this.paymentTypeCredit?this.paymentTypeCredit.length>0:this.paymentTypeCredit.length>0&&this.creditAmount&&this.creditAmount>-1&&this.creditAmount<=this.cash.amount_received:"full"===this.paymentTypeCheque?this.paymentTypeCheque.length>0&&this.bankName.length>0&&this.chequeNumber.length>0&&this.paymentDate.length>0:this.paymentTypeCheque.length>0&&this.chequeAmount&&this.chequeAmount>-1&&this.chequeAmount<=this.cash.amount_received&&this.bankName.length>0&&this.chequeNumber.length>0&&this.paymentDate.length>0}removeCheque(){this.cheque=null,this.isChequeAdded=!1,this.paymentTypeCheque="",this.calculatePayments()}removeCredit(){this.credit=null,this.isCreditAdded=!1,this.paymentTypeCredit="",this.calculatePayments()}makePayment(){this.isCredit&&(this.credit={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:"Counter",payment_mode:"Credit",payment_detail:"",dispatched_bill_amount:0,recovery:0,amount_received:"full"===this.paymentTypeCredit?JSON.parse(JSON.stringify(this.dueAmount)):JSON.parse(JSON.stringify(this.creditAmount))},this.isCreditAdded=!0),this.isCredit||(this.cheque={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:"Counter",payment_mode:"Cheque",payment_detail:{cheque_amount:"full"===this.paymentTypeCheque?JSON.parse(JSON.stringify(this.dueAmount)):JSON.parse(JSON.stringify(this.chequeAmount)),bank_name:JSON.parse(JSON.stringify(this.bankName)),cheque_number:JSON.parse(JSON.stringify(this.chequeNumber)),cheque_date:JSON.parse(JSON.stringify(this.paymentDate))},dispatched_bill_amount:0,recovery:0,amount_received:"full"===this.paymentTypeCheque?JSON.parse(JSON.stringify(this.dueAmount)):JSON.parse(JSON.stringify(this.chequeAmount))},this.isChequeAdded=!0),this.calculatePayments()}addPaymentMethod(){this.isAdded=!0,this.checkPaymentHasValues()&&(this.isAdded=!1,this.makePayment(),document.getElementById("open-modal-payment").click())}paymentCancelled(){this.isAdded=!1,this.resetPaymentValues(),this.paymentTypeCredit="",this.paymentTypeCheque=""}resetPaymentValues(){this.chequeAmount=null,this.paymentDate=(new Date).toISOString().split("T")[0],this.bankName="",this.chequeNumber=null,this.creditAmount=null}getRoutes(){const e=this.orderBookers.find(e=>e.employee_id===this.selectedEmployee);this.selectedRegion=e.region_id,this.selectedRoute=null,this.selectedRetailer=null,this.resetValues(),this.generalDataService.getOrderBookerRoutes(this.selectedEmployee).subscribe(e=>{200===e.status?this.routes=e.data:this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch order booker routes. Please try again",title:"Error:"})})}getRetailerByRoute(){this.selectedRetailer=null,this.resetValues(),this.generalDataService.getRetailersByRoute(this.selectedRoute).subscribe(e=>{200===e.status?this.retailers=e.data:this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch retailers. Please try again",title:"Error:"})})}openQuantityModal(e){var t;this.showQuantityModal=!0,(null===(t=e.schemes)||void 0===t?void 0:t.length)&&(e.schemes=e.schemes.map(e=>{switch(e.scheme_type){case"free_product":e.name=Jt.d.free_products,e.rule_name=Jt.c[e.scheme_rule];break;case"dotp":e.name=Jt.d.dotp;break;default:e.name=Jt.d.gift}return e})),this.selectedProduct=JSON.parse(JSON.stringify(e)),this.selectedProduct.selectedScheme=null}showProductsList(e){e.stopPropagation(),this.selectedRetailer?(this.allProducts=this.allProducts.map(e=>(e.schemes=this.dataService.getSchemes(e.item_id,e.unit_id,e.pref_id,this.schemes,this.selectedRetailer.type_id,this.selectedRetailer.id),e)),this.dispProducts=JSON.parse(JSON.stringify(this.allProducts)),this.showProducts=!0,document.body.classList.add("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.add("d-block"),document.getElementById("counter-sale").classList.add("blur-div")):this.toastService.showToaster({type:"error",message:"Please select Retailer first!",title:"Fill required fields:"})}isNumber(e,t="charges"){return this.dataService.isNumber(e,t)}setQuantity(e){+e.stockQty>1e3&&(e.stockQty=0),e.item_trade_price&&(this.selectedProducts.find(t=>t.item_id===e.item_id)&&(this.grossAmount=this.grossAmount-e.original_amount||0),e.parent_qty_sold=this.dataService.getParentQty(+e.stockQty,e.quantity),this.calculateProductPrice(e),this.calculateProductDiscounts(e),this.calculateTotalBill(),this.applySlabOnAllProducts())}calculateProductPrice(e){e.original_amount=this.dataService.calculateUnitPrice(+e.stockQty,e.item_trade_price),e.gross_amount=e.unit_price_after_scheme_discount||e.item_trade_price*+e.stockQty}applySlabOnAllProducts(){this.merchantDiscount&&"slab"===this.merchantDiscount.discount_filter&&this.grossAmount&&(this.selectedProducts=this.selectedProducts.map(e=>(e=this.dataService.applySlabForTotal(e,this.merchantDiscount,this.grossAmount),(e=this.calculateProductSpecialDiscount(e)).extra_discount&&(e.price=e.unit_price_after_special_discount-+e.extra_discount),this.calculateNetAmountOfProduct(e),e)),this.calculateTotalBill())}addProductToOrder(){!this.selectedProduct.selectedScheme||this.selectedProduct.selectedScheme.applied?(this.isAdded=!0,+this.selectedProduct.stockQty>0&&this.selectedProduct.pref_id&&(this.selectedProducts.find(e=>e.item_id===this.selectedProduct.item_id&&e.pref_id===this.selectedProduct.pref_id)?this.alreadyAdded=!0:(this.alreadyAdded=!1,this.showQuantityModal=!1,this.allProducts=this.allProducts.map(e=>(e.item_id===this.selectedProduct.item_id&&(e.isAdded=!0),e)),this.dispProducts=this.dispProducts.map(e=>(e.item_id===this.selectedProduct.item_id&&(e.isAdded=!0),e)),this.selectedProduct.isAdded=!0,this.selectedProducts.push(this.selectedProduct),this.selectedProductsIds.includes(this.selectedProduct.item_id)||this.selectedProductsIds.push(this.selectedProduct.item_id),this.calculateTotalBill(),this.applySlabOnAllProducts(),document.getElementById("pl-qty-close").click(),this.isAdded=!1))):this.dataService.schemeCannotApplied()}removeProductFromOrder(e){this.isCreditAdded||this.isChequeAdded?this.toastService.showToaster({title:"Payment Error:",message:"Cannot edit or remove current products if payment method added!",type:"error"}):(this.selectedProducts=this.selectedProducts.filter(t=>t.item_id===e.item_id&&t.unit_name!==e.unit_name||t.item_id!==e.item_id?t:void 0),this.allProducts=this.allProducts.map(t=>(t.item_id===e.item_id&&(t.isAdded=!1),t)),this.dispProducts=this.dispProducts.map(t=>(t.item_id===e.item_id&&(t.isAdded=!1),t)),this.selectedProductsIds=this.selectedProductsIds.filter(t=>t!==e.item_id),this.calculateTotalBill(),this.applySlabOnAllProducts())}calculateProductDiscounts(e,t){t&&(e.selectedScheme=t),e.selectedScheme?e=this.applyScheme(e):(e.scheme_discount=0,e.price=JSON.parse(JSON.stringify(e.item_trade_price)),e.unit_price_after_scheme_discount=JSON.parse(JSON.stringify(e.item_trade_price))),this.merchantDiscount?e=this.dataService.applyMerchantDiscountForSingleProduct(this.merchantDiscount,e,this.grossAmount):(e.trade_discount=0,e.trade_discount_pkr=0,e.unit_price_after_merchant_discount=JSON.parse(JSON.stringify(e.price))),(e=this.calculateProductSpecialDiscount(e)).extra_discount=0,e.extra_discount_pkr=0,this.calculateNetAmountOfProduct(e)}calculateProductSpecialDiscount(e){return this.dataService.getSpecialDiscounts(this.selectedSegment,this.selectedRegion,e,this.specialDiscounts)}calculateExtraDiscount(e){+e.extra_discount<e.unit_price_after_special_discount?(e.price=e.unit_price_after_special_discount-+e.extra_discount,e.extra_discount_pkr=+e.stockQty*+e.extra_discount):(e.extra_discount=0,e.extra_discount_pkr=0,e.price=e.unit_price_after_special_discount,this.toastService.showToaster({type:"error",message:"Discount should not be greater than item price!",title:"Error:"})),this.calculateNetAmountOfProduct(e),this.calculateTotalBill()}calculateProductTax(e){e.tax_class_amount?(e.tax_amount_value=e.tax_class_amount/100*e.item_retail_price,e.tax_amount_pkr=e.tax_amount_value*e.stockQty,e.net_amount=e.net_amount+e.tax_amount_pkr):(e.tax_amount_value=0,e.tax_amount_pkr=0)}calculateNetAmountOfProduct(e){e.net_amount=this.dataService.calculateUnitPrice(e.price,+e.stockQty),this.calculateProductTax(e)}calculateTotalBill(){this.selectedProducts.length&&(this.selectedProductQuantities=this.selectedProducts.map(e=>+e.parent_qty_sold).reduce((e,t)=>e+t));let e=this.selectedProducts.map(e=>e.original_amount);this.grossAmount=this.dataService.calculateItemsBill(e),e=this.selectedProducts.map(e=>e.stockQty*e.item_retail_price),this.totalRetailPrice=this.dataService.calculateItemsBill(e),e=this.selectedProducts.map(e=>e.gross_amount),this.totalAmountAfterScheme=this.dataService.calculateItemsBill(e),e=this.selectedProducts.map(e=>e.net_amount),this.dueAmount=this.dataService.calculateItemsBill(e),e=this.selectedProducts.map(e=>e.original_amount),this.orderTotal=JSON.parse(JSON.stringify(this.dueAmount));let t=this.selectedProducts.map(e=>+e.stockQty*e.scheme_discount);this.tradeOffer=this.dataService.calculateItemsBill(t),t=this.selectedProducts.map(e=>+e.stockQty*e.trade_discount_pkr),this.tradeDiscount=this.dataService.calculateItemsBill(t),t=this.selectedProducts.map(e=>+e.stockQty*e.special_discount_pkr),this.specialDiscount=this.dataService.calculateItemsBill(t),t=this.selectedProducts.map(e=>+e.extra_discount_pkr),this.extraDiscount=this.dataService.calculateItemsBill(t);const i=this.selectedProducts.map(e=>e.tax_amount_pkr);this.tax=this.dataService.calculateItemsBill(i),this.calculatePayments()}calculatePayments(){this.cash={retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,type:"Counter",payment_mode:"Cash",payment_detail:"",dispatched_bill_amount:0,recovery:0,amount_received:this.dueAmount},this.cheque&&(this.cash.amount_received=this.cash.amount_received-this.cheque.amount_received),this.credit&&(this.cash.amount_received=this.cash.amount_received-this.credit.amount_received),this.cash.amount_received=+this.cash.amount_received.toFixed(2)}applyScheme(e){switch(e.selectedScheme.scheme_type){case"free_product":e=this.applyFreeProductScheme(e);break;case"dotp":e=this.applyDOTPScheme(e);break;default:e=this.applyGiftScheme(e)}return e}applyFreeProductScheme(e){return this.dataService.applyFreeProductScheme(e)}applyDOTPScheme(e){return this.dataService.getSDForDOTP(e)}applyGiftScheme(e){return this.dataService.getSDForGift(e)}closeQuantityModal(e){this.showQuantityModal&&!e.target.classList.contains("dont-close-quantity")&&(this.showQuantityModal=!1,this.selectedProduct=JSON.parse(JSON.stringify({})))}searchProduct(){this.dispProducts=this.productSearchText?this.allProducts.filter(e=>e.item_name.toLowerCase().includes(this.productSearchText.toLowerCase())||e.item_sku.toLowerCase().includes(this.productSearchText.toLowerCase())):this.allProducts}isAlreadyAdded(e){return this.selectedProductsIds.includes(e)}clickedOutSide(e){!this.showProducts||this.showQuantityModal||e.target.classList.contains("dont-close-products")||this.closeProductsList()}closeProductsList(){this.showProducts=!1,document.body.classList.remove("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.remove("d-block"),document.getElementById("counter-sale").classList.remove("blur-div")}isDataValid(){return!(!this.selectedProductsIds.length||!this.selectedEmployee&&!this.selectedRoute||!this.selectedRetailer)}setOrderFields(){const e=this.selectedProducts.map(e=>+e.stockQty>0);if(0===e.length||e.includes(!0))this.toastService.showToaster({type:"error",message:"Product Quantity cannot be zero",title:"Error:"});else if(this.isDataValid()){const e=this.orderBookers.find(e=>e.employee_id===this.selectedEmployee),t={area_id:e.area_id,assigned_route_id:this.selectedRoute,booking_territory:e.territory_id,order_type:"counter",counter_sale:1,spot_sale:0,sales_man_id:0,within_radius:0,booking_region:this.selectedRegion,invoice_number:"",invoice_date:(new Date).toISOString(),remarks:this.notes,retailer_id:this.selectedRetailer.retailer_id,distributor_id:this.distributorId,gross_sale_amount:this.grossAmount,total_amount_after_tax:this.dueAmount,total_discount:this.specialDiscount+this.tradeDiscount+this.tradeOffer+this.extraDiscount,total_tax_amount:this.tax,booked_order_value:0,booked_total_qty:0,booked_total_skus:0,booking_area:e.area_id,booking_locality_id:this.selectedRetailer.locality_id,booking_neighbourhood_id:this.selectedRetailer.neighbourhood_id,booking_zone:e.area_id,employee_id:e.employee_id,freight_charges:0,order_total:this.orderTotal,region_id:this.selectedRegion,status:"Completed",status_code:0,territory_id:e.territory_id,total_retail_price:this.totalRetailPrice,ttl_products_sold:this.selectedProductsIds.length,ttl_qty_sold:this.selectedProductQuantities,payment:{total_payment:this.dueAmount,detail:[]},items:[]};this.order=t,this.cheque&&this.order.payment.detail.push(this.cheque),this.credit&&this.order.payment.detail.push(this.credit),this.order.payment.detail.push(this.cash),this.setOrderItems(e)}else this.toastService.showToaster({type:"error",message:"Please select Employee, Route, Retailer and Products to place the order!",title:"Error:"})}setOrderItems(e){this.selectedProducts.forEach((t,i)=>{var r,n,a,o,s;const d={item_id:t.item_id,pref_id:t.pref_id,unit_id:t.unit_id,item_name:t.item_name,unit_name:t.unit_name,item_quantity_booker:0,quantity_returned:0,area_id:e.area_id,division_id:e.division_id,assigned_route_id:this.selectedRoute,booked_total_qty:0,quantity:+t.stockQty,gross_sale_amount:t.original_amount,booked_order_value:0,brand_id:t.brand_id,campaign_id:(null===(r=t.selectedScheme)||void 0===r?void 0:r.id)||0,dispatch_status:0,distributor_id:this.distributorId,final_price:t.net_amount,gift_value:t.gift_value||0,item_quantity_updated:0,item_status:t.is_active,order_id:0,original_price:t.item_trade_price,scheme_id:(null===(n=t.selectedScheme)||void 0===n?void 0:n.id)||0,scheme_discount:t.scheme_discount,unit_price_after_scheme_discount:t.unit_price_after_scheme_discount,merchant_discount_pkr:t.trade_discount_pkr,merchant_discount:t.trade_discount,unit_price_after_merchant_discount:t.unit_price_after_merchant_discount,special_discount:t.special_discount,unit_price_after_special_discount:t.unit_price_after_special_discount,booker_discount:t.extra_discount,unit_price_after_individual_discount:t.unit_price_after_individual_discount||t.price,scheme_min_quantity:(null===(a=t.selectedScheme)||void 0===a?void 0:a.min_qty)||0,scheme_quantity_free:(null===(o=t.selectedScheme)||void 0===o?void 0:o.quantity_free)||0,scheme_rule:(null===(s=t.selectedScheme)||void 0===s?void 0:s.rule_name)||"",parent_pref_id:t.child,parent_unit_id:t.parent_unit_id,parent_brand_id:t.brand_id,parent_tp:t.parent_trade_price,reasoning:"",region_id:this.selectedRegion,territory_id:e.territory_id,parent_qty_sold:t.parent_qty_sold,parent_value_sold:t.net_amount,tax_class_id:t.tax_class_id,tax_in_percentage:t.tax_class_amount,tax_in_value:t.tax_amount_value,total_amount_after_tax:t.net_amount,total_discount:+t.stockQty*t.scheme_discount+ +t.stockQty*t.trade_discount_pkr+ +t.stockQty*t.special_discount+t.extra_discount_pkr,total_retail_price:t.stockQty*t.item_retail_price,total_tax_amount:t.tax_amount_pkr||0};this.order.items.push(d),i===this.selectedProducts.length-1&&this.placeOrder()})}openBillsModal(){document.getElementById("billsPrintPaperModalTrigger").click()}getBills(e="A4"){document.getElementById("close-bills").click();const t=`${L.a.apiDomain}${R.a.BILLS}?type=bill&order_booker=${this.order.employee_id}&date=${this.order.invoice_date.substring(0,10)}&size=${e}&orderID=${this.order.id}`;window.open(t,"_blank")}placeOrder(){this.isOrdering=!0,this.ordersService.counterSaleOrder(this.order).subscribe(e=>{this.isOrdering=!1,200===e.status&&(this.order.id=e.data.id,this.openBillsModal(),this.toastService.showToaster({type:"success",message:"Order Placed successfully!",title:"Order Placed:"}),this.selectedEmployee=null,this.selectedRoute=null,this.selectedRetailer=null,this.credit=null,this.cheque=null,this.cash=null,this.retailers=[],this.routes=[],this.isChequeAdded=!1,this.isCreditAdded=!1,this.resetValues(),this.paymentCancelled())},e=>{this.isOrdering=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Order cannot be placed at the moment! Please try again",title:"Error:"})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(a.f),o.Jb(d.b),o.Jb(J.a),o.Jb(c.a),o.Jb(l.a),o.Jb(ne.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-counter-sale"]],decls:304,vars:81,consts:[["id","billsModalCounterSale","tabindex","-1","role","dialog","aria-labelledby","billsModalCounterSaleLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","top_border"],[1,"modal-header"],["id","billsModalCounterSaleLabel",1,"modal-title"],["type","button","id","close-bills","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-12"],[1,"heading3"],[1,"row","print-icon-div","pb-0"],[1,"col-6","pl-0"],[3,"click"],["src","assets/images/a4.svg","alt","",1,"print-icon"],[1,"col-6","pr-0"],["src","assets/images/a5.svg","alt","",1,"print-icon"],["id","exampleModal","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close","dont-close-products",3,"click"],["aria-hidden","true",1,"dont-close-products"],["class","modal-body AddDetailPR",4,"ngIf"],[1,"modal-footer","border-0",2,"background-color","#f6f6f6"],["type","submit",1,"btn","btn-primary","dont-close-products",3,"click"],["type","button","id","pl-qty-close","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel","dont-close-products",3,"click"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["class","modal-header",4,"ngIf"],["class","col-12",4,"ngIf"],["id","floating-label","class","form-wrap p-0",4,"ngIf"],["class","form-wrap p-10",4,"ngIf"],[1,"modal-footer","border-0"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button","id","close-payment-modal","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel",3,"click"],["id","product-cl-sec",3,"ngClass","clickOutside"],["id","pl-close",1,"close-btn-pl",3,"click"],[1,"pro-header-text"],[1,"se_cus-type","form-wrap","p-15"],[1,"productSearch"],[1,"fa","fa-search"],["type","text","id","","placeholder","Search",1,"form-control",3,"ngModel","ngModelChange","keyup"],[1,"pc-cartlist"],[1,"overflow-plist"],[1,"plist-content"],[1,"_left-filter","pt-0"],[1,"container"],[1,"card","top_border","p-15"],["class","AddProductTable","width","100%",4,"ngIf"],["class","col-md-12 loader",4,"ngIf"],[1,"_cl-bottom"],["id","pl-prod-close","type","butotn",1,"btn","btn-cancel","mr-2",3,"click"],["id","counter-sale",1,"container","_order-container"],["data-toggle","modal","data-target","#billsModalCounterSale","id","billsPrintPaperModalTrigger","hidden","",1,"btn","btn-default","mb-0"],[1,"row","mt-2","mb-2"],[1,"col-md-12"],[1,"_head01","float-left"],[1,"row","mt-2"],[1,"card","p-20","top_border","mb-3","_INV-h"],[1,"row","_add-customer"],[1,"_sa-customer"],[1,"form-s2"],["placeholder","Select Employee",1,"formselect",3,"multiple","ngModel","ngModelChange","change"],["disabled",""],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Route",1,"formselect",3,"multiple","ngModel","ngModelChange","change"],["disabled","",4,"ngIf"],["placeholder","Select Retailer",1,"formselect",3,"multiple","ngModel","ngModelChange","change"],["id","productlist01",1,"btn","btn-primary","ml-15",3,"click"],[1,"_cut-detail"],[1,"col-md-6"],[1,"_add-product"],[1,"row","AP_heading"],[1,"addItemCell","PL-5"],[1,"addItemCell","unit-w"],[1,"addItemCell2"],["class","addItemCell2",4,"ngIf"],[1,"addItemCell3"],["class","row _row-product",4,"ngFor","ngForOf"],["class","row _row-product",4,"ngIf"],[1,"row","_totalBar","_totalBar2"],[1,"addItemCell","_h25","PL-5"],[1,"addItemCell","_h25","unit-w"],[1,"addItemCell2","_h25"],[1,"addItemCell2","_h25","width-t"],[1,"addItemCell3","_h25"],[1,"row","_totalBar2"],[1,"addItemCell3","_h25",2,"font-size","18px","color","#0038ba"],[1,"Action_bottom"],[1,"container-fluid","p-0"],[1,"align-right"],["type","submit","class","btn btn-primary mr-2","disabled","",4,"ngIf"],["type","submit","class","btn btn-primary btn-cancel mr-2",3,"routerLink",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-primary float-left mr-2",3,"click",4,"ngIf"],["class","btn btn-primary float-left mr-2 red-bg",3,"click",4,"ngIf"],["class","btn btn-primary float-left",3,"click",4,"ngIf"],["class","btn btn-primary float-left red-bg",3,"click",4,"ngIf"],["id","open-modal-payment","style","display: none","data-toggle","modal","data-target","#exampleModal2",4,"ngIf"],[1,"modal-body","AddDetailPR"],[1,"col-md-4","pt-7","mb-15"],[1,"col-md-8","mb-15"],["type","text","placeholder","","required","",1,"form-control",2,"font-size","13px",3,"ngModel","max","keyup","keydown","ngModelChange"],["selectedQty","ngModel"],["class","input-error",4,"ngIf"],["class","col-md-4","style","padding-top: 2px",4,"ngIf"],[1,"col-md-8"],[4,"ngFor","ngForOf"],[1,"input-error"],[1,"col-md-4",2,"padding-top","2px"],[1,"custom-control","custom-radio"],["type","radio","name","AssignCatalogue",1,"custom-control-input",3,"ngModel","id","value","ngModelChange","click"],[1,"custom-control-label","font13",2,"line-height","25px",3,"for"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["id","floating-label",1,"form-wrap","p-0"],[1,"row","pt-10"],[1,"col-4"],["type","radio","name","payment","id","payment1","value","full",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","payment1",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["type","radio","name","payment","id","payment2","value","partial",1,"custom-control-input",3,"ngModel","click","ngModelChange"],["for","payment2",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["class","col-12 input-error",4,"ngIf"],[1,"col-md-6","PT-10"],[1,"form-group"],[1,"control-label","mb-10"],["type","text","id","chequeNum","name","cheque_num","required","","autocomplete","off",1,"form-control","cheque_num",3,"ngModel","focus","blur","ngModelChange"],["chequNo","ngModel"],[1,"form-group","focused"],["type","date","id","datepicker","required","","placeholder","","autocomplete","off","name","payment_date",1,"form-control","cheque_date",3,"ngModel","focus","blur","ngModelChange"],["payDate","ngModel"],[1,"col-md-6","PT-5"],["type","text","name","cheque_bank_name","id","chequeBankName","required","","autocomplete","off",1,"form-control","cheque_bank_name",3,"ngModel","focus","blur","ngModelChange"],["bank_Name","ngModel"],["class","col-md-6 PT-5",4,"ngIf"],[1,"col-12","input-error"],["type","number","min","0","name","cheque_amount","required","","id","Amount1","autocomplete","off",1,"form-control","cheque_amount",3,"max","ngModel","focus","blur","ngModelChange"],["cheqAmount","ngModel"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],[1,"col-6"],["type","radio","name","payment","id","Amount1","value","full",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","Amount1",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["type","radio","name","payment","id","Amount2","value","partial",1,"custom-control-input",3,"ngModel","click","ngModelChange"],["for","Amount2",1,"custom-control-label",2,"font-size","13px","line-height","25px"],["class","col-md-6 PT-10",4,"ngIf"],["type","number","min","0","name","cheque_amount","required","","autocomplete","off",1,"form-control","cheque_amount",3,"max","ngModel","focus","blur","ngModelChange"],["credAmount","ngModel"],[1,"form-wrap","p-10"],["width","100%",1,"AddProductTable"],[1,"ProListDiv"],["class","lab-promotion",4,"ngIf"],["alt","",1,"PrList_img",3,"src"],[1,"PR_Name"],[2,"display","block","opacity","0.6","padding-top","5px"],["data-toggle","modal","data-target","#exampleModal","class","btn btn-default mb-0 dont-close-quantity",3,"click",4,"ngIf"],["class","btn btn-default mb-0 red-bg dont-close-product",3,"click",4,"ngIf"],[1,"lab-promotion"],["data-toggle","modal","data-target","#exampleModal",1,"btn","btn-default","mb-0","dont-close-quantity",3,"click"],[1,"btn","btn-default","mb-0","red-bg","dont-close-product",3,"click"],[1,"col-md-12","loader"],[1,"loading"],[3,"value"],[1,"row","_row-product"],[1,"dd-handle","dd3-handle","swap-div"],[1,"col-12","p-0"],[1,"_emp-sele","_product-name"],["type","text","placeholder","0",1,"addItemCell2_input",2,"font-size","13px",3,"disabled","ngModel","keyup","keydown","ngModelChange"],["class","addItemCell2 _h25",4,"ngIf"],["title","Delete",1,"btn","_order-del",3,"disabled","click"],[1,"fa","fa-trash-alt"],["type","text","placeholder","0",1,"addItemCell2_input",2,"font-size","13px",3,"readonly","ngModel","ngModelChange","keyup","keydown"],[1,"no-data"],["type","submit","disabled","",1,"btn","btn-primary","mr-2"],["role","status",1,"spinner-border","text-light"],[1,"sr-only"],["type","submit",1,"btn","btn-primary","btn-cancel","mr-2",3,"routerLink"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","float-left","mr-2",3,"click"],[1,"btn","btn-primary","float-left","mr-2","red-bg",3,"click"],[1,"btn","btn-primary","float-left",3,"click"],[1,"btn","btn-primary","float-left","red-bg",3,"click"],["id","open-modal-payment","data-toggle","modal","data-target","#exampleModal2",2,"display","none"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"h5",4),o.vc(5," Print bill for this order"),o.Kb(6,"span"),o.Ob(),o.Pb(7,"button",5),o.Pb(8,"span",6),o.vc(9,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(10,"div",7),o.Pb(11,"div",8),o.Pb(12,"div",9),o.Pb(13,"h3",10),o.vc(14,"Select paper size for print"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",11),o.Pb(16,"div",12),o.Pb(17,"a",13),o.Wb("click",(function(){return t.getBills("A4")})),o.Kb(18,"img",14),o.Pb(19,"strong"),o.vc(20,"A4 Portrait Paper"),o.Ob(),o.Ob(),o.Ob(),o.Pb(21,"div",15),o.Pb(22,"a",13),o.Wb("click",(function(){return t.getBills("A5")})),o.Kb(23,"img",16),o.Pb(24,"strong"),o.vc(25,"A5 Landscape Paper"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(26,"div",17),o.Pb(27,"div",1),o.Pb(28,"div",2),o.Pb(29,"div",3),o.Pb(30,"h5",18),o.vc(31," Product "),o.Pb(32,"span"),o.vc(33," Detail"),o.Ob(),o.Ob(),o.Pb(34,"button",19),o.Wb("click",(function(e){return t.closeQuantityModal(e)})),o.Pb(35,"span",20),o.vc(36,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.tc(37,Wt,16,7,"div",21),o.Pb(38,"div",22),o.Pb(39,"button",23),o.Wb("click",(function(){return t.addProductToOrder()})),o.vc(40," Confirm "),o.Ob(),o.Pb(41,"button",24),o.Wb("click",(function(e){return t.closeQuantityModal(e)})),o.vc(42," Cancel "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(43,"div",25),o.Pb(44,"div",1),o.Pb(45,"div",2),o.tc(46,Zt,8,0,"div",26),o.tc(47,ii,37,10,"div",27),o.tc(48,ri,8,0,"div",26),o.tc(49,ci,15,4,"div",28),o.tc(50,li,3,0,"div",29),o.Pb(51,"div",30),o.Pb(52,"button",31),o.Wb("click",(function(){return t.addPaymentMethod()})),o.vc(53," Add "),o.Ob(),o.Pb(54,"button",32),o.Wb("click",(function(){return t.paymentCancelled()})),o.vc(55," Cancel "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(56,"div",33),o.Wb("clickOutside",(function(e){return t.clickedOutSide(e)})),o.Pb(57,"a",34),o.Wb("click",(function(){return t.closeProductsList()})),o.Ob(),o.Pb(58,"div",35),o.vc(59,"Add "),o.Pb(60,"span"),o.vc(61,"Product"),o.Ob(),o.Ob(),o.Pb(62,"div",36),o.Pb(63,"div",8),o.Pb(64,"div",9),o.Pb(65,"div",37),o.Kb(66,"i",38),o.Pb(67,"input",39),o.Wb("ngModelChange",(function(e){return t.productSearchText=e}))("keyup",(function(){return t.searchProduct()})),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(68,"div",40),o.Pb(69,"div",41),o.Pb(70,"div",42),o.Pb(71,"div",43),o.Pb(72,"div",44),o.Pb(73,"div",8),o.Pb(74,"div",9),o.Pb(75,"div",45),o.tc(76,mi,3,1,"table",46),o.tc(77,gi,3,0,"div",47),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(78,"div",48),o.Pb(79,"button",49),o.Wb("click",(function(){return t.closeProductsList()})),o.vc(80," Cancel "),o.Ob(),o.Ob(),o.Ob(),o.Pb(81,"div",50),o.Pb(82,"button",51),o.vc(83," Bill "),o.Ob(),o.Pb(84,"div",52),o.Pb(85,"div",53),o.Pb(86,"h2",54),o.vc(87,"New "),o.Pb(88,"span"),o.vc(89,"Order"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(90,"div",55),o.Pb(91,"div",53),o.Pb(92,"div",56),o.Pb(93,"div",57),o.Pb(94,"div",9),o.Pb(95,"div",8),o.Pb(96,"div",58),o.Pb(97,"div",59),o.Pb(98,"ng-select",60),o.Wb("ngModelChange",(function(e){return t.selectedEmployee=e}))("change",(function(){return t.getRoutes()})),o.Pb(99,"ng-option",61),o.vc(100,"Select Employee"),o.Ob(),o.tc(101,vi,2,2,"ng-option",62),o.Ob(),o.Ob(),o.Ob(),o.Pb(102,"div",58),o.Pb(103,"div",59),o.Pb(104,"ng-select",63),o.Wb("ngModelChange",(function(e){return t.selectedRoute=e}))("change",(function(){return t.getRetailerByRoute()})),o.tc(105,Oi,2,0,"ng-option",64),o.tc(106,Pi,2,0,"ng-option",64),o.tc(107,_i,2,2,"ng-option",62),o.Ob(),o.Ob(),o.Ob(),o.Pb(108,"div",58),o.Pb(109,"div",59),o.Pb(110,"ng-select",65),o.Wb("ngModelChange",(function(e){return t.selectedRetailer=e}))("change",(function(){return t.getDiscountSlabs()})),o.tc(111,fi,2,0,"ng-option",64),o.tc(112,yi,2,0,"ng-option",64),o.tc(113,xi,2,2,"ng-option",62),o.Ob(),o.Ob(),o.Ob(),o.Pb(114,"button",66),o.Wb("click",(function(e){return t.showProductsList(e)})),o.vc(115," Add Product "),o.Ob(),o.Ob(),o.Pb(116,"div",67),o.Pb(117,"div",8),o.Pb(118,"div",68),o.Pb(119,"strong"),o.vc(120,"Retailer Name: \xa0 "),o.Ob(),o.vc(121),o.Ob(),o.Pb(122,"div",68),o.Pb(123,"strong"),o.vc(124,"Channel Type: \xa0 "),o.Ob(),o.vc(125),o.Ob(),o.Pb(126,"div",68),o.Pb(127,"strong"),o.vc(128,"Location: \xa0 "),o.Ob(),o.vc(129),o.Ob(),o.Pb(130,"div",68),o.Pb(131,"strong"),o.vc(132,"Territory: \xa0 "),o.Ob(),o.vc(133),o.Ob(),o.Ob(),o.Ob(),o.Pb(134,"div",69),o.Pb(135,"div",70),o.Pb(136,"div",71),o.vc(137,"Product Name"),o.Ob(),o.Pb(138,"div",72),o.vc(139,"Unit"),o.Ob(),o.Pb(140,"div",73),o.vc(141,"QTY."),o.Ob(),o.Pb(142,"div",73),o.vc(143,"T.P"),o.Ob(),o.Pb(144,"div",73),o.vc(145,"T.O"),o.Ob(),o.Pb(146,"div",73),o.vc(147,"T. Dis. (%)"),o.Ob(),o.Pb(148,"div",73),o.vc(149,"S. Disc."),o.Ob(),o.tc(150,Si,2,0,"div",74),o.Pb(151,"div",73),o.vc(152,"Tax"),o.Ob(),o.Pb(153,"div",75),o.vc(154,"Net Amount"),o.Ob(),o.Ob(),o.tc(155,wi,33,29,"div",76),o.tc(156,ki,3,0,"div",77),o.Pb(157,"div",78),o.Pb(158,"div",79),o.vc(159,"Total Items"),o.Ob(),o.Pb(160,"div",80),o.vc(161),o.Ob(),o.Kb(162,"div",81),o.Kb(163,"div",81),o.Kb(164,"div",81),o.Kb(165,"div",81),o.Kb(166,"div",81),o.Pb(167,"div",82),o.vc(168,"Gross Amount:"),o.Ob(),o.Pb(169,"div",83),o.vc(170),o.Zb(171,"number"),o.Ob(),o.Ob(),o.Pb(172,"div",84),o.Kb(173,"div",79),o.Kb(174,"div",80),o.Kb(175,"div",81),o.Kb(176,"div",81),o.Kb(177,"div",81),o.Kb(178,"div",81),o.Kb(179,"div",81),o.Pb(180,"div",82),o.vc(181,"Trade Offer:"),o.Ob(),o.Pb(182,"div",83),o.vc(183),o.Zb(184,"number"),o.Ob(),o.Ob(),o.Pb(185,"div",84),o.Kb(186,"div",79),o.Kb(187,"div",80),o.Kb(188,"div",81),o.Kb(189,"div",81),o.Kb(190,"div",81),o.Kb(191,"div",81),o.Kb(192,"div",81),o.Pb(193,"div",82),o.vc(194,"Trade Discount:"),o.Ob(),o.Pb(195,"div",83),o.vc(196),o.Zb(197,"number"),o.Ob(),o.Ob(),o.Pb(198,"div",84),o.Kb(199,"div",79),o.Kb(200,"div",80),o.Kb(201,"div",81),o.Kb(202,"div",81),o.Kb(203,"div",81),o.Kb(204,"div",81),o.Kb(205,"div",81),o.Pb(206,"div",82),o.vc(207,"Special Discount:"),o.Ob(),o.Pb(208,"div",83),o.vc(209),o.Zb(210,"number"),o.Ob(),o.Ob(),o.Pb(211,"div",84),o.Kb(212,"div",79),o.Kb(213,"div",80),o.Kb(214,"div",81),o.Kb(215,"div",81),o.Kb(216,"div",81),o.Kb(217,"div",81),o.Kb(218,"div",81),o.Pb(219,"div",82),o.vc(220,"Extra Discount:"),o.Ob(),o.Pb(221,"div",83),o.vc(222),o.Zb(223,"number"),o.Ob(),o.Ob(),o.Pb(224,"div",84),o.Kb(225,"div",79),o.Kb(226,"div",80),o.Kb(227,"div",81),o.Kb(228,"div",81),o.Kb(229,"div",81),o.Kb(230,"div",81),o.Kb(231,"div",81),o.Pb(232,"div",82),o.vc(233,"Tax:"),o.Ob(),o.Pb(234,"div",83),o.vc(235),o.Zb(236,"number"),o.Ob(),o.Ob(),o.Pb(237,"div",84),o.Kb(238,"div",79),o.Kb(239,"div",80),o.Kb(240,"div",81),o.Kb(241,"div",81),o.Kb(242,"div",81),o.Kb(243,"div",81),o.Kb(244,"div",81),o.Pb(245,"div",82),o.Pb(246,"strong"),o.vc(247,"Total Amount Due:"),o.Ob(),o.Ob(),o.Pb(248,"div",85),o.vc(249),o.Zb(250,"number"),o.Ob(),o.Ob(),o.Pb(251,"div",84),o.Kb(252,"div",79),o.Kb(253,"div",80),o.Kb(254,"div",81),o.Kb(255,"div",81),o.Kb(256,"div",81),o.Kb(257,"div",81),o.Kb(258,"div",81),o.Pb(259,"div",82),o.Pb(260,"strong"),o.vc(261,"Cash:"),o.Ob(),o.Ob(),o.Pb(262,"div",85),o.vc(263),o.Zb(264,"number"),o.Ob(),o.Ob(),o.Pb(265,"div",84),o.Kb(266,"div",79),o.Kb(267,"div",80),o.Kb(268,"div",81),o.Kb(269,"div",81),o.Kb(270,"div",81),o.Kb(271,"div",81),o.Kb(272,"div",81),o.Pb(273,"div",82),o.Pb(274,"strong"),o.vc(275,"Cheque Payment:"),o.Ob(),o.Ob(),o.Pb(276,"div",85),o.vc(277),o.Zb(278,"number"),o.Ob(),o.Ob(),o.Pb(279,"div",84),o.Kb(280,"div",79),o.Kb(281,"div",80),o.Kb(282,"div",81),o.Kb(283,"div",81),o.Kb(284,"div",81),o.Kb(285,"div",81),o.Kb(286,"div",81),o.Pb(287,"div",82),o.Pb(288,"strong"),o.vc(289,"Credited Amount:"),o.Ob(),o.Ob(),o.Pb(290,"div",85),o.vc(291),o.Zb(292,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(293,"div",86),o.Pb(294,"div",87),o.Pb(295,"div",88),o.tc(296,Di,4,0,"button",89),o.tc(297,Mi,2,2,"button",90),o.tc(298,Ti,2,0,"button",91),o.tc(299,Ai,2,0,"button",92),o.tc(300,Ri,2,0,"button",93),o.tc(301,Li,2,0,"button",94),o.tc(302,qi,2,0,"button",95),o.tc(303,Ni,2,0,"button",96),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.yb(37),o.ec("ngIf",t.selectedProduct.hasOwnProperty("quantity")),o.yb(9),o.ec("ngIf",!t.isCredit),o.yb(1),o.ec("ngIf",!t.isCredit),o.yb(1),o.ec("ngIf",t.isCredit),o.yb(1),o.ec("ngIf",t.isCredit),o.yb(1),o.ec("ngIf","partial"===t.paymentTypeCheque&&"full"===t.paymentTypeCredit||"full"===t.paymentTypeCheque&&"partial"===t.paymentTypeCredit),o.yb(2),o.ec("disabled","partial"===t.paymentTypeCheque&&"full"===t.paymentTypeCredit||"full"===t.paymentTypeCheque&&"partial"===t.paymentTypeCredit),o.yb(4),o.ec("ngClass",t.showProducts?"active":""),o.yb(11),o.ec("ngModel",t.productSearchText),o.yb(9),o.ec("ngIf",!t.loadingProducts),o.yb(1),o.ec("ngIf",t.loadingProducts),o.yb(21),o.ec("multiple",!1)("ngModel",t.selectedEmployee),o.yb(3),o.ec("ngForOf",t.orderBookers),o.yb(3),o.ec("multiple",!1)("ngModel",t.selectedRoute),o.yb(1),o.ec("ngIf",!t.selectedEmployee),o.yb(1),o.ec("ngIf",t.selectedEmployee),o.yb(1),o.ec("ngForOf",t.routes),o.yb(3),o.ec("multiple",!1)("ngModel",t.selectedRetailer),o.yb(1),o.ec("ngIf",!t.selectedRoute),o.yb(1),o.ec("ngIf",t.selectedRoute),o.yb(1),o.ec("ngForOf",t.retailers),o.yb(8),o.xc(" ",(null==t.selectedRetailer?null:t.selectedRetailer.retailer_name)||"--"," "),o.yb(4),o.yc(" ",(null==t.selectedRetailer?null:t.selectedRetailer.type)||"--"," ",t.selectedRetailer&&" ("+(null==t.selectedRetailer?null:t.selectedRetailer.segment_name)+")"," "),o.yb(4),o.xc(" ",(null==t.selectedRetailer?null:t.selectedRetailer.loc)||"--"," "),o.yb(4),o.xc(" ",(null==t.selectedRetailer?null:t.selectedRetailer.territory)||"--"," "),o.yb(17),o.ec("ngIf",t.permissions.Secondary_Orders.extra_discount),o.yb(5),o.ec("ngForOf",t.selectedProducts),o.yb(1),o.ec("ngIf",!t.selectedProducts.length),o.yb(5),o.xc(" ",t.selectedProducts.length," "),o.yb(9),o.xc(" ",o.bc(171,51,t.grossAmount,"1.2-2")," "),o.yb(13),o.xc(" ",o.bc(184,54,t.tradeOffer,"1.2-2")," "),o.yb(13),o.xc(" ",o.bc(197,57,t.tradeDiscount,"1.2-2")," "),o.yb(13),o.xc(" ",o.bc(210,60,t.specialDiscount,"1.2-2")," "),o.yb(13),o.xc(" ",o.bc(223,63,t.extraDiscount,"1.2-2")," "),o.yb(13),o.wc(o.bc(236,66,t.tax,"1.2-2")),o.yb(14),o.xc(" ",o.bc(250,69,t.dueAmount,"1.2-2")," "),o.yb(14),o.xc(" ",o.bc(264,72,(null==t.cash?null:t.cash.amount_received)||0,"1.2-2")," "),o.yb(14),o.xc(" ",o.bc(278,75,(null==t.cheque?null:t.cheque.amount_received)||0,"1.2-2")," "),o.yb(14),o.xc(" ",o.bc(292,78,(null==t.credit?null:t.credit.amount_received)||0,"1.2-2")," "),o.yb(5),o.ec("ngIf",t.isOrdering),o.yb(1),o.ec("ngIf",!t.isOrdering),o.yb(1),o.ec("ngIf",!t.isOrdering),o.yb(1),o.ec("ngIf",!t.isOrdering&&!t.isChequeAdded),o.yb(1),o.ec("ngIf",!t.isOrdering&&t.isChequeAdded),o.yb(1),o.ec("ngIf",!t.isOrdering&&!t.isCreditAdded),o.yb(1),o.ec("ngIf",!t.isOrdering&&t.isCreditAdded),o.yb(1),o.ec("ngIf",!t.isOrdering))},directives:[r.k,r.i,Kt.a,n.b,n.e,n.h,b.a,b.c,r.j,n.m,n.l,n.j,a.g],pipes:[r.d],styles:['._date-order{padding-left:15px}._sa-customer{flex:0 0 280px;max-width:280px;padding-right:0}.calendar-icon{top:6px}._add-product .addItemCell{width:230px}._add-product .unit-w{width:130px}.addItemCell2{text-align:left!important;color:#282828!important}.AP_heading .addItemCell2{color:#0038ba!important}._add-product input{text-align:left!important}._add-product .addItemCell2_input{text-align:left!important;border:1px solid #fff!important;height:25px!important;margin-top:-3px}._add-product .addItemCell3{width:100px;text-align:right!important}._order-del{right:10px}._INV-h:HOVER ._row-product .addItemCell2_input{border:1px solid #e9e9e9!important}.ng-select .ng-select-container{border-radius:0}.addItemCell .ng-select .ng-select-container{height:25px!important;min-height:25px!important;border-radius:0;text-transform:capitalize}.addItemCell .ng-select .ng-select-container div.ng-input{top:2px!important}._cut-detail,.ng-option,.ng-select span{text-transform:capitalize}._row-product .addItemCell3{color:#282828!important}._totalBar2 ._h25{height:20px;color:#282828;font-size:14px}._totalBar2 .width-t{width:196px;text-align:right!important}._totalBar2 .addItemCell3{font-family:Rationale,sans-serif;font-size:17px;line-height:1}.itemQTY{font-size:12px;width:70px;padding:0 5px;border:1px solid #e6e6e6}.itemIMG{width:32px;height:32px;border:1px solid #e5e5e5;margin-top:-5px;margin-bottom:-5px;margin-right:5px;float:left}.productSearch{position:relative}.productSearch input{height:32px;border:1px solid #eae9e9;box-shadow:none;padding-left:30px;font-size:13px;letter-spacing:1px}.productSearch .fa{position:absolute;top:8px;left:8px;color:#b5b5b5}.AddProductTable{padding:0;margin:0}.AddProductTable tr{border-bottom:1px solid #eee}.AddProductTable td{padding-bottom:10px;padding-top:10px}.ProListDiv{padding:0;display:table;position:relative}.ProListDiv .PR_Name{display:table-cell;vertical-align:middle;font-size:14px;letter-spacing:1px;line-height:16px}.ProListDiv .PrList_img{width:50px;height:50px;margin-right:8px;border:1px solid #e0e0e0}.AddProductTable .btn-default{padding:5px 8px;font-size:13px;border-radius:0;-khtml-border-radius:0;background:linear-gradient(90deg,#1e54d3,#0038ba);color:#fff;text-align:center;margin:0;line-height:1;min-width:74px;letter-spacing:1px;float:right;border:none!important}.AddDetailPR{padding:25px;font-size:14px}.AddDetailPR .form-control{height:32px;border:1px solid #dedede;box-shadow:none;padding:0 10px;font-size:13px;letter-spacing:1px}.AddDetailPR select{border-radius:0;padding:0 10px;height:32px;border:1px solid #dedede;font-size:14px}.Action_bottom{z-index:900}.Action_bottom .btn{letter-spacing:1px;font-size:13px}.se_cus-type{background-color:#fff}._product-name{margin-top:5px;position:relative;padding-right:0;color:#282828;font-size:12px;line-height:normal}.lab-promotion{position:absolute;top:-8px;left:-.438rem;padding:2px 6px;font-size:10.5px;z-index:3;background-color:#fed02a;color:#282828;line-height:1}.lab-promotion:before{border-top:4px solid #000;border-left:7px solid transparent;content:"";left:0;position:absolute;top:14px;z-index:-1}.lab-promotion-l{position:absolute;top:-15px;left:-13px;padding:1px 6px;font-size:10.5px;z-index:3;background-color:#fed02a;color:#282828;line-height:1;letter-spacing:1px}.lab-promotion-l:before{border-top:4px solid #000;border-left:7px solid transparent;content:"";left:0;position:absolute;top:12px;z-index:-1}._row-product{padding:12px 0 10px!important}._order-container{max-width:1270px}.loader{text-align:center;padding:30px}.loading{color:#b5b5b5;font-size:24px;margin:0 auto}.ng-select .ng-clear-wrapper{display:none}.custom-control-label{text-transform:capitalize}.no-data{width:100%;color:#a89a9a;font-size:20px;text-align:center}.input-error{color:red;font-size:13px;float:left}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.print-icon-div,.print-icon-div a{text-align:center;padding:15px}.print-icon-div a{display:inline-block;border:1px solid #e9ecef;width:100%;text-decoration:none;color:#282828;font-size:13px}.print-icon-div a:HOVER{border:1px solid #0038ba;color:#0038ba;box-shadow:0 0 20px 0 rgba(0,0,0,.3)}.print-icon{filter:grayscale(1);width:45px;opacity:.7;display:block;margin:10px auto 15px}.print-icon-div a:HOVER .print-icon{filter:none;opacity:1}.heading3{margin:0;font-size:16px}.select-date,.select-date:focus{box-shadow:none;border:none;background-color:#f6f6f6;font-size:14px;height:30px;width:200px}.no-content{width:100%;height:65vh;display:flex}.no-content .no-content-container{margin:auto;display:table;text-align:center;color:#b7b7b7}.no-content .no-content-container img{width:70px;height:70px;margin:auto auto 10px;display:block}'],encapsulation:2}),e})(),Yi=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Db({type:e,selectors:[["app-booking-vs-execution"]],decls:325,vars:0,consts:[[1,"container"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],[1,"row"],[1,"col-lg-12"],[1,"header-tabs"],[1,"Product-Filter"],[1,"col-12"],[1,"CL-Product"],[1,"fa","fa-calendar-alt"],["type","text","id","datepicker","placeholder","Select Date",1,"form-control"],[1,"_cust_filter"],[1,"form-s2"],["placeholder","Select Order Booker",1,"form-control","formselect"],[1,"btn","btn-primary"],[1,"fa","fa-retweet"],[1,"clearfix"],[1,"card","p-15"],[1,"topstats"],[1,"row","m-0"],[1,"col","pl-0","pr-0"],[1,"gary-box"],[1,"col","pr-0"],[1,"col-6"],[1,"col-12","header","head-div"],[1,"col-12","value-sec"],[1,"col-6","value-sh"],[1,"col-12","header","head-div","border-left-0"],[1,"col-12","value-sec","border-left-0"],[1,"col-12","p-0","PT-20","PB-15"],[1,"Product-row-title"],[1,"col","colStyle","h-auto",2,"max-width","255px"],[1,"col","colStyle","h-auto",2,"max-width","159px"],[1,"col","colStyle","h-auto",2,"max-width","172px"],[1,"col","colStyle","h-auto",2,"max-width","135px"],[1,"col","colStyle","h-auto",2,"max-width","150px"],[1,"col","colStyle","h-auto",2,"max-width","127px"],[1,"col","colStyle","h-auto",2,"max-width","115px"],[1,"Product-row"],[1,"col","_ITEMNAME",2,"max-width","255px","font-size","14px"],[1,"pt-10"],[1,"r-location"],[1,"fa","fa-map-marker-alt"],[1,"col","colStyle","font-no",2,"max-width","159px"],[1,"col","colStyle","font-no",2,"max-width","172px"],[1,"col","colStyle","font-no",2,"max-width","135px"],[1,"col","colStyle","font-no",2,"max-width","150px"],[1,"col","colStyle",2,"max-width","127px"],[1,"fa","fa-circle","executed-st"],[1,"col","colStyle",2,"max-width","115px"],[1,"btn","btn-default","btn-line","smBTN"],[1,"fa","fa-circle","pending-st"],[1,"fa","fa-circle","cancel-st"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"h2",3),o.vc(4,"Booking "),o.Pb(5,"span"),o.vc(6," vs Execution"),o.Ob(),o.Ob(),o.Ob(),o.Pb(7,"div",2),o.Pb(8,"ol",4),o.Pb(9,"li"),o.Pb(10,"a"),o.Pb(11,"span"),o.vc(12,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(13,"li"),o.Pb(14,"span"),o.vc(15,"Booking vs Execution"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(16,"div",5),o.Pb(17,"div",6),o.Pb(18,"div",7),o.Pb(19,"div",8),o.Pb(20,"div",5),o.Pb(21,"div",9),o.Pb(22,"div",10),o.Kb(23,"i",11),o.Kb(24,"input",12),o.Ob(),o.Pb(25,"div",13),o.Pb(26,"div",14),o.Pb(27,"select",15),o.Pb(28,"option"),o.vc(29,"Select Order Booker "),o.Ob(),o.Pb(30,"option"),o.vc(31,"Asif Ali"),o.Ob(),o.Pb(32,"option"),o.vc(33,"Utba Aziz"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(34,"button",16),o.Kb(35,"i",17),o.vc(36," Fetch"),o.Ob(),o.Ob(),o.Ob(),o.Kb(37,"div",18),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(38,"div",19),o.Pb(39,"div",20),o.Pb(40,"div",21),o.Pb(41,"div",22),o.Pb(42,"div",23),o.Pb(43,"strong"),o.vc(44,"Order Booker:"),o.Ob(),o.Pb(45,"span"),o.vc(46,"Babar Ali"),o.Ob(),o.Ob(),o.Ob(),o.Pb(47,"div",24),o.Pb(48,"div",23),o.Pb(49,"strong"),o.vc(50,"Date:"),o.Ob(),o.Pb(51,"span"),o.vc(52,"19-09-2020"),o.Ob(),o.Ob(),o.Ob(),o.Pb(53,"div",24),o.Pb(54,"div",23),o.Pb(55,"strong"),o.vc(56,"Total Booking:"),o.Ob(),o.Pb(57,"span"),o.vc(58,"Rs. 100,000"),o.Ob(),o.Ob(),o.Ob(),o.Pb(59,"div",24),o.Pb(60,"div",23),o.Pb(61,"strong"),o.vc(62,"Total Execution:"),o.Ob(),o.Pb(63,"span"),o.vc(64,"Rs. 100,000"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(65,"div",21),o.Pb(66,"div",25),o.Pb(67,"div",5),o.Pb(68,"div",26),o.Pb(69,"h2"),o.vc(70,"Booking"),o.Ob(),o.Ob(),o.Pb(71,"div",27),o.Pb(72,"div",5),o.Pb(73,"div",28),o.Pb(74,"strong"),o.vc(75,"Total Booking:"),o.Ob(),o.Pb(76,"span"),o.vc(77,"Rs. 100,000"),o.Ob(),o.Ob(),o.Pb(78,"div",28),o.Pb(79,"strong"),o.vc(80,"Total Booked Orders:"),o.Ob(),o.Pb(81,"span"),o.vc(82,"Rs. 100,000"),o.Ob(),o.Ob(),o.Pb(83,"div",28),o.Pb(84,"strong"),o.vc(85,"Total Shop Visited:"),o.Ob(),o.Pb(86,"span"),o.vc(87,"20"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(88,"div",25),o.Pb(89,"div",5),o.Pb(90,"div",29),o.Pb(91,"h2"),o.vc(92,"Execution"),o.Ob(),o.Ob(),o.Pb(93,"div",30),o.Pb(94,"div",5),o.Pb(95,"div",28),o.Pb(96,"strong"),o.vc(97,"Total Execution:"),o.Ob(),o.Pb(98,"span"),o.vc(99,"Rs. 100,000"),o.Ob(),o.Ob(),o.Pb(100,"div",28),o.Pb(101,"strong"),o.vc(102,"Total Orders Executed:"),o.Ob(),o.Pb(103,"span"),o.vc(104,"Rs. 100,000"),o.Ob(),o.Ob(),o.Pb(105,"div",28),o.Pb(106,"strong"),o.vc(107,"Total Cancel Orders:"),o.Ob(),o.Pb(108,"span"),o.vc(109,"20"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(110,"div",31),o.Pb(111,"div",32),o.Pb(112,"div",5),o.Pb(113,"div",33),o.vc(114,"Retailer Name"),o.Ob(),o.Pb(115,"div",34),o.vc(116,"Booked Products"),o.Ob(),o.Pb(117,"div",35),o.vc(118,"Executed Products"),o.Ob(),o.Pb(119,"div",36),o.vc(120,"Booking Value"),o.Ob(),o.Pb(121,"div",37),o.vc(122,"Execution Value"),o.Ob(),o.Pb(123,"div",38),o.vc(124,"Order Status"),o.Ob(),o.Pb(125,"div",39),o.vc(126,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(127,"div",40),o.Pb(128,"div",5),o.Pb(129,"div",41),o.Pb(130,"div",42),o.Pb(131,"strong"),o.vc(132,"Sardar General Store"),o.Ob(),o.Pb(133,"span",43),o.Kb(134,"i",44),o.vc(135," Main Bazar Fateh Garh "),o.Ob(),o.Ob(),o.Ob(),o.Pb(136,"div",45),o.Pb(137,"div",42),o.vc(138,"22"),o.Ob(),o.Ob(),o.Pb(139,"div",46),o.Pb(140,"div",42),o.vc(141,"20"),o.Ob(),o.Ob(),o.Pb(142,"div",47),o.Pb(143,"div",42),o.Pb(144,"small"),o.vc(145,"Rs."),o.Ob(),o.vc(146," 70,000"),o.Ob(),o.Ob(),o.Pb(147,"div",48),o.Pb(148,"div",42),o.Pb(149,"small"),o.vc(150,"Rs."),o.Ob(),o.vc(151," 60,000"),o.Ob(),o.Ob(),o.Pb(152,"div",49),o.Pb(153,"div",42),o.Kb(154,"i",50),o.vc(155," Executed"),o.Ob(),o.Ob(),o.Pb(156,"div",51),o.Pb(157,"div",42),o.Pb(158,"button",52),o.vc(159,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(160,"div",40),o.Pb(161,"div",5),o.Pb(162,"div",41),o.Pb(163,"div",42),o.Pb(164,"strong"),o.vc(165,"Sardar General Store"),o.Ob(),o.Pb(166,"span",43),o.Kb(167,"i",44),o.vc(168," Main Bazar Fateh Garh"),o.Ob(),o.Ob(),o.Ob(),o.Pb(169,"div",45),o.Pb(170,"div",42),o.vc(171,"22"),o.Ob(),o.Ob(),o.Pb(172,"div",46),o.Pb(173,"div",42),o.vc(174,"20"),o.Ob(),o.Ob(),o.Pb(175,"div",47),o.Pb(176,"div",42),o.Pb(177,"small"),o.vc(178,"Rs."),o.Ob(),o.vc(179," 70,000"),o.Ob(),o.Ob(),o.Pb(180,"div",48),o.Pb(181,"div",42),o.Pb(182,"small"),o.vc(183,"Rs."),o.Ob(),o.vc(184," 60,000"),o.Ob(),o.Ob(),o.Pb(185,"div",49),o.Pb(186,"div",42),o.Kb(187,"i",53),o.vc(188," Pending"),o.Ob(),o.Ob(),o.Pb(189,"div",51),o.Pb(190,"div",42),o.Pb(191,"button",52),o.vc(192,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(193,"div",40),o.Pb(194,"div",5),o.Pb(195,"div",41),o.Pb(196,"div",42),o.Pb(197,"strong"),o.vc(198,"Sardar General Store"),o.Ob(),o.Pb(199,"span",43),o.Kb(200,"i",44),o.vc(201," Main Bazar Fateh Garh"),o.Ob(),o.Ob(),o.Ob(),o.Pb(202,"div",45),o.Pb(203,"div",42),o.vc(204,"22"),o.Ob(),o.Ob(),o.Pb(205,"div",46),o.Pb(206,"div",42),o.vc(207,"20"),o.Ob(),o.Ob(),o.Pb(208,"div",47),o.Pb(209,"div",42),o.Pb(210,"small"),o.vc(211,"Rs."),o.Ob(),o.vc(212," 70,000"),o.Ob(),o.Ob(),o.Pb(213,"div",48),o.Pb(214,"div",42),o.Pb(215,"small"),o.vc(216,"Rs."),o.Ob(),o.vc(217," 60,000"),o.Ob(),o.Ob(),o.Pb(218,"div",49),o.Pb(219,"div",42),o.Kb(220,"i",54),o.vc(221," Cancelled"),o.Ob(),o.Ob(),o.Pb(222,"div",51),o.Pb(223,"div",42),o.Pb(224,"button",52),o.vc(225,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(226,"div",40),o.Pb(227,"div",5),o.Pb(228,"div",41),o.Pb(229,"div",42),o.Pb(230,"strong"),o.vc(231,"Sardar General Store"),o.Ob(),o.Pb(232,"span",43),o.Kb(233,"i",44),o.vc(234," Main Bazar Fateh Garh "),o.Ob(),o.Ob(),o.Ob(),o.Pb(235,"div",45),o.Pb(236,"div",42),o.vc(237,"22"),o.Ob(),o.Ob(),o.Pb(238,"div",46),o.Pb(239,"div",42),o.vc(240,"20"),o.Ob(),o.Ob(),o.Pb(241,"div",47),o.Pb(242,"div",42),o.Pb(243,"small"),o.vc(244,"Rs."),o.Ob(),o.vc(245," 70,000"),o.Ob(),o.Ob(),o.Pb(246,"div",48),o.Pb(247,"div",42),o.Pb(248,"small"),o.vc(249,"Rs."),o.Ob(),o.vc(250," 60,000"),o.Ob(),o.Ob(),o.Pb(251,"div",49),o.Pb(252,"div",42),o.Kb(253,"i",50),o.vc(254," Executed"),o.Ob(),o.Ob(),o.Pb(255,"div",51),o.Pb(256,"div",42),o.Pb(257,"button",52),o.vc(258,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(259,"div",40),o.Pb(260,"div",5),o.Pb(261,"div",41),o.Pb(262,"div",42),o.Pb(263,"strong"),o.vc(264,"Sardar General Store"),o.Ob(),o.Pb(265,"span",43),o.Kb(266,"i",44),o.vc(267," Main Bazar Fateh Garh"),o.Ob(),o.Ob(),o.Ob(),o.Pb(268,"div",45),o.Pb(269,"div",42),o.vc(270,"22"),o.Ob(),o.Ob(),o.Pb(271,"div",46),o.Pb(272,"div",42),o.vc(273,"20"),o.Ob(),o.Ob(),o.Pb(274,"div",47),o.Pb(275,"div",42),o.Pb(276,"small"),o.vc(277,"Rs."),o.Ob(),o.vc(278," 70,000"),o.Ob(),o.Ob(),o.Pb(279,"div",48),o.Pb(280,"div",42),o.Pb(281,"small"),o.vc(282,"Rs."),o.Ob(),o.vc(283," 60,000"),o.Ob(),o.Ob(),o.Pb(284,"div",49),o.Pb(285,"div",42),o.Kb(286,"i",53),o.vc(287," Pending"),o.Ob(),o.Ob(),o.Pb(288,"div",51),o.Pb(289,"div",42),o.Pb(290,"button",52),o.vc(291,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(292,"div",40),o.Pb(293,"div",5),o.Pb(294,"div",41),o.Pb(295,"div",42),o.Pb(296,"strong"),o.vc(297,"Sardar General Store"),o.Ob(),o.Pb(298,"span",43),o.Kb(299,"i",44),o.vc(300," Main Bazar Fateh Garh"),o.Ob(),o.Ob(),o.Ob(),o.Pb(301,"div",45),o.Pb(302,"div",42),o.vc(303,"22"),o.Ob(),o.Ob(),o.Pb(304,"div",46),o.Pb(305,"div",42),o.vc(306,"20"),o.Ob(),o.Ob(),o.Pb(307,"div",47),o.Pb(308,"div",42),o.Pb(309,"small"),o.vc(310,"Rs."),o.Ob(),o.vc(311," 70,000"),o.Ob(),o.Ob(),o.Pb(312,"div",48),o.Pb(313,"div",42),o.Pb(314,"small"),o.vc(315,"Rs."),o.Ob(),o.vc(316," 60,000"),o.Ob(),o.Ob(),o.Pb(317,"div",49),o.Pb(318,"div",42),o.Kb(319,"i",54),o.vc(320," Cancelled"),o.Ob(),o.Ob(),o.Pb(321,"div",51),o.Pb(322,"div",42),o.Pb(323,"button",52),o.vc(324,"View Detail"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob())},directives:[n.i,n.o],styles:[".topstats[_ngcontent-%COMP%]{margin-top:0;font-size:13px;margin-bottom:15px}.topstats[_ngcontent-%COMP%]   .gary-box[_ngcontent-%COMP%]{line-height:1;background-color:#f9f9f9;border-bottom:1px solid #d1d1d1;padding:10px}.topstats[_ngcontent-%COMP%]   .gary-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .value-sh[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Rationale,sans-serif;color:#0038ba;font-size:20px;float:right;margin-top:-4px}.value-sh[_ngcontent-%COMP%]{font-size:13px}.value-sh[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}.value-sec[_ngcontent-%COMP%]{background-color:#f9f9f9;padding-top:10px;padding-bottom:4px}.head-div[_ngcontent-%COMP%], .value-sec[_ngcontent-%COMP%]{border:1px solid #e6e6e6}.head-div[_ngcontent-%COMP%]{border-bottom:none;background:none!important;padding:10px 20px!important}._cust_filter[_ngcontent-%COMP%]{width:250px;padding-top:0;padding-right:10px;float:left;margin-bottom:15px}._cust_filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:32px}.Product-row[_ngcontent-%COMP%]{box-shadow:0 0 2px 0 rgba(0,0,0,.2)}.Product-row-title[_ngcontent-%COMP%]{background-color:#f9f9f9;color:#282828;text-transform:none!important}.Product-IMG[_ngcontent-%COMP%]{margin-bottom:-5px}.Product-IMG[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:1px solid #333}.Product-Name[_ngcontent-%COMP%]{color:grey;line-height:1}.Product-Name[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#282828;padding-bottom:3px;display:block}._ITEMNAME[_ngcontent-%COMP%]{height:auto}.font-no[_ngcontent-%COMP%]{font-size:20px;line-height:1;font-family:Rationale,sans-serif!important}.r-location[_ngcontent-%COMP%]{display:block;color:#a0a0a0;font-size:13px}.executed-st[_ngcontent-%COMP%]{color:#06c420;font-size:12px}.cancel-st[_ngcontent-%COMP%]{color:#c40606;font-size:12px}.pending-st[_ngcontent-%COMP%]{color:#d9a20a;font-size:12px}.date-order[_ngcontent-%COMP%]{width:200px;position:relative;float:left;padding-right:15px}.date-order[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:32px;border:1px solid #dedede;box-shadow:none;padding-left:15px;font-size:13px;letter-spacing:1px}.Product-Filter[_ngcontent-%COMP%]{background-color:#f3f2f2;padding:15px 15px 0;box-shadow:0 0 20px 0 rgba(0,0,0,.2);margin-bottom:15px;border-bottom:2px solid #0038ba}.Product-Filter[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{color:#fff!important;cursor:pointer;float:left;margin:0;padding-top:4px;padding-bottom:4px;letter-spacing:1px}.CL-Product[_ngcontent-%COMP%]{width:230px;position:relative;float:left;padding-right:10px}.CL-Product[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:32px;border:1px solid #dedede;box-shadow:none;padding-left:30px;font-size:13px;letter-spacing:1px}.CL-Product[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;color:#b5b5b5}.Product-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.Product-row-title[_ngcontent-%COMP%]{padding:10px 8px;text-transform:uppercase;color:#000;font-family:proximanova-semibold,sans-serif;letter-spacing:1px}.Product-row[_ngcontent-%COMP%], .Product-row-title[_ngcontent-%COMP%]{border:none;position:relative;font-size:13px;transform:scale(.97)}.Product-row[_ngcontent-%COMP%]{background-color:#fff;padding:5px 8px;border-radius:0;width:100%;margin-bottom:-1px;transition:all .2s;box-shadow:0 0 2px 0 rgba(0 0 0/20%)}.Product-row[_ngcontent-%COMP%]:HOVER{border-bottom:2px solid #0038ba;transition:all .3s ease;transform:scale(1);box-shadow:0 0 30px 0 rgba(0,0,0,.3);z-index:5}.Product-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Product-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none;color:#282828}@media (max-width:1024px){.Product-row[_ngcontent-%COMP%]{transform:scale(1)}}"]}),e})();var Ei=i("XNiG");function Ji(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Ob(),o.Pb(7,"td"),o.Pb(8,"button",21),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb().routeToPdf("ls",i)})),o.vc(9,"Load Sheet"),o.Ob(),o.Pb(10,"button",21),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb().routeToPdf("bills",i)})),o.vc(11,"Bills"),o.Ob(),o.Pb(12,"button",21),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb().routeToPdf("dsr",i)})),o.vc(13,"DSR"),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit;o.yb(2),o.wc(e.id),o.yb(2),o.wc(e.salesman),o.yb(2),o.xc("Rs. ",e.total_net_sale,"")}}let Ki=(()=>{class e{constructor(e,t,i){this.ordersService=e,this.toastService=t,this.ls=i,this.dtOptions={},this.loading=!1,this.date=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate(),this.loadsheets=[],this.isDtInitialized=!1,this.dtTrigger=new Ei.a,this.dtOptions={pagingType:"simple_numbers"}}ngOnInit(){this.getData()}routeToPdf(e,t){"ls"==e?window.open(`${L.a.apiDomain}/LoadSheetDataPdf/${t.id}/${t.salesman_id}/${t.date}`,"_blank"):"bs"==e?window.open(`${L.a.apiDomain}/BookingSheetPdf?emp=${t.salesman_id}&date=${t.date}&loadId=${t.id}`,"_blank"):"bills"==e?window.open(`${L.a.apiDomain}/GetAllBillsDetail?type=bill&emp=${t.salesman_id}&date=${t.date}&dist_id=${this.ls.getItem("distributor").id}&size=A4&status=processed&loadId=${t.id}`,"_blank"):"dsr"==e&&window.open(`${L.a.apiDomain}/pdfDSRNew/${t.dsrId}`,"_blank")}getData(){this.loading=!0,this.isDtInitialized&&(this.dtElement.dtInstance.then(e=>{e.destroy()}),this.isDtInitialized=!1),this.ordersService.getCompletedOrdersLoadsheets(this.date).subscribe(e=>{this.loadsheets=e,this.isDtInitialized||(this.isDtInitialized=!0,this.dtTrigger.next()),this.loading=!1})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(c.a),o.Jb(l.a),o.Jb(J.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-completed-orders-detail"]],viewQuery:function(e,t){var i;1&e&&o.Ac(u.a,!0),2&e&&o.mc(i=o.Xb())&&(t.dtElement=i.first)},decls:51,vars:9,consts:[[1,"container"],[1,"row","mt-2","mb-2"],[1,"col-lg-6","col-md-6","col-sm-6"],[1,"_head01"],[1,"breadcrumb"],["href","#"],[1,"row"],[1,"col-lg-12"],[1,"header-tabs"],[1,"Product-Filter"],[1,"col-12"],[1,"CL-Product"],["placeholder","Start Date","type","text","onfocus","(this.type = 'date')","id","date",1,"form-control","pad-date",3,"ngModel","change","ngModelChange"],[1,"clearfix"],[1,"col-md-12"],[1,"card"],[1,"header"],[1,"_list-total"],[1,"body"],["datatable","","id","example",1,"table","table-hover","dt-responsive","nowrap",2,"width","100%",3,"dtTrigger","dtOptions"],[4,"ngFor","ngForOf"],[1,"btn","btn-default","mb-0",3,"click"]],template:function(e,t){1&e&&(o.Pb(0,"div",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"h2",3),o.vc(4,"Orders "),o.Pb(5,"span"),o.vc(6," Management"),o.Ob(),o.Ob(),o.Ob(),o.Pb(7,"div",2),o.Pb(8,"ol",4),o.Pb(9,"li"),o.Pb(10,"a",5),o.Pb(11,"span"),o.vc(12,"Orders"),o.Ob(),o.Ob(),o.Ob(),o.Pb(13,"li"),o.Pb(14,"span"),o.vc(15,"List"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(16,"div",6),o.Pb(17,"div",7),o.Pb(18,"div",8),o.Pb(19,"div",9),o.Pb(20,"div",6),o.Pb(21,"div",10),o.Pb(22,"div",11),o.Pb(23,"input",12),o.Wb("change",(function(){return t.getData()}))("ngModelChange",(function(e){return t.date=e})),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Kb(24,"div",13),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(25,"div",6),o.Pb(26,"div",14),o.Pb(27,"div",15),o.Pb(28,"div",16),o.Pb(29,"h2"),o.vc(30,"Completed "),o.Pb(31,"span"),o.vc(32," Orders"),o.Ob(),o.Pb(33,"div",17),o.vc(34),o.Ob(),o.Ob(),o.Ob(),o.Pb(35,"div",18),o.Pb(36,"table",19),o.Pb(37,"thead"),o.Pb(38,"tr"),o.Pb(39,"th"),o.vc(40,"Load ID"),o.Ob(),o.Pb(41,"th"),o.vc(42,"Salesman"),o.Ob(),o.Pb(43,"th"),o.vc(44,"Sales Amount"),o.Ob(),o.Pb(45,"th"),o.vc(46,"Action"),o.Ob(),o.Ob(),o.Ob(),o.Pb(47,"tbody"),o.tc(48,Ji,14,3,"tr",20),o.Ob(),o.Ob(),o.Pb(49,"div",14),o.Kb(50,"app-loader-white"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.yb(23),o.ec("ngModel",t.date),o.yb(11),o.wc(t.loadsheets.length),o.yb(2),o.sc("display",t.loading?"none":""),o.ec("dtTrigger",t.dtTrigger)("dtOptions",t.dtOptions),o.yb(12),o.ec("ngForOf",t.loadsheets),o.yb(1),o.sc("display",t.loading?"":"none"))},directives:[n.b,n.e,n.h,u.a,r.j,p.a],styles:[""]}),e})();var Fi=i("2Vo4");let Qi=(()=>{class e{constructor(){this.orderLoad=new Fi.a(null)}setLoadContent(e,t){return e.items.forEach(e=>{const i=t.items.find(t=>t.item_id===e.item_id);i?(i.actual_qty=i.actual_qty+e.dispatch_qty,i.dispatched_qty=i.dispatched_qty+e.dispatch_qty):t.items.push({item_id:e.item_id,pref_id:e.pref_id,unit_id:e.unit_id,item_trade_price:e.original_price,actual_qty:e.dispatch_qty,dispatched_qty:e.dispatch_qty,issued_qty:0})}),t.order_ids.push(e.id),t.total_orders=t.order_ids.length,t.total_products=t.items.length,t}removeOrderFromCurrentLoad(e,t){return e.items.forEach(e=>{const i=t.items.find(t=>t.item_id===e.item_id);i&&(i.actual_qty=i.actual_qty-e.dispatch_qty,i.dispatched_qty=i.dispatched_qty-e.dispatch_qty-i.issued_qty,i.issued_qty=0),0===i.actual_qty&&(t.items=t.items.filter(t=>t.item_id!==e.item_id))}),t.order_ids=t.order_ids.filter(t=>t!==e.id),t.total_orders=t.order_ids.length,t.total_products=t.items.length,t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac}),e})();function $i(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-products-drawer",64),o.Wb("drawerClosed",(function(){return o.oc(e),o.Yb().closeNewProducts()}))("productSelected",(function(t){return o.oc(e),o.Yb().addNewProductToOrder(t)})),o.Ob()}if(2&e){const e=o.Yb();o.ec("selectedRetailer",e.selectedRetailer)("orderedProducts",null==e.orderDetails?null:e.orderDetails.items)("loadingProducts",e.loadingProduct)("allProducts",e.inventory)("productSchemes",e.schemes)("productMerchantDiscount",e.merchantDiscount)("specialDiscounts",e.specialDiscounts)}}function zi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"app-order-items-list",69),o.Wb("openDrawer",(function(){return o.oc(e),o.Yb(2).openProductsList()})),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("orderDetail",e.orderDetails)("schemes",e.schemes)("selectedRetailer",e.selectedRetailer)("orders",e.ordersRetailers)("allProducts",e.inventory)("specialDiscounts",e.specialDiscounts)("merchantDiscount",e.merchantDiscount)("newProduct",e.newProduct)("orderType","dispatch")}}function Wi(e,t){1&e&&(o.Pb(0,"div",21),o.Kb(1,"app-loader-white"),o.Ob())}function Zi(e,t){1&e&&(o.Pb(0,"div",70),o.Pb(1,"div",71),o.Kb(2,"img",72),o.Pb(3,"strong"),o.vc(4,"Select order to see details"),o.Ob(),o.Ob(),o.Ob())}function Vi(e,t){if(1&e&&(o.Pb(0,"div",65),o.tc(1,zi,1,9,"app-order-items-list",66),o.tc(2,Wi,2,0,"div",67),o.tc(3,Zi,5,0,"div",68),o.Ob()),2&e){const e=o.Yb();o.yb(1),o.ec("ngIf",!e.savingOrder&&e.selectedRetailer),o.yb(1),o.ec("ngIf",e.savingOrder),o.yb(1),o.ec("ngIf",!e.savingOrder&&!e.selectedRetailer)}}function Gi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",77),o.Wb("click",(function(){return o.oc(e),o.Yb(2).setOrderItems()})),o.vc(1," Save Order "),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("disabled",!(null!=e.orderDetails&&null!=e.orderDetails.items&&e.orderDetails.items.length))}}function Ui(e,t){if(1&e&&(o.Pb(0,"button",78),o.vc(1," Cancel Order "),o.Ob()),2&e){const e=o.Yb(2);o.ec("disabled",!(null!=e.orderDetails&&null!=e.orderDetails.items&&e.orderDetails.items.length))}}function Hi(e,t){1&e&&(o.Pb(0,"button",79),o.Pb(1,"div",80),o.Pb(2,"span",81),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}function ji(e,t){if(1&e&&(o.Pb(0,"div",73),o.tc(1,Gi,2,1,"button",74),o.tc(2,Ui,2,1,"button",75),o.tc(3,Hi,4,0,"button",76),o.Ob()),2&e){const e=o.Yb();o.yb(1),o.ec("ngIf",!e.savingOrder),o.yb(1),o.ec("ngIf",!e.savingOrder),o.yb(1),o.ec("ngIf",e.savingOrder)}}function Xi(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",96),o.Pb(1,"div",97),o.vc(2),o.Ob(),o.Pb(3,"div",17),o.Pb(4,"div",98),o.Pb(5,"strong",99),o.vc(6),o.Ob(),o.Pb(7,"span"),o.Pb(8,"strong"),o.vc(9,"Order Booker:"),o.Ob(),o.vc(10),o.Ob(),o.Pb(11,"span"),o.Kb(12,"i",100),o.vc(13),o.Ob(),o.Ob(),o.Pb(14,"div",101),o.Pb(15,"div",88),o.Pb(16,"input",102),o.Wb("change",(function(){o.oc(e);const i=t.$implicit;return o.Yb(3).retailerSelected(i)}))("ngModelChange",(function(i){return o.oc(e),t.$implicit.isSelected=i})),o.Ob(),o.Kb(17,"label",103),o.Ob(),o.Pb(18,"div",104),o.vc(19," Total Sales"),o.Pb(20,"span",105),o.vc(21),o.Zb(22,"number"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=t.index;o.yb(2),o.wc(i+1),o.yb(4),o.wc(e.retailer_name),o.yb(4),o.xc(" ",e.emp_name,""),o.yb(3),o.xc(" ",e.retailer_address,""),o.yb(3),o.ec("name",i)("ngModel",e.isSelected)("id","ord"+i),o.yb(1),o.ec("for","ord"+i),o.yb(4),o.xc("Rs. ",o.bc(22,9,e.order_total||0,"1.2-2"),"")}}function er(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",84),o.Pb(1,"div",85),o.Pb(2,"div",86),o.Pb(3,"div",17),o.Pb(4,"div",21),o.Pb(5,"h2",59),o.vc(6,"Orders "),o.Pb(7,"span"),o.vc(8," List"),o.Ob(),o.Ob(),o.Pb(9,"div",87),o.Pb(10,"div",88),o.Pb(11,"input",89),o.Wb("ngModelChange",(function(t){return o.oc(e),o.Yb(2).isAllSelected=t}))("change",(function(){return o.oc(e),o.Yb(2).allSelected()})),o.Ob(),o.Pb(12,"label",90),o.vc(13,"Select All"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(14,"div",21),o.Pb(15,"div",91),o.Kb(16,"i",92),o.Kb(17,"input",93),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(18,"div",94),o.tc(19,Xi,23,12,"div",95),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb(2);o.yb(11),o.ec("ngModel",e.isAllSelected),o.yb(8),o.ec("ngForOf",e.ordersDispList)}}function tr(e,t){if(1&e){const e=o.Qb();o.Pb(0,"a",118),o.Wb("click",(function(){o.oc(e);const i=t.$implicit;return o.Yb(3).changeCurrentLoad(i.loadNumber)})),o.vc(1),o.Ob()}if(2&e){const e=t.$implicit,i=o.Yb(3);o.ec("id",e.loadNumber)("ngClass",e.loadNumber===i.currentLoadContent.loadNumber?"active":""),o.yb(1),o.xc("Load ",e.loadNumber,"")}}function ir(e,t){if(1&e){const e=o.Qb();o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.Pb(5,"td"),o.vc(6),o.Zb(7,"number"),o.Ob(),o.Pb(8,"td"),o.Pb(9,"input",119),o.Wb("ngModelChange",(function(i){return o.oc(e),t.$implicit.issued_qty=i}))("keyup",(function(){o.oc(e);const i=t.$implicit;return o.Yb(3).updateDispatchedQty(i)}))("keydown",(function(t){return o.oc(e),o.Yb(3).isNumber(t,"quantity")})),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=t.$implicit,i=o.Yb(3);o.yb(2),o.wc(e.item_id),o.yb(2),o.wc(i.getItemName(e.item_id)),o.yb(2),o.wc(o.ac(7,6,e.actual_qty)),o.yb(3),o.ec("ngModel",e.issued_qty)("name",e.item_id)("id",e.item_id)}}function rr(e,t){if(1&e&&(o.Pb(0,"div",50),o.Pb(1,"div",106),o.Pb(2,"div",107),o.Pb(3,"div",108),o.tc(4,tr,2,3,"a",109),o.Ob(),o.Ob(),o.Pb(5,"div",110),o.Pb(6,"div",111),o.Pb(7,"div",112),o.Pb(8,"table",113),o.Pb(9,"thead"),o.Pb(10,"tr"),o.Pb(11,"th",114),o.vc(12,"SN"),o.Ob(),o.Pb(13,"th",114),o.vc(14,"Product Name"),o.Ob(),o.Pb(15,"th",115),o.vc(16," Actual "),o.Ob(),o.Pb(17,"th",115),o.vc(18," Issuance "),o.Ob(),o.Ob(),o.Pb(19,"tr"),o.Pb(20,"th",116),o.vc(21,"BOX/PIECE"),o.Ob(),o.Pb(22,"th",116),o.vc(23,"BOX/PIECE"),o.Ob(),o.Ob(),o.Ob(),o.Pb(24,"tbody"),o.tc(25,ir,10,8,"tr",117),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e){const e=o.Yb(2);o.yb(4),o.ec("ngForOf",null==e.load?null:e.load.content),o.yb(21),o.ec("ngForOf",e.currentLoadContent.items)}}function nr(e,t){1&e&&(o.Pb(0,"div",21),o.Kb(1,"app-loader-white"),o.Ob())}function ar(e,t){if(1&e&&(o.Pb(0,"div",47),o.tc(1,er,20,2,"div",82),o.tc(2,rr,26,2,"div",83),o.tc(3,nr,2,0,"div",67),o.Ob()),2&e){const e=o.Yb();o.yb(1),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading)}}function or(e,t){if(1&e&&(o.Pb(0,"th",123),o.vc(1),o.Ob()),2&e){const e=t.index;o.yb(1),o.xc(" Load ",e+1," ")}}function sr(e,t){1&e&&(o.Pb(0,"tr"),o.Pb(1,"th"),o.vc(2,"CTN/Bundle"),o.Ob(),o.Pb(3,"th"),o.vc(4,"Box/Piece"),o.Ob(),o.Pb(5,"th"),o.vc(6,"CTN/Bundle"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Box/Piece"),o.Ob(),o.Pb(9,"th"),o.vc(10,"CTN/Bundle"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Box/Piece"),o.Ob(),o.Pb(13,"th"),o.vc(14,"CTN/Bundle"),o.Ob(),o.Pb(15,"th"),o.vc(16,"Box/Piece"),o.Ob(),o.Ob())}function dr(e,t){1&e&&(o.Pb(0,"tr"),o.Pb(1,"th"),o.vc(2,"CTN/Bundle"),o.Ob(),o.Pb(3,"th"),o.vc(4,"Box/Piece"),o.Ob(),o.Pb(5,"th"),o.vc(6,"CTN/Bundle"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Box/Piece"),o.Ob(),o.Pb(9,"th"),o.vc(10,"CTN/Bundle"),o.Ob(),o.Pb(11,"th"),o.vc(12,"Box/Piece"),o.Ob(),o.Ob())}function cr(e,t){1&e&&(o.Pb(0,"tr"),o.Pb(1,"th"),o.vc(2,"CTN/Bundle"),o.Ob(),o.Pb(3,"th"),o.vc(4,"Box/Piece"),o.Ob(),o.Pb(5,"th"),o.vc(6,"CTN/Bundle"),o.Ob(),o.Pb(7,"th"),o.vc(8,"Box/Piece"),o.Ob(),o.Ob())}function lr(e,t){if(1&e&&(o.Nb(0),o.Pb(1,"td"),o.vc(2),o.Zb(3,"number"),o.Ob(),o.Pb(4,"td"),o.vc(5),o.Ob(),o.Mb()),2&e){const e=t.$implicit;o.yb(2),o.wc(o.ac(3,2,e.parent_qty)),o.yb(3),o.wc(e.child_qty)}}function br(e,t){if(1&e&&(o.Pb(0,"tr"),o.Pb(1,"td"),o.vc(2),o.Ob(),o.Pb(3,"td"),o.vc(4),o.Ob(),o.tc(5,lr,6,4,"ng-container",117),o.Pb(6,"td"),o.vc(7),o.Zb(8,"number"),o.Ob(),o.Pb(9,"td"),o.vc(10),o.Zb(11,"number"),o.Ob(),o.Ob()),2&e){const e=t.$implicit;o.yb(2),o.wc(e.item_sku),o.yb(2),o.wc(e.item_name),o.yb(1),o.ec("ngForOf",e.content),o.yb(2),o.wc(o.ac(8,5,e.total_primary_qty)),o.yb(3),o.wc(o.ac(11,7,e.total_secondary_qty))}}function ur(e,t){if(1&e&&(o.Pb(0,"table",120),o.Pb(1,"thead"),o.Pb(2,"tr"),o.Pb(3,"th",121),o.vc(4,"SN"),o.Ob(),o.Pb(5,"th",121),o.vc(6," Product Name "),o.Ob(),o.tc(7,or,2,1,"th",122),o.Pb(8,"th",123),o.vc(9," Total Issuance "),o.Ob(),o.Ob(),o.tc(10,sr,17,0,"tr",124),o.tc(11,dr,13,0,"tr",124),o.tc(12,cr,9,0,"tr",124),o.Ob(),o.Pb(13,"tbody"),o.tc(14,br,12,9,"tr",117),o.Ob(),o.Ob()),2&e){const e=o.Yb();o.ec("dtOptions",e.dtOptions),o.yb(7),o.ec("ngForOf",e.finalLoad.load[0].content),o.yb(3),o.ec("ngIf",3==e.finalLoad.count),o.yb(1),o.ec("ngIf",2==e.finalLoad.count),o.yb(1),o.ec("ngIf",1==e.finalLoad.count),o.yb(2),o.ec("ngForOf",e.finalLoad.load)}}function pr(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",140),o.Wb("click",(function(){return o.oc(e),o.Yb(2).revertDispatch()})),o.vc(1," Reset "),o.Ob()}}function hr(e,t){1&e&&(o.Pb(0,"button",141),o.Pb(1,"div",80),o.Pb(2,"span",81),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}function mr(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",142),o.Wb("click",(function(){return o.oc(e),o.Yb(2).completeDispatch()})),o.vc(1," Complete "),o.Ob()}}function gr(e,t){1&e&&(o.Pb(0,"button",143),o.Pb(1,"div",80),o.Pb(2,"span",81),o.vc(3,"Loading..."),o.Ob(),o.Ob(),o.Ob())}function vr(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",125),o.Pb(1,"div",126),o.Pb(2,"div",127),o.Pb(3,"strong"),o.vc(4,"Gross Total:"),o.Ob(),o.Pb(5,"span"),o.vc(6),o.Zb(7,"number"),o.Ob(),o.Ob(),o.Pb(8,"div",127),o.Pb(9,"strong"),o.vc(10,"Trade Offer:"),o.Ob(),o.Pb(11,"span"),o.vc(12),o.Zb(13,"number"),o.Ob(),o.Ob(),o.Pb(14,"div",127),o.Pb(15,"strong"),o.vc(16,"Trade Discount:"),o.Ob(),o.Pb(17,"span"),o.vc(18),o.Zb(19,"number"),o.Ob(),o.Ob(),o.Pb(20,"div",127),o.Pb(21,"strong"),o.vc(22,"Special Discount:"),o.Ob(),o.Pb(23,"span"),o.vc(24),o.Zb(25,"number"),o.Ob(),o.Ob(),o.Pb(26,"div",127),o.Pb(27,"strong"),o.vc(28,"Booker Discount:"),o.Ob(),o.Pb(29,"span"),o.vc(30),o.Zb(31,"number"),o.Ob(),o.Ob(),o.Pb(32,"div",127),o.Pb(33,"strong"),o.vc(34,"Total:"),o.Ob(),o.Pb(35,"span"),o.vc(36),o.Zb(37,"number"),o.Ob(),o.Ob(),o.Pb(38,"div",127),o.Pb(39,"strong"),o.vc(40,"Tax:"),o.Ob(),o.Pb(41,"span"),o.vc(42),o.Zb(43,"number"),o.Ob(),o.Ob(),o.Pb(44,"div",128),o.Pb(45,"strong"),o.vc(46,"Total Amount Due:"),o.Ob(),o.Pb(47,"span"),o.vc(48),o.Zb(49,"number"),o.Ob(),o.Ob(),o.Pb(50,"div",127),o.Pb(51,"strong"),o.vc(52,"Recovery:"),o.Ob(),o.Pb(53,"span"),o.vc(54),o.Zb(55,"number"),o.Ob(),o.Ob(),o.Pb(56,"div",128),o.Pb(57,"strong"),o.vc(58,"Total Issued Amount:"),o.Ob(),o.Pb(59,"span"),o.vc(60),o.Zb(61,"number"),o.Ob(),o.Ob(),o.Ob(),o.Pb(62,"div",129),o.Pb(63,"div",130),o.Pb(64,"div",61),o.Pb(65,"a",131),o.Wb("click",(function(){return o.oc(e),o.Yb().getBookingSheet()})),o.Kb(66,"i",132),o.vc(67," Booking Sheet"),o.Ob(),o.Ob(),o.Pb(68,"div",61),o.Pb(69,"a",131),o.Wb("click",(function(){return o.oc(e),o.Yb().generateLSPDF()})),o.Kb(70,"i",132),o.vc(71," Load Sheet"),o.Ob(),o.Ob(),o.Pb(72,"div",61),o.Pb(73,"button",133),o.Kb(74,"i",132),o.vc(75," Bills "),o.Ob(),o.Ob(),o.Pb(76,"div",134),o.tc(77,pr,2,0,"button",135),o.tc(78,hr,4,0,"button",136),o.Ob(),o.Pb(79,"div",137),o.tc(80,mr,2,0,"button",138),o.tc(81,gr,4,0,"button",139),o.Ob(),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(6),o.wc(o.bc(7,14,e.finalLoad.summary.total_gross_amount,"1.2-2")),o.yb(6),o.wc(o.bc(13,17,e.finalLoad.summary.total_trade_offer,"1.2-2")),o.yb(6),o.wc(o.bc(19,20,e.finalLoad.summary.total_trade_discount,"1.2-2")),o.yb(6),o.wc(o.bc(25,23,e.finalLoad.summary.total_special_discount,"1.2-2")),o.yb(6),o.wc(o.bc(31,26,e.finalLoad.summary.total_booker_discount,"1.2-2")),o.yb(6),o.wc(o.bc(37,29,e.finalLoad.summary.total_gross_amount-e.finalLoad.summary.total_trade_offer-e.finalLoad.summary.total_trade_discount-e.finalLoad.summary.total_special_discount-e.finalLoad.summary.total_booker_discount,"1.2-2")),o.yb(6),o.wc(o.bc(43,32,e.finalLoad.summary.total_tax_amount,"1.2-2")),o.yb(6),o.wc(o.bc(49,35,e.finalLoad.summary.total_net_sale,"1.2-2")),o.yb(6),o.wc(o.bc(55,38,e.finalLoad.summary.total_recovery_amount,"1.2-2")),o.yb(6),o.wc(o.bc(61,41,e.finalLoad.summary.issued_total_price,"1.2-2")),o.yb(17),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading),o.yb(2),o.ec("ngIf",!e.loading),o.yb(1),o.ec("ngIf",e.loading)}}function Or(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",149),o.Wb("click",(function(){o.oc(e);const t=o.Yb(2);return t.currentTab=t.currentTab+1,t.tabChanged()})),o.vc(1," Next "),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("disabled",4===e.currentTab||e.loading||e.loadingProduct||e.savingOrder)}}function Pr(e,t){if(1&e){const e=o.Qb();o.Pb(0,"button",149),o.Wb("click",(function(){return o.oc(e),o.Yb(2).openConfirmationModal()})),o.vc(1," Next "),o.Ob()}if(2&e){const e=o.Yb(2);o.ec("disabled",e.loading||e.loadingProduct)}}function _r(e,t){if(1&e){const e=o.Qb();o.Pb(0,"div",144),o.Pb(1,"div",145),o.Pb(2,"button",146),o.Wb("click",(function(){o.oc(e);const t=o.Yb();return t.currentTab=t.currentTab-1,t.tabChanged()})),o.vc(3," Previous "),o.Ob(),o.tc(4,Or,2,1,"button",147),o.tc(5,Pr,2,1,"button",147),o.Pb(6,"button",148),o.vc(7," Open Modal "),o.Ob(),o.Ob(),o.Ob()}if(2&e){const e=o.Yb();o.yb(2),o.ec("disabled",1===e.currentTab||4===e.currentTab||e.loading||e.savingOrder||e.load.content[0].items.length>0),o.yb(2),o.ec("ngIf",4!==e.currentTab&&3!==e.currentTab),o.yb(1),o.ec("ngIf",3===e.currentTab)}}const fr=[{path:"",component:s,children:[{path:"",pathMatch:"full",component:x},{path:"order-list-details/:employeeId/:date",pathMatch:"full",component:A},{path:"dispatch-orders",pathMatch:"full",component:E},{path:"dispatch/:assignId/:saleManId/:date",pathMatch:"full",component:(()=>{class e{constructor(e,t,i,r,n,a,o){this.router=e,this.route=t,this.toastService=i,this.dataService=r,this.storageService=n,this.dispatchService=a,this.orderService=o,this.orderDetails={},this.inventory=[],this.ordersRetailers=[],this.specialDiscounts=[],this.schemes=[],this.discountSlabs=[],this.credits=[],this.recoveryRetailers=[],this.remainingOrders=[],this.ordersDispList=[],this.distributorId=this.storageService.getItem("distributor").id,this.retailer_credit_Invoices=new Array}ngOnInit(){this.dtOptions={pagingType:"simple_numbers"},this.currentTab=1,this.setLoad(),this.setCurrentLoad(1),this.load.content.push(this.currentLoadContent),this.assignmentId=this.route.snapshot.paramMap.get("assignId")||null,this.salemanId=+this.route.snapshot.paramMap.get("saleManId")||null,this.orderDate=this.route.snapshot.paramMap.get("date"),this.salemanId&&this.orderDate&&this.assignmentId?(this.getProducts(),this.getSchemes()):(this.router.navigateByUrl("/orders/dispatch-orders"),this.toastService.showToaster({type:"error",message:"No order selected to dispatch!",title:"Dispatch Error:"}))}setLoad(){this.load={salesman_id:0,total_orders:0,total_gross_amount:0,total_trade_offer:0,total_trade_discount:0,total_special_discount:0,total_booker_discount:0,total_tax_amount:0,total_recovery_amount:0,total_net_sale:0,total_products:0,distributor_id:0,total_sub_loads:0,processed_date:"",content:[]}}setCurrentLoad(e){this.currentLoadContent={loadNumber:e,order_ids:[],total_products:0,total_orders:0,items:[]}}tabChanged(){switch(this.currentTab){case 1:this.savingOrder=!0,this.selectedRetailer=JSON.parse(JSON.stringify(null)),this.orderDetails.items=[],this.getDispatchDetails();break;case 2:this.dispatchOrderDetail=null,this.getDispatchOrdersDetail(),this.orderService.setLoadRetaillersRecovery(!0);break;case 3:this.setDataForLoad()}}getCreditTabData(){this.loading=!0,this.orderService.getCreditdatailsData(this.assignmentId).subscribe(e=>{this.retailer_credit_Invoices=[],this.retailer_credit_Invoices=X(e.data,this.retailer_credit_Invoices),this.loading=!1})}isNumber(e,t="charges"){return this.dataService.isNumber(e,t)}getDispatchDetails(){this.loading=!0,this.savingOrder=!1,this.showFinalLoad=!1,this.orderService.getDispatchDetailBySalemanAndDate(this.salemanId,this.assignmentId,this.orderDate).subscribe(e=>{this.loading=!1,200===e.status&&(e.data.loadSheet?(this.finalLoad=e.data.loadSheetData,this.currentTab=4,setTimeout(()=>{this.showFinalLoad=!0},500)):(this.ordersRetailers=e.data.retailers.map(e=>(e.isActive=!1,e)),this.orderService.setOrderRetailers([...this.ordersRetailers])))},e=>{this.loading=!1,1!==e.status&&401!==e.status&&(console.log("Error while getting orders data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Orders. Please try again",title:"Error:"}))})}getDispatchOrdersDetail(){this.dispatchOrderDetail&&this.dispatchOrderDetail.summary||(this.loading=!0,this.orderService.getDispatchOrdersDetail(this.salemanId,this.orderDate,this.assignmentId).subscribe(e=>{this.loading=!1,200===e.status&&(this.dispatchOrderDetail=e.data,this.dispatchOrderDetail.orders=this.dispatchOrderDetail.orders.map(e=>{e.isAdded=!1,this.credits.find(t=>t.order_id===e.id&&t.recovery>0)&&(e.isAdded=!0);const{retailer_id:t}=e;return this.credits.push({recovery:0,order_id:e.id,retailer_id:t,dispatched_bill_amount:e.order_total}),e}),3===this.currentTab&&this.setDataForLoad())},e=>{this.loading=!1,1!==e.status&&401!==e.status&&(console.log("Error while getting orders data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Orders. Please try again",title:"Error:"}))}))}setDataForLoad(){var e,t;(null===(e=this.dispatchOrderDetail)||void 0===e?void 0:e.orders)?(this.remainingOrders=JSON.parse(JSON.stringify(null===(t=this.dispatchOrderDetail)||void 0===t?void 0:t.orders)),this.ordersDispList=JSON.parse(JSON.stringify(this.remainingOrders))):this.getDispatchOrdersDetail()}getProducts(){this.loadingProduct=!0,this.orderService.getCounterSaleData().subscribe(e=>{this.loadingProduct=!1,200===e.status&&(this.inventory=e.data.inventory,this.specialDiscounts=e.data.special_discount,this.getDispatchDetails())},e=>{this.loadingProduct=!1,1!==e.status&&401!==e.status&&(console.log("Error while getting products data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Products. Please try again",title:"Error:"}))})}getSchemes(){this.orderService.getSchemes().subscribe(e=>{200===e.status?this.schemes=e.data:this.toastService.showToaster({type:"error",message:e.message,title:"Error:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Cannot fetch Trade Offers. Please try again",title:"Error:"})})}getOrderDetailsByRetailer(e){var t;(null===(t=this.selectedRetailer)||void 0===t?void 0:t.id)!==e.id&&(this.savingOrder=!0,this.newProduct=null,this.selectedRetailer=JSON.parse(JSON.stringify(e)),this.orderService.getOrderDetails(e.id).subscribe(e=>{this.savingOrder=!1,200===e.status&&(this.orderDetails=e.data,this.orderDetails.items=this.orderDetails.items.map(e=>{const t=this.inventory.find(t=>t.item_id===e.item_id);return e.item_trade_price=JSON.parse(JSON.stringify(t.item_trade_price)),e.parent_trade_price=JSON.parse(JSON.stringify(t.parent_trade_price)),e.parent_unit_id=JSON.parse(JSON.stringify(t.parent_unit_id)),e.parent_quantity=JSON.parse(JSON.stringify(t.quantity)),e.child=JSON.parse(JSON.stringify(t.child)),e.item_retail_price=JSON.parse(JSON.stringify(t.item_retail_price)),e.extra_discount=JSON.parse(JSON.stringify(e.booker_discount)),e.tax_class_amount=JSON.parse(JSON.stringify(t.tax_class_amount)),e.tax_class_id=JSON.parse(JSON.stringify(t.tax_class_id)),e.tax_class_type=JSON.parse(JSON.stringify(t.tax_class_type)),e.pref_id=JSON.parse(JSON.stringify(t.pref_id)),e.unit_id=JSON.parse(JSON.stringify(t.unit_id)),e.unit_name=JSON.parse(JSON.stringify(t.unit_name)),e.brand_id=JSON.parse(JSON.stringify(t.brand_id)),e.is_active=JSON.parse(JSON.stringify(t.is_active)),e.stockQty=JSON.parse(JSON.stringify(e.dispatch_qty)),e.net_amount=JSON.parse(JSON.stringify(e.final_price)),e.gross_amount=e.unit_price_after_scheme_discount*e.stockQty,e.extra_discount_pkr=e.stockQty*e.extra_discount,e.original_amount=e.item_trade_price*e.stockQty,e.special_discount_pkr=e.special_discount,e.trade_discount=JSON.parse(JSON.stringify(e.merchant_discount)),e.trade_discount_pkr=JSON.parse(JSON.stringify(e.merchant_discount_pkr)),e.tax_amount_pkr=JSON.parse(JSON.stringify(e.total_tax_amount||0)),e.selectedScheme=this.schemes.find(t=>t.id===e.scheme_id),e}))},e=>{this.savingOrder=!1,this.loading=!1,1!==e.status&&401!==e.status&&(console.log("Error while getting order detail data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Order Detail. Please try again",title:"Error:"}))}),this.getDiscountSlabs())}addNewProductToOrder(e){this.newProduct=e}getDiscountSlabs(){this.discountSlabs.length?this.setMerchantDiscount():this.orderService.getDiscountSlabs().subscribe(e=>{200===e.status&&(this.discountSlabs=e.data,this.setMerchantDiscount())},e=>{1!==e.status&&401!==e.status&&(console.log("Error while getting order detail data :>> ",e.message),this.toastService.showToaster({type:"error",message:"Cannot fetch Merchant Discounts. Please try again",title:"Error:"}))})}setMerchantDiscount(){this.merchantDiscount=this.discountSlabs.find(e=>e.region_id===this.selectedRetailer.region_id&&this.selectedRetailer.segment_id===e.segment_id&&e.channel_id===this.selectedRetailer.retailer_type_id)}openProductsList(){this.showProducts=!0,document.body.classList.add("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.add("d-block"),document.getElementById("order-contaienr").classList.add("blur-div")}closeNewProducts(){this.showProducts=!1,document.body.classList.remove("no-scroll"),document.getElementsByClassName("overlay-blure")[0].classList.remove("d-block"),document.getElementById("order-contaienr").classList.remove("blur-div")}saveOrder(){this.savingOrder=!0,console.log("this.orderDetails :>> ",this.orderDetails),this.orderService.saveDispatchQuantityOrder(this.orderDetails).subscribe(e=>{this.newProduct=null,this.savingOrder=!1,200===e.status&&this.toastService.showToaster({message:`Order for ${this.selectedRetailer.retailer_name.toUpperCase()} dispatched successfully!`,title:"Order dispatched:",type:"success"}),this.orderDetails.items=[],this.selectedRetailer.isActive=!1,this.ordersRetailers.find(e=>e.id===this.selectedRetailer.id).isActive=!1,this.selectedRetailer=JSON.parse(JSON.stringify(null))},e=>{this.savingOrder=!1,1!==e.status&&401!==e.status&&(console.log("Error in Save Order for dispatch ::>> ",e),this.toastService.showToaster({message:"Something went wrong dispatch cannot be save at the moment!",title:"Error:",type:"error"}))})}setOrderItems(){this.orderDetails.items=this.orderDetails.items.map(e=>{var t,i,r,n,a;return{id:e.id||0,employee_id:this.orderDetails.employee_id,pref_id:e.pref_id,item_quantity_booker:e.item_quantity_booker,item_quantity_updated:e.item_quantity_updated||0,quantity_returned:0,original_price:e.item_trade_price,scheme_discount:e.scheme_discount,unit_price_after_scheme_discount:e.unit_price_after_scheme_discount,merchant_discount:e.trade_discount,merchant_discount_pkr:e.trade_discount_pkr,unit_price_after_merchant_discount:e.unit_price_after_merchant_discount,special_discount:e.special_discount,unit_price_after_special_discount:e.unit_price_after_special_discount,booker_discount:e.extra_discount,unit_price_after_individual_discount:e.unit_price_after_individual_discount||e.price,unit_id:e.unit_id,unit_name:e.unit_name,brand_id:e.brand_id,item_id:e.item_id,item_name:e.item_name,scheme_id:(null===(t=e.selectedScheme)||void 0===t?void 0:t.id)||0,scheme_min_quantity:(null===(i=e.selectedScheme)||void 0===i?void 0:i.min_qty)||0,scheme_quantity_free:(null===(r=e.selectedScheme)||void 0===r?void 0:r.quantity_free)||0,scheme_rule:(null===(n=e.selectedScheme)||void 0===n?void 0:n.rule_name)||"",gift_value:e.gift_value||0,parent_pref_id:e.child,parent_unit_id:e.parent_unit_id,parent_brand_id:e.brand_id,parent_tp:e.parent_trade_price,parent_qty_sold:e.parent_qty_sold,parent_value_sold:e.net_amount,final_price:e.net_amount,campaign_id:(null===(a=e.selectedScheme)||void 0===a?void 0:a.id)||0,item_status:e.is_active,dispatch_status:2,dispatch_qty:+e.stockQty,dispatch_amount:e.net_amount,reasoning:"",distributor_id:this.orderDetails.distributor_id,division_id:this.selectedRetailer.division_id||0,region_id:this.orderDetails.region_id,area_id:this.orderDetails.area_id,assigned_route_id:this.orderDetails.assigned_route_id,territory_id:this.orderDetails.territory_id,booked_order_value:e.booked_order_value||0,booked_total_qty:e.booked_total_qty||0,is_deleted:e.isDeleted,quantity:+e.stockQty,gross_sale_amount:e.original_amount,total_retail_price:e.item_retail_price*e.stockQty,tax_class_id:e.tax_class_id,tax_in_percentage:e.tax_class_amount,tax_in_value:e.tax_amount_value||0,total_tax_amount:e.tax_amount_pkr||0,total_amount_after_tax:e.net_amount,total_discount:+e.stockQty*e.scheme_discount+ +e.stockQty*e.trade_discount_pkr+ +e.stockQty*e.special_discount+e.extra_discount_pkr,order_id:this.orderDetails.id}}),this.saveOrder()}cancelOrder(){document.getElementById("close-del").click(),this.savingOrder=!0,this.orderService.cancelOrder(this.orderDetails.id).subscribe(e=>{this.savingOrder=!1,200===e.status&&(this.toastService.showToaster({message:`Order for ${this.selectedRetailer.retailer_name.toUpperCase()} canceled!`,title:"Order dispatched:",type:"success"}),this.orderDetails.items=[],this.ordersRetailers=this.ordersRetailers.filter(e=>e.id!==this.selectedRetailer.id),this.selectedRetailer=null,this.getDispatchDetails())},e=>{this.savingOrder=!1,1!==e.status&&401!==e.status&&(console.log("Error in Save Order for dispatch ::>> ",e),this.toastService.showToaster({message:"Something went wrong order cannot be canceled at the moment!",title:"Error:",type:"error"}))})}addOrderBill(e,t){const i=this.retailer_credit_Invoices[e];if(t){const e=te(i.id);this.orderService.postRetailersCreditInvoices(e).subscribe(e=>{this.getCreditTabData(),this.toastService.showToaster({type:"success",message:"Remove Successfully",title:"Success:"})})}else{const t=this.ordersRetailers.find(e=>e.retailer_id===i.retailer_id).id,r=ie(i,t,this.assignmentId);this.orderService.postRetailersCreditInvoices(r).subscribe(t=>{console.log("postRetailersCreditInvoices => ",t.result),this.retailer_credit_Invoices[e].id=t.result.id,this.retailer_credit_Invoices[e].is_added=1,this.toastService.showToaster({type:"success",message:"Added Successfully",title:"Success:"})})}}removeOrderBill(e){e.isAdded=!1,e.recovery=0}searchByRetailer(){this.ordersDispList=this.searchText?this.remainingOrders.filter(e=>e.retailer_name.toLowerCase().includes(this.searchText.toLowerCase())):JSON.parse(JSON.stringify(this.remainingOrders))}openConfirmationModal(){if(this.currentLoadValidation()){const e=this.dispatchOrderDetail.orders.filter(e=>!e.isSelected);if(3===this.load.content.length&&0!==e.length)return void this.toastService.showToaster({type:"error",title:"Select All Orders:",message:"Some orders are not selected"});3!==this.load.content.length&&0!==e.length?this.currentLoadContent.items.length?document.getElementById("open-create-load").click():this.toastService.showToaster({type:"error",title:"Select Orders:",message:"Select orders to create load"}):this.saveDispatch()}}saveDispatch(){this.loading=!0;let e=0;this.credits.map(t=>{e=t.recovery+e});let t=0;this.load.content.map(e=>{t=e.total_products+t}),this.load.content=this.load.content.map(e=>(delete e.loadNumber,e)),this.load.salesman_id=this.salemanId,this.load.total_orders=this.dispatchOrderDetail.orders.length,this.load.total_gross_amount=this.dispatchOrderDetail.summary.gross_total||0,this.load.total_trade_offer=this.dispatchOrderDetail.summary.trade_offer,this.load.total_trade_discount=this.dispatchOrderDetail.summary.trade_discount,this.load.total_special_discount=this.dispatchOrderDetail.summary.special_discount,this.load.total_booker_discount=this.dispatchOrderDetail.summary.booker_discount,this.load.total_tax_amount=this.dispatchOrderDetail.summary.total_tax||0,this.load.total_recovery_amount=e,this.load.total_net_sale=this.dispatchOrderDetail.summary.total_price,this.load.total_products=t,this.load.distributor_id=this.distributorId,this.load.total_sub_loads=this.load.content.length,this.load.processed_date=this.orderDate,this.load.assignmentId=this.assignmentId;const i={load:this.load,payments:this.credits};this.showFinalLoad=!1,this.orderService.saveDispatchOrder(i).subscribe(e=>{200===e.status&&(this.finalLoad=e.data,setTimeout(()=>{this.loading=!1,this.showFinalLoad=!0},500),this.dispatchOrderDetail=null,this.ordersDispList=[],this.remainingOrders=[],this.isAllSelected=!1,this.setLoad(),this.setCurrentLoad(1),this.load.content.push(this.currentLoadContent),this.toastService.showToaster({type:"success",message:"Payments and Load saved successfully!",title:"Payments and Load saved:"}),this.currentTab=4,this.tabChanged())},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Payments and Load not saved, please try again later!",title:"Error:"})})}currentLoadValidation(){return!!this.currentLoadContent.items.length||(this.toastService.showToaster({title:"Load Error:",message:"Please select orders to add into current load",type:"error"}),!1)}changeCurrentLoad(e){var t;if(this.currentLoadValidation()){this.remainingOrders=this.dispatchOrderDetail.orders.filter(e=>!e.isSelected),this.currentLoadContent=this.load.content.find(t=>t.loadNumber===e);const i=null===(t=this.dispatchOrderDetail)||void 0===t?void 0:t.orders.filter(e=>{if(this.currentLoadContent.order_ids.includes(e.id))return e.isSelected=!0,e});i.length&&(this.remainingOrders=[...i,...this.remainingOrders]),this.ordersDispList=JSON.parse(JSON.stringify(this.remainingOrders))}}updateDispatchedQty(e){+e.issued_qty>1e3&&(e.issued_qty=0),e.dispatched_qty=+e.issued_qty+e.actual_qty}allSelected(){this.isAllSelected?(this.remainingOrders=this.remainingOrders.map(e=>(e.isSelected=!0,e)),this.setAllOrdersToCurrentLoad()):(this.remainingOrders=this.remainingOrders.map(e=>(e.isSelected=!1,e)),this.removeAllOrdersFromCurrentLoad()),this.ordersDispList=JSON.parse(JSON.stringify(this.remainingOrders))}setAllOrdersToCurrentLoad(){this.currentLoadContent.items=[],this.remainingOrders.forEach(e=>{this.dispatchOrderDetail.orders=this.dispatchOrderDetail.orders.map(t=>(e.id===t.id&&(t.isSelected=!0),t)),this.currentLoadContent=this.dispatchService.setLoadContent(e,this.currentLoadContent)})}getItemName(e){return this.inventory.find(t=>t.item_id===e).item_name}addCurrentLoad(){this.remainingOrders=this.remainingOrders.filter(e=>!this.currentLoadContent.order_ids.includes(e.id)),this.ordersDispList=JSON.parse(JSON.stringify(this.remainingOrders)),this.setCurrentLoad(this.load.content.length+1),this.load.content.push(this.currentLoadContent),3===this.currentLoadContent.loadNumber&&(this.isAllSelected=!0,this.allSelected()),document.getElementById("close-confirm-load").click()}removeAllOrdersFromCurrentLoad(){this.currentLoadContent.items=[],this.dispatchOrderDetail.orders=this.dispatchOrderDetail.orders.map(e=>(this.currentLoadContent.order_ids.includes(e.id)&&(e.isSelected=!1),e)),this.currentLoadContent.order_ids=[],this.currentLoadContent.total_orders=0,this.currentLoadContent.total_products=0}retailerSelected(e){e.isSelected?(this.currentLoadContent=this.dispatchService.setLoadContent(e,this.currentLoadContent),this.dispatchOrderDetail.orders=this.dispatchOrderDetail.orders.map(t=>(e.id===t.id&&(t.isSelected=!0),t))):(this.isAllSelected=!1,this.currentLoadContent=this.dispatchService.removeOrderFromCurrentLoad(e,this.currentLoadContent),this.dispatchOrderDetail.orders=this.dispatchOrderDetail.orders.map(t=>(e.id===t.id&&(t.isSelected=!1),t))),this.remainingOrders=this.remainingOrders.map(t=>(t.id===e.id&&(t.isSelected=e.isSelected),t)),this.ordersDispList=JSON.parse(JSON.stringify(this.remainingOrders))}completeDispatch(){this.loading=!0,this.orderService.completeOrderDispatch(this.finalLoad.load_id).subscribe(e=>{this.loading=!1,this.toastService.showToaster({type:"success",message:"Order dispatch completed successfully!",title:"Order Dipatched Completed:"}),this.router.navigateByUrl("/orders/dispatch-orders")},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Order Dispatch cannot be completed at the moment, please try again later!",title:"Error:"})})}revertDispatch(){this.loading=!0,this.orderService.revertOrderDispatch(this.finalLoad.load_id).subscribe(e=>{this.loading=!1,this.toastService.showToaster({type:"success",message:"Order dispatch reverted successfully!",title:"Dipatch Reverted:"}),this.currentTab=1,this.credits=[],this.dispatchOrderDetail=null,this.ordersDispList=[],this.isAllSelected=!1,this.tabChanged()},e=>{this.loading=!1,1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Revert cannot be completed at the moment, please try again later!",title:"Error:"})})}getBookingSheet(){window.open(`${L.a.apiDomain}${R.a.BOOKING_SHEET_PDF}?emp=${this.salemanId}&date=${this.orderDate}&loadId=${this.finalLoad.load_id}`)}getBills(e="A4"){this.invoiceDate?this.orderService.updateDispatchInvoiceDate(this.finalLoad.load_id,this.invoiceDate).subscribe(t=>{200===t.status?(document.getElementById("close-bills").click(),window.open(`${L.a.apiDomain}${R.a.BILLS}?type=bill&emp=${this.salemanId}&date=${this.orderDate}&dist_id=${this.distributorId}&size=${e}&status=processed&loadId=${this.finalLoad.load_id}`)):this.toastService.showToaster({type:"error",message:"Bill cannot be generated at the moment, please try again later!",title:"Bill cannot be generated:"})},e=>{1!==e.status&&401!==e.status&&this.toastService.showToaster({type:"error",message:"Bill cannot be generated at the moment, please try again later!",title:"Bill cannot be generated:"})}):this.toastService.showToaster({type:"error",message:"Please select invoice date to generate bill(s)!",title:"Please select invoice date:"})}generateLSPDF(){window.open(`${L.a.apiDomain}${R.a.LS_PDF}/${this.finalLoad.load_id}/${this.salemanId}/${this.orderDate}`)}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(a.f),o.Jb(a.a),o.Jb(l.a),o.Jb(d.a),o.Jb(J.a),o.Jb(Qi),o.Jb(c.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-dispatch-order"]],decls:126,vars:18,consts:[[3,"selectedRetailer","orderedProducts","loadingProducts","allProducts","productSchemes","productMerchantDiscount","specialDiscounts","drawerClosed","productSelected",4,"ngIf"],["id","order-del","tabindex","-1","role","dialog","aria-labelledby","orderLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","top-borderRed"],[1,"modal-header"],["id","orderLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"modal-footer","border-0"],["type","button",1,"btn","btn-primary",3,"click"],["type","submit","id","close-del","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],["id","billsModal","tabindex","-1","role","dialog","aria-labelledby","billsModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-content","top_border"],["id","billsModalLabel",1,"modal-title"],["type","button","id","close-bills","data-dismiss","modal","aria-label","Close",1,"close"],[1,"row"],[1,"col-auto",2,"padding-top","6px","font-size","14px"],[1,"col"],["type","date","id","invoice-date","name","invoice-date","placeholder","",1,"form-control","select-date",3,"ngModel","ngModelChange"],[1,"col-12"],[1,"heading3"],[1,"row","print-icon-div","pb-0"],[1,"col-6","pl-0"],[3,"click"],["src","assets/images/a4.svg","alt","",1,"print-icon"],[1,"col-6","pr-0"],["src","assets/images/a5.svg","alt","",1,"print-icon"],["id","create-load","tabindex","-1","role","dialog","aria-labelledby","create-loadLabel","aria-hidden","true",1,"modal","fade"],["id","create-loadLabel",1,"modal-title"],["type","submit","id","close-confirm-load","data-dismiss","modal","aria-label","Close",1,"btn","btn-cancel"],["id","order-contaienr",1,"container"],[1,"card","daily-operations"],["id","pills-tab","role","tablist",1,"nav","nav-pills","nav_M","mb-3"],[1,"nav-item"],["id","pills-home-tab",1,"nav-link",3,"ngClass"],[1,"wz-icon"],[1,"fa","fa-list-ul"],["id","pills-contact-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-dollar-sign"],["id","pills-load-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-truck"],["id","pills-final-tab",1,"nav-link",3,"ngClass"],[1,"fa","fa-check"],["id","pills-tabContent",1,"tab-content"],["id","pills-home","role","tabpanel","aria-labelledby","pills-home-tab",1,"tab-pane","tab_M","p-0","PT-15","fade",3,"ngClass"],[1,"row","m-0","grayTopborder"],["id","orderList-id",1,"col-4","p-0"],[3,"retailers","loading","retailerChanged"],[1,"col","p-0"],["class","rightHeight",4,"ngIf"],["class","col-md-12 bottom-act-btn",4,"ngIf"],["id","pills-contact","role","tabpanel","aria-labelledby","pills-contact-tab",1,"tab-pane","p-0","PT-20","tab_M","fade",3,"ngClass"],["id","pills-load","role","tabpanel","aria-labelledby","pills-load-tab",1,"tab-pane","tab_M","p-0","PT-15","fade",3,"ngClass"],["class","row m-0 grayTopborder",4,"ngIf"],["id","pills-final","role","tabpanel","aria-labelledby","pills-final-tab",1,"tab-pane","tab_M","p-0","PT-15","fade",3,"ngClass"],[1,"col-8","PB-30"],[1,"header","PT-10","PB-10","mb-15"],[1,"w-100"],["datatable","","class","table table-hover dt-responsive nowrap dc-table","id","example2","style","width: 100%",3,"dtOptions",4,"ngIf"],[1,"col-4"],["class","cash-report",4,"ngIf"],["class","col-md-12 pl-10 pr-10 text-center",4,"ngIf"],[3,"selectedRetailer","orderedProducts","loadingProducts","allProducts","productSchemes","productMerchantDiscount","specialDiscounts","drawerClosed","productSelected"],[1,"rightHeight"],[3,"orderDetail","schemes","selectedRetailer","orders","allProducts","specialDiscounts","merchantDiscount","newProduct","orderType","openDrawer",4,"ngIf"],["class","col-12",4,"ngIf"],["class","no-content",4,"ngIf"],[3,"orderDetail","schemes","selectedRetailer","orders","allProducts","specialDiscounts","merchantDiscount","newProduct","orderType","openDrawer"],[1,"no-content"],[1,"no-content-container",2,"margin","auto","display","table","text-align","center","color","#b7b7b7"],["src","assets/images/select order-icon.svg","alt",""],[1,"col-md-12","bottom-act-btn"],["class","btn btn-primary mr-2 save_order_execution font13",3,"disabled","click",4,"ngIf"],["data-toggle","modal","data-target","#order-del","class","btn btn-cancel cancel_order_btn font13",3,"disabled",4,"ngIf"],["type","submit","class","btn btn-primary mr-2","disabled","",4,"ngIf"],[1,"btn","btn-primary","mr-2","save_order_execution","font13",3,"disabled","click"],["data-toggle","modal","data-target","#order-del",1,"btn","btn-cancel","cancel_order_btn","font13",3,"disabled"],["type","submit","disabled","",1,"btn","btn-primary","mr-2"],["role","status",1,"spinner-border","text-light"],[1,"sr-only"],["id","orderList-id2","class","col-4 p-0",4,"ngIf"],["class","col p-0",4,"ngIf"],["id","orderList-id2",1,"col-4","p-0"],[1,"_selectProList","ProListHeight"],[1,"header","ProListHD"],[1,"select-all-op"],[1,"custom-control","custom-checkbox"],["type","checkbox","name","all-selected","id","all-selected","id","all-s",1,"custom-control-input",3,"ngModel","ngModelChange","change"],["for","all-s",1,"custom-control-label"],[1,"APS-list"],[1,"fa","fa-search"],["type","text","id","","placeholder","Search",1,"form-control"],[1,"ProList-div"],["class","col-12 order-list select-checkmark",4,"ngFor","ngForOf"],[1,"col-12","order-list","select-checkmark"],[1,"ord-no"],[1,"col-8","pr-0"],[2,"margin-bottom","2px"],[1,"fa","fa-map-marker-alt"],[1,"col-4","pl-0"],["type","checkbox",1,"custom-control-input",3,"name","ngModel","id","change","ngModelChange"],[1,"custom-control-label",3,"for"],[1,"text-right"],[1,"or-val"],[1,"rightHeight","PT-5"],[1,"header-tabs"],["id","nav-tab","role","tablist",1,"nav","nav-tabs"],["class","nav-item nav-link","id","nav-load1-tab",3,"id","ngClass","click",4,"ngFor","ngForOf"],["id","nav-tabContent",1,"tab-content"],["id","nav-load1","role","tabpanel","aria-labelledby","nav-load1-tab",1,"tab-pane","fade","show","active","body_sales_agants"],[1,"col-12","retailerTable"],[1,"table","table-hover","dt-responsive","nowrap","th-boarder",2,"width","100%"],["rowspan","2"],["colspan","1",2,"text-align","center"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["id","nav-load1-tab",1,"nav-item","nav-link",3,"id","ngClass","click"],["type","number",1,"value_input",3,"ngModel","name","id","ngModelChange","keyup","keydown"],["datatable","","id","example2",1,"table","table-hover","dt-responsive","nowrap","dc-table",2,"width","100%",3,"dtOptions"],["rowspan","2",2,"vertical-align","middle"],["colspan","2","style","text-align: center",4,"ngFor","ngForOf"],["colspan","2",2,"text-align","center"],[4,"ngIf"],[1,"cash-report"],[1,"header"],[1,"report_value"],[1,"report_value",2,"color","#0038ba"],[2,"padding","10px 15px"],[1,"row","act-btn-print"],[1,"btn","btn-primary","print-btn","fontSize",3,"click"],[1,"fa","fa-print"],["data-toggle","modal","data-target","#billsModal",1,"btn","btn-primary","print-btn","fontSize"],[1,"col-6","pl-5","pt-5"],["class","btn btn-primary red-bg cancel_dispatch w-100",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary red-bg w-100 mr-2","disabled","",4,"ngIf"],[1,"col-6","pl-0","pr-5","pt-5"],["class","btn btn-primary m-0 nextButton w-100",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary w-100 mr-2","disabled","",4,"ngIf"],[1,"btn","btn-primary","red-bg","cancel_dispatch","w-100",3,"click"],["type","submit","disabled","",1,"btn","btn-primary","red-bg","w-100","mr-2"],[1,"btn","btn-primary","m-0","nextButton","w-100",3,"click"],["type","submit","disabled","",1,"btn","btn-primary","w-100","mr-2"],[1,"col-md-12","pl-10","pr-10","text-center"],[1,"execFooter"],["type","submit",1,"btn","btn-primary","m-0","mr-2",3,"disabled","click"],["type","submit","class","btn btn-primary m-0",3,"disabled","click",4,"ngIf"],["id","open-create-load","data-toggle","modal","data-target","#create-load",2,"display","none"],["type","submit",1,"btn","btn-primary","m-0",3,"disabled","click"]],template:function(e,t){1&e&&(o.tc(0,$i,1,7,"app-products-drawer",0),o.Pb(1,"div",1),o.Pb(2,"div",2),o.Pb(3,"div",3),o.Pb(4,"div",4),o.Pb(5,"h5",5),o.vc(6,"Cancel Order "),o.Kb(7,"span"),o.Ob(),o.Pb(8,"button",6),o.Pb(9,"span",7),o.vc(10,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(11,"div",8),o.Pb(12,"div",9),o.Pb(13,"p"),o.vc(14,"Are you sure you want to cancel the order?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(15,"div",10),o.Pb(16,"button",11),o.Wb("click",(function(){return t.cancelOrder()})),o.vc(17," Yes "),o.Ob(),o.Pb(18,"button",12),o.vc(19," No "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(20,"div",13),o.Pb(21,"div",2),o.Pb(22,"div",14),o.Pb(23,"div",4),o.Pb(24,"h5",15),o.vc(25," Please chose invoice date"),o.Kb(26,"span"),o.Ob(),o.Pb(27,"button",16),o.Pb(28,"span",7),o.vc(29,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(30,"div",8),o.Pb(31,"div",17),o.Pb(32,"div",18),o.vc(33," Select Date "),o.Ob(),o.Pb(34,"div",19),o.Pb(35,"input",20),o.Wb("ngModelChange",(function(e){return t.invoiceDate=e})),o.Ob(),o.Ob(),o.Pb(36,"div",21),o.Kb(37,"hr"),o.Ob(),o.Ob(),o.Pb(38,"div",17),o.Pb(39,"div",21),o.Pb(40,"h3",22),o.vc(41,"Select paper size for print"),o.Ob(),o.Ob(),o.Ob(),o.Pb(42,"div",23),o.Pb(43,"div",24),o.Pb(44,"a",25),o.Wb("click",(function(){return t.getBills("A4")})),o.Kb(45,"img",26),o.Pb(46,"strong"),o.vc(47,"A4 Portrait Paper"),o.Ob(),o.Ob(),o.Ob(),o.Pb(48,"div",27),o.Pb(49,"a",25),o.Wb("click",(function(){return t.getBills("A5")})),o.Kb(50,"img",28),o.Pb(51,"strong"),o.vc(52,"A5 Landscape Paper"),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(53,"div",29),o.Pb(54,"div",2),o.Pb(55,"div",3),o.Pb(56,"div",4),o.Pb(57,"h5",30),o.vc(58," Confirm Load "),o.Kb(59,"span"),o.Ob(),o.Pb(60,"button",6),o.Pb(61,"span",7),o.vc(62,"\xd7"),o.Ob(),o.Ob(),o.Ob(),o.Pb(63,"div",8),o.Pb(64,"div",9),o.Pb(65,"p"),o.vc(66,"Are you sure you want to create New Load?"),o.Ob(),o.Ob(),o.Ob(),o.Pb(67,"div",10),o.Pb(68,"button",11),o.Wb("click",(function(){return t.addCurrentLoad()})),o.vc(69," Yes "),o.Ob(),o.Pb(70,"button",31),o.vc(71," No "),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(72,"div",32),o.Pb(73,"div",17),o.Pb(74,"div",9),o.Pb(75,"div",33),o.Pb(76,"ul",34),o.Pb(77,"li",35),o.Pb(78,"a",36),o.Pb(79,"span"),o.vc(80,"Orders"),o.Ob(),o.Pb(81,"span",37),o.Kb(82,"i",38),o.Ob(),o.Ob(),o.Ob(),o.Pb(83,"li",35),o.Pb(84,"a",39),o.Pb(85,"span"),o.vc(86,"Credit"),o.Ob(),o.Pb(87,"span",37),o.Kb(88,"i",40),o.Ob(),o.Ob(),o.Ob(),o.Pb(89,"li",35),o.Pb(90,"a",41),o.Pb(91,"span"),o.vc(92,"Load"),o.Ob(),o.Pb(93,"span",37),o.Kb(94,"i",42),o.Ob(),o.Ob(),o.Ob(),o.Pb(95,"li",35),o.Pb(96,"a",43),o.Pb(97,"span"),o.vc(98,"Final"),o.Ob(),o.Pb(99,"span",37),o.Kb(100,"i",44),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Pb(101,"div",45),o.Pb(102,"div",46),o.Pb(103,"div",47),o.Pb(104,"div",48),o.Pb(105,"app-retailer-sub-list",49),o.Wb("retailerChanged",(function(e){return t.getOrderDetailsByRetailer(e)})),o.Ob(),o.Ob(),o.Pb(106,"div",50),o.tc(107,Vi,4,3,"div",51),o.tc(108,ji,4,3,"div",52),o.Ob(),o.Ob(),o.Ob(),o.Pb(109,"div",53),o.Kb(110,"app-retailer-recovery"),o.Ob(),o.Pb(111,"div",54),o.tc(112,ar,4,3,"div",55),o.Ob(),o.Pb(113,"div",56),o.Pb(114,"div",21),o.Pb(115,"div",17),o.Pb(116,"div",57),o.Pb(117,"div",58),o.Pb(118,"h2",59),o.vc(119,"Load "),o.Pb(120,"span"),o.vc(121," Sheet"),o.Ob(),o.Ob(),o.Ob(),o.tc(122,ur,15,6,"table",60),o.Ob(),o.Pb(123,"div",61),o.tc(124,vr,82,44,"div",62),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.tc(125,_r,8,3,"div",63),o.Ob(),o.Ob(),o.Ob(),o.Ob(),o.Ob()),2&e&&(o.ec("ngIf",t.showProducts),o.yb(35),o.ec("ngModel",t.invoiceDate),o.yb(43),o.ec("ngClass",1===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",2===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",3===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",4===t.currentTab?"active":""),o.yb(6),o.ec("ngClass",1===t.currentTab?"active show":""),o.yb(3),o.ec("retailers",t.ordersRetailers)("loading",t.loading||t.loadingProduct||t.savingOrder),o.yb(2),o.ec("ngIf",1===t.currentTab),o.yb(1),o.ec("ngIf",t.selectedRetailer),o.yb(1),o.ec("ngClass",2===t.currentTab?"active show":""),o.yb(2),o.ec("ngClass",3===t.currentTab?"active show":""),o.yb(1),o.ec("ngIf",3===t.currentTab),o.yb(1),o.ec("ngClass",4===t.currentTab?"active show":""),o.yb(9),o.ec("ngIf",t.showFinalLoad),o.yb(2),o.ec("ngIf",t.finalLoad),o.yb(1),o.ec("ngIf",4!==t.currentTab))},directives:[r.k,n.b,n.e,n.h,r.i,U.a,Oe,V.a,H.a,p.a,n.a,r.j,n.j,u.a],pipes:[r.d],styles:[".dispatch-order[_ngcontent-%COMP%]{padding:0!important}.dispatch-order[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:1220px}.dispatch-order[_ngcontent-%COMP%]{padding:0}.retailerTable[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px;border:1px solid #fff!important;vertical-align:middle;padding:2px 5px!important}.retailerTable[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px!important;padding:5px 4px!important;vertical-align:middle;line-height:1}#wrapper[_ngcontent-%COMP%]   #content-wrapper[_ngcontent-%COMP%]{padding-left:0!important}.container[_ngcontent-%COMP%]{max-width:1280px}.add-stock-input[_ngcontent-%COMP%]{font-size:13px;width:80px;height:25px;box-shadow:none;border-color:#ddd;padding:0 5px 0 8px}.CP-name[_ngcontent-%COMP%], .CP-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{letter-spacing:1px}.CP-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-top:4px}.ProList-div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:-2px;margin-bottom:-2px;margin-left:4px}._selectProList[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .add_button[_ngcontent-%COMP%]{padding:4px 8px 3px;right:15px}#orderList-id[_ngcontent-%COMP%], #orderList-id2[_ngcontent-%COMP%]{flex:0 0 300px;max-width:300px;width:300px}.value_input[_ngcontent-%COMP%]{padding:2px;margin:0!important;font-size:12px;box-shadow:none;height:22px;width:52px;border:1px solid #e2e6ea}.rightHeight[_ngcontent-%COMP%]{height:calc(100vh - 249px);overflow-y:auto}input[_ngcontent-%COMP%]::-webkit-inner-spin-button, input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.no-products[_ngcontent-%COMP%]{text-align:center;color:#d3d3d3}.daily-operations[_ngcontent-%COMP%]   .nav_M[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .daily-operations[_ngcontent-%COMP%]   .nav_M[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:15px}.cash-report[_ngcontent-%COMP%]{background-color:#f8f8f8;min-height:calc(100vh - 210px)}.cash-report[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background:linear-gradient(0deg,#f8f8f8,#f8f8f8 50%);padding:15px 20px}.cash-report[_ngcontent-%COMP%]   .report_value[_ngcontent-%COMP%]{background-color:#fff;font-size:13px;position:relative;padding:10px;letter-spacing:.5px;margin-bottom:5px;margin-top:5px;box-shadow:0 2px 8px 0 rgba(79,79,79,.1);line-height:1}.cash-report[_ngcontent-%COMP%]   .report_value[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Rationale,sans-serif;line-height:1;font-size:18px;float:right;margin-top:-2px}.totalcash[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px!important;color:#0038ba}.cash-report[_ngcontent-%COMP%]   .value_input[_ngcontent-%COMP%]{width:85px}.addsalesman[_ngcontent-%COMP%]{font-size:11px;width:100%;line-height:1;margin-top:5px}.return-btn[_ngcontent-%COMP%]{line-height:1;margin-top:10px}.add-expense[_ngcontent-%COMP%]{font-size:13px;padding:2px 10px;position:absolute;right:0}.red-bg[_ngcontent-%COMP%]{border:1px solid #f12300}.input-error[_ngcontent-%COMP%]{font-size:13px;color:red}.act-btn-print[_ngcontent-%COMP%]{margin:0}.act-btn-print[_ngcontent-%COMP%]   .col-4[_ngcontent-%COMP%]{padding:5px}.print-btn[_ngcontent-%COMP%]{font-size:14px;text-align:center;background:linear-gradient(90deg,#fff,#fff);color:#282828!important;border:1px solid #0038ba;box-shadow:none;padding:10px 14px;white-space:normal;width:100%;min-height:85px;line-height:16px}.print-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#1e54d3,#0038ba);color:#fff!important}.print-btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{display:block;font-size:16px;padding:5px;margin-bottom:5px}.select-checkmark[_ngcontent-%COMP%]   .salevalue[_ngcontent-%COMP%]{text-align:right;margin:auto;vertical-align:middle}.select-checkmark[_ngcontent-%COMP%]   .ord-no[_ngcontent-%COMP%]{top:14px;font-size:45px}.select-checkmark[_ngcontent-%COMP%]   .custom-control[_ngcontent-%COMP%]{text-align:right;margin-top:-15px;margin-right:-10px;margin-bottom:13px}.select-all-op[_ngcontent-%COMP%]{position:absolute;top:-3px;right:15px}.select-all-op[_ngcontent-%COMP%]   .custom-control-label[_ngcontent-%COMP%]{font-size:12px;line-height:2.2}.header-tabs[_ngcontent-%COMP%]{box-shadow:none}.header-tabs[_ngcontent-%COMP%], .header-tabs[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border-bottom:1px solid #e2e2e2}.header-tabs[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-item.show[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .header-tabs[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .header-tabs[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{padding:10px 26px;height:42px}.header-tabs[_ngcontent-%COMP%]   .add_button[_ngcontent-%COMP%]{letter-spacing:1px;padding:4px 15px;right:15px;box-shadow:none}.dc-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle;padding:4px 5px;border:1px solid #fff!important}.dc-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:5px 8px!important}.wz-icon[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{color:#fff}.th-boarder[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #fff!important;vertical-align:middle;padding:2px 5px!important}.daily-operations[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding-bottom:10px}.bottom-act-btn[_ngcontent-%COMP%]{text-align:right;padding-top:15px;padding-bottom:15px}.bottom-act-btn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{letter-spacing:1px;font-size:12px;padding:4px 12px;box-shadow:none}.execFooter[_ngcontent-%COMP%]{background:#f6f6f6;padding-top:10px;padding-bottom:10px;margin-top:5px}.cash-report[_ngcontent-%COMP%]   .value_input[_ngcontent-%COMP%]{float:right;width:95px}._selectProList[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:15px!important}.print-icon-div[_ngcontent-%COMP%], .print-icon-div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-align:center;padding:15px}.print-icon-div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;border:1px solid #e9ecef;width:100%;text-decoration:none;color:#282828;font-size:13px}.print-icon-div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:HOVER{border:1px solid #0038ba;color:#0038ba;box-shadow:0 0 20px 0 rgba(0,0,0,.3)}.print-icon[_ngcontent-%COMP%]{filter:grayscale(1);width:45px;opacity:.7;display:block;margin:10px auto 15px}.print-icon-div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:HOVER   .print-icon[_ngcontent-%COMP%]{filter:none;opacity:1}.heading3[_ngcontent-%COMP%]{margin:0;font-size:16px}.select-date[_ngcontent-%COMP%], .select-date[_ngcontent-%COMP%]:focus{box-shadow:none;border:none;background-color:#f6f6f6;font-size:14px;height:30px;width:200px}.no-content[_ngcontent-%COMP%]{width:100%;height:65vh;display:flex}.no-content[_ngcontent-%COMP%]   .no-content-container[_ngcontent-%COMP%]{margin:auto;display:table;text-align:center;color:#b7b7b7}.no-content[_ngcontent-%COMP%]   .no-content-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:70px;margin:auto auto 10px;display:block}"]}),e})()},{path:"execution-list",pathMatch:"full",component:z},{path:"execute-order/:saleManId/:date/:loadId",pathMatch:"full",component:Et},{path:"completed-orders",pathMatch:"full",component:Ki},{path:"completed-orders/:id",pathMatch:"full",component:Ki},{path:"counter-sale",pathMatch:"full",component:Bi},{path:"booking-vs-execution",pathMatch:"full",component:Yi}]}];let yr=(()=>{class e{}return e.\u0275mod=o.Hb({type:e}),e.\u0275inj=o.Gb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(fr)],a.i]}),e})();var xr=i("FpXt");let Sr=(()=>{class e{}return e.\u0275mod=o.Hb({type:e}),e.\u0275inj=o.Gb({factory:function(t){return new(t||e)},providers:[Qi,W,Z,c.a],imports:[[r.b,yr,n.c,Kt.b,b.b,xr.a,u.b]]}),e})()},njyG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var r=i("fXoL"),n=function(){function e(e,t,i){this.el=e,this.vcr=t,this.renderer=i,this.dtOptions={}}return e.prototype.ngOnInit=function(){var e=this;this.dtTrigger?this.dtTrigger.subscribe((function(){e.displayTable()})):this.displayTable()},e.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},e.prototype.displayTable=function(){var e=this,t=this;this.dtInstance=new Promise((function(i,r){Promise.resolve(e.dtOptions).then((function(r){setTimeout((function(){var n={rowCallback:function(i,n,a){if(r.columns){var o=r.columns;o.filter((function(e){return e.ngPipeInstance&&!e.ngTemplateRef})).forEach((function(e){var t=e.ngPipeInstance,r=o.findIndex((function(t){return t.data==e.data})),n=i.childNodes.item(r),a=$(n).text(),s=t.transform(a);$(n).text(s)})),o.filter((function(e){return e.ngTemplateRef&&!e.ngPipeInstance})).forEach((function(e){var r=e.ngTemplateRef,a=r.ref,s=r.context,d=o.findIndex((function(t){return t.data==e.data})),c=i.childNodes.item(d),l=Object.assign({},s,null==s?void 0:s.userData,{adtData:n}),b=t.vcr.createEmbeddedView(a,l);t.renderer.appendChild(c,b.rootNodes[0])}))}e.dtOptions.rowCallback&&e.dtOptions.rowCallback(i,n,a)}};n=Object.assign({},r,n),e.dt=$(e.el.nativeElement).DataTable(n),i(e.dt)}))}))}))},e.\u0275fac=function(t){return new(t||e)(r.Jb(r.l),r.Jb(r.P),r.Jb(r.D))},e.\u0275dir=r.Eb({type:e,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),e}(),a=i("ofXK"),o=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},imports:[[a.b]]}),e}()}}]);