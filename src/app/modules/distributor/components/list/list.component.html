<!-- Sub Distributor list -->

<div class="container mx-auto px-4 pb-24">
  <div class="mt-3 mb-3">
    <div class="flex justify-between items-center text-left">
      <div>
        <h1 class="text-lg text-secondary dark:text-gray-400 font-primary font-medium mb-0">
          Distributor <span class="font-light"> Management</span>
        </h1>
      </div>
      <div></div>
    </div>
  </div>

  <div
    class="bg-white dark:bg-black dark:border-[#333333] border p-0 rounded-lg relative shadow-[0_0_5px_#0000001a]">

    <div *ngIf="loading" class="flex justify-center items-center p-8">
      <app-loader-white></app-loader-white>
    </div>

    <div *ngIf="!loading">

      <div
      class="flex justify-between items-center text-secondary dark:border-[#333333] border-b rounded-tl-lg rounded-tr-lg text-base py-[10px] px-[15px] relative bg-gradient-to-t from-[#f9f9f9] to-[#ffffff] dark:bg-black dark:from-transparent dark:to-transparent shadow-none">
      <div>
        <h2
          class="relative flex items-start pl-0 mb-0 text-secondary dark:text-gray-400 before:content-[''] before:absolute before:w-[2px] before:h-[18px] before:bg-primary before:left-[-16px] before:top-[5px] font-primary font-medium">
          Sub Distributor &nbsp;<span class="font-light">List</span>
          <div class="ml-2 my-auto flex items-center">
            <span class="bg-primary text-white text-[9px] p-[4px] leading-[1] rounded font-primary">{{
              distributors.length }}</span>
          </div>
        </h2>
      </div>
      <div class="text-secondary dark:text-white">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="h-4 w-4 text-gray-400" width="16" height="16" viewBox="0 0 16 16" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M11.5014 7.00039C11.5014 7.59133 11.385 8.1765 11.1588 8.72246C10.9327 9.26843 10.6012 9.7645 10.1833 10.1824C9.76548 10.6002 9.2694 10.9317 8.72344 11.1578C8.17747 11.384 7.59231 11.5004 7.00136 11.5004C6.41041 11.5004 5.82525 11.384 5.27929 11.1578C4.73332 10.9317 4.23725 10.6002 3.81938 10.1824C3.40152 9.7645 3.07005 9.26843 2.8439 8.72246C2.61776 8.1765 2.50136 7.59133 2.50136 7.00039C2.50136 5.80691 2.97547 4.66232 3.81938 3.81841C4.6633 2.97449 5.80789 2.50039 7.00136 2.50039C8.19484 2.50039 9.33943 2.97449 10.1833 3.81841C11.0273 4.66232 11.5014 5.80691 11.5014 7.00039ZM10.6814 11.7404C9.47574 12.6764 7.95873 13.1177 6.43916 12.9745C4.91959 12.8314 3.51171 12.1145 2.50211 10.9698C1.49252 9.8251 0.957113 8.33868 1.0049 6.81314C1.05268 5.28759 1.68006 3.83759 2.75932 2.75834C3.83857 1.67908 5.28856 1.0517 6.81411 1.00392C8.33966 0.956136 9.82608 1.49154 10.9708 2.50114C12.1154 3.51073 12.8323 4.91862 12.9755 6.43819C13.1187 7.95775 12.6773 9.47476 11.7414 10.6804L14.5314 13.4704C14.605 13.539 14.6642 13.6218 14.7051 13.7138C14.7461 13.8058 14.7682 13.9052 14.77 14.0059C14.7717 14.1066 14.7532 14.2066 14.7155 14.3C14.6778 14.3934 14.6216 14.4782 14.5504 14.5494C14.4792 14.6206 14.3943 14.6768 14.301 14.7145C14.2076 14.7522 14.1075 14.7708 14.0068 14.769C13.9061 14.7672 13.8068 14.7452 13.7148 14.7042C13.6228 14.6632 13.54 14.6041 13.4714 14.5304L10.6814 11.7404Z"
                fill="currentColor"></path>
            </svg>
          </div>
          <input type="text" id="filter-text-box-header" placeholder="Search Distributors..." autocomplete="off"
            class="w-56 pl-[34px] pr-4 py-2 h-[32px] border outline-none border-gray-300 dark:border-[#333333] rounded-lg bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 dark:focus:border-primary focus:border-primary font-primary text-sm"
            (input)="onQuickFilterChanged($event)" />
        </div>
      </div>
    </div>

      <!-- AG Grid -->
      <div *ngIf="!loading" class="ag-theme-quartz ag-grid-container">
        <ag-grid-angular [rowData]="distributors" [columnDefs]="columnDefs" [defaultColDef]="defaultColDef"
          [pagination]="true" [paginationPageSize]="10" [paginationPageSizeSelector]="[10, 20, 50, 100]"
          [suppressPaginationPanel]="false" [domLayout]="'autoHeight'" [animateRows]="true"
          [rowSelection]="{ type: 'single' }" [theme]="'legacy'" (gridReady)="onGridReady($event)">
        </ag-grid-angular>
      </div>
    </div>
  </div>
</div>

<!-- Opening Balance Modal -->
<div
  *ngIf="showOpeningBalanceModal"
  class="fixed inset-0 z-50 overflow-y-auto"
  aria-labelledby="openingBalanceModalLabel"
  role="dialog"
  aria-modal="true"
>
  <!-- Background overlay -->
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 dark:bg-black/50 dark:backdrop-blur-sm transition-opacity" (click)="closeOpeningBalanceModal()"></div>
  
  <!-- Modal container -->
  <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
    <div class="relative transform overflow-hidden rounded-lg bg-white dark:bg-[#1f1f1f] text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
      <!-- Blue top border -->
      <div class="h-1 bg-primary"></div>
      
      <!-- Modal header -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4 border-b border-gray-200 dark:border-[#333333]">
        <div class="flex items-center justify-between">
          <h3 class="text-base font-semibold leading-6 text-gray-900 dark:text-neutral-200 font-primary" id="openingBalanceModalLabel">
            Opening Balance
          </h3>
          <button
            type="button"
            class="rounded-md bg-white dark:bg-[#1f1f1f] text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors"
            (click)="closeOpeningBalanceModal()"
            aria-label="Close"
          >
            <span class="sr-only">Close</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Modal body -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4">
        <form>
          <!-- Amount Type Radio Buttons -->
          <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              Amount Type <span class="text-red-500">*</span>
            </label>
            <div class="flex items-center gap-6">
              <label class="flex items-center cursor-pointer">
                <input
                  type="radio"
                  name="amountType"
                  value="debit"
                  [(ngModel)]="amountType"
                  class="w-4 h-4 text-primary border-gray-300 focus:ring-primary dark:border-gray-600 dark:bg-[#1a1a1a] dark:focus:ring-primary"
                />
                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Debit (In)</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="radio"
                  name="amountType"
                  value="credit"
                  [(ngModel)]="amountType"
                  class="w-4 h-4 text-primary border-gray-300 focus:ring-primary dark:border-gray-600 dark:bg-[#1a1a1a] dark:focus:ring-primary"
                />
                <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Credit (Out)</span>
              </label>
            </div>
          </div>

          <!-- Amount Input Field -->
          <div class="mb-4">
            <label for="amount" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              Amount <span class="text-red-500">*</span>
            </label>
            <input
              type="number"
              id="amount"
              name="amount"
              [(ngModel)]="amountInput"
              (input)="onAmountChange($any($event.target).value)"
              placeholder="Enter amount"
              min="0"
              step="0.01"
              class="w-full px-3 py-2 border border-gray-300 dark:border-[#333333] rounded-lg bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary font-primary text-sm"
            />
          </div>
        </form>
      </div>
      
      <!-- Modal footer -->
      <div class="bg-gray-50 dark:bg-[#1a1a1a] px-3 py-3 sm:px-5 sm:flex sm:flex-row-reverse gap-3 border-t border-gray-200 dark:border-[#333333]">
        <button
          type="button"
          class="inline-flex w-full justify-center rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary sm:w-auto"
          (click)="addOpeningBalance()"
        >
          Add
        </button>
        <button
          type="button"
          class="inline-flex w-full justify-center rounded-md bg-white dark:bg-[#1f1f1f] px-4 py-2 text-sm font-semibold text-gray-900 dark:text-gray-200 shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-[#333333] hover:bg-gray-50 dark:hover:bg-[#2a2a2a] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary sm:w-auto"
          (click)="closeOpeningBalanceModal()"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>