<div class="container mx-auto px-4" id="emp-list">
    <div class="mt-3 mb-3">
      <div class="flex justify-between items-center text-left">
        <div>
          <h1 class="text-lg text-secondary dark:text-gray-400 font-primary font-medium mb-0">
            Gallery <span class="font-light"></span>
          </h1>
        </div>
        <div>
         <!-- View Toggle -->
         <div class="flex ml-auto gap-1 border border-gray-300 dark:border-[#333333] rounded-lg p-[2px] bg-white dark:bg-[#1a1a1a]">
                <button
                    type="button"
                    [ngClass]="!showList ? 'bg-primary text-white' : 'text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary'"
                    (click)="toggleView(false)"
                    class="p-1 rounded transition-colors"
                    aria-label="Grid view">
                <svg class="w-[26px] h-[26px]" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grid-fill" viewBox="0 0 16 16">
                    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5z"/>
                </svg>
            </button>
                <button
                    type="button"
                    [ngClass]="showList ? 'bg-primary text-white' : 'text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary'"
                    (click)="toggleView(true)"
                    class="p-1 rounded transition-colors"
                    aria-label="List view">
                <svg class="w-[26px] h-[26px]" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"/>
                </svg>
            </button>
        </div>
        </div>
      </div>
    </div>

    <!-- Filter Bar -->
    <div class="p-2 border border-gray-200 dark:border-[#2b2b2b] bg-gray-50 dark:bg-[#141414] rounded-lg mb-3">
        <div class="flex flex-wrap items-center gap-1.5 xl:gap-2 text-[13px]">
            <!-- Search Input -->
            <div class="relative w-[230px] xl:w-[250px]">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10 text-gray-500 dark:text-neutral-400">
                    <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                    </svg>
                </div>
                <input 
                    nz-input
                    type="text" 
                    id="search-product" 
                    [(ngModel)]="searchText"
                    (keyup)="filterProducts()" 
                    (keydown)="resetTimer()" 
                    placeholder="Search"
                    class="w-full h-8 pl-10 pr-3 border border-gray-300 dark:border-[#333333] rounded-lg bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-primary dark:focus:border-primary font-primary text-sm"
                >
            </div>
            <div class="dark:text-gray-200">Brand:</div>
            <!-- Brand Filter -->
            <div class="w-[200px] xl:w-[220px]">
                <nz-select
                    nzShowSearch
                    nzAllowClear
                    [(ngModel)]="selectedBrand"
                    (ngModelChange)="filterProducts()"
                    nzPlaceHolder="All Brands"
                    [nzDropdownMatchSelectWidth]="false"
                    [nzDropdownStyle]="{ 'z-index': '9999' }"
                    class="w-full brand-select">
                    <nz-option
                        nzDisabled
                        nzLabel="All Brands"
                        [nzValue]="'All Brands'">
                    </nz-option>
                    <nz-option
                        *ngFor="let brand of brands"
                        [nzValue]="brand.name"
                        [nzLabel]="brand.name">
                    </nz-option>
                </nz-select>
            </div>
            <div class="dark:text-gray-200">Category:</div>
            <!-- Category Filter -->
            <div class="w-[200px] xl:w-[220px]">
                <nz-select
                    nzShowSearch
                    nzAllowClear
                    [(ngModel)]="selectedCategory"
                    (ngModelChange)="filterProducts()"
                    nzPlaceHolder="All Categories"
                    [nzDropdownMatchSelectWidth]="false"
                    [nzDropdownStyle]="{ 'z-index': '9999' }"
                    class="w-full category-select">
                    <nz-option
                        nzDisabled
                        nzLabel="All Categories"
                        [nzValue]="'All Categories'">
                    </nz-option>
                    <nz-option
                        *ngFor="let category of categories"
                        [nzValue]="category.sub_category_name"
                        [nzLabel]="category.sub_category_name">
                    </nz-option>
                </nz-select>
            </div>
            <div class="dark:text-gray-200">Sort By:</div>
            <!-- Sort Filter -->
            <div class="w-[150px] xl:w-[160px]">
                <nz-select
                    nzShowSearch
                    nzAllowClear
                    [(ngModel)]="sortFilter"
                    (ngModelChange)="sortProducts()"
                    nzPlaceHolder="Sort By Any"
                    [nzDropdownMatchSelectWidth]="false"
                    [nzDropdownStyle]="{ 'z-index': '9999' }"
                    class="w-full sort-select">
                    <nz-option
                        nzDisabled
                        nzLabel="Sort By Any"
                        [nzValue]="'0'">
                    </nz-option>
                    <nz-option
                        [nzValue]="'asc'"
                        nzLabel="Name (ASC)">
                    </nz-option>
                    <nz-option
                        [nzValue]="'desc'"
                        nzLabel="Name (DESC)">
                    </nz-option>
                    <nz-option
                        [nzValue]="'latest'"
                        nzLabel="Latest to Oldest">
                    </nz-option>
                    <nz-option
                        [nzValue]="'oldest'"
                        nzLabel="Oldest to Latest">
                    </nz-option>
                </nz-select>
            </div>
        </div>
    </div>

    <!-- Content Area -->
    <div class="container mx-auto">
        <div *ngIf="!loading">
            <!-- List View -->
            <div *ngIf="showList">
                <!-- Table Header -->
                <div *ngIf="productDispList && productDispList.length > 0" class="bg-gradient-to-t from-[#f9f9f9] to-[#ffffff] dark:from-transparent dark:to-transparent dark:bg-[#1a1a1a] border-b border-gray-200 dark:border-[#333333] px-4 py-3 mb-2 rounded-lg">
                    <div class="grid grid-cols-12 gap-4 text-xs uppercase text-primary dark:text-neutral-200 font-primary font-semibold tracking-wide">
                        <div class="col-span-1">S.No</div>
                        <div class="col-span-2">Item SKU</div>
                        <div class="col-span-6">Item Name</div>
                        <div class="col-span-3">Item Brand</div>
                    </div>
                </div>

                <!-- Product Cards List -->
                <div class="space-y-2.5" *ngIf="productDispList && productDispList.length > 0">
                    <a 
                        *ngFor="let product of productDispList"
                        [routerLink]="['/product/' + product.item_id]"
                        class="block bg-white dark:bg-[#1a1a1a] border border-gray-200 dark:border-[#333333] rounded-lg px-2 py-1.5 shadow-[0_0_5px_#0000001a] hover:shadow-[0_0_15px_#00000033] dark:hover:shadow-[0_0_15px_#ffffff1a] hover:border-primary dark:hover:border-neutral-400 transition-all duration-200 hover:scale-[1.01] cursor-pointer">
                        <div class="grid grid-cols-12 gap-4 items-center text-sm font-primary">
                            <!-- S.No -->
                            <div class="col-span-1 text-gray-700 dark:text-gray-300 font-medium">
                                {{product.item_id}}
                            </div>
                            
                            <!-- Item SKU -->
                            <div class="col-span-2 text-gray-700 dark:text-gray-300">
                                {{product.item_sku}}
                            </div>
                            
                            <!-- Item Name with Image -->
                            <div class="col-span-6 flex items-center gap-3">
                                <img 
                                    [src]="product.thumbnail"
                                    [alt]="product.item_name"
                                    class="w-8 h-8 object-cover border border-gray-200 dark:border-[#333333] rounded flex-shrink-0">
                                <span class="text-gray-900 dark:text-white font-medium">{{product.item_name}}</span>
                            </div>
                            
                            <!-- Item Brand -->
                            <div class="col-span-3 text-gray-700 dark:text-gray-300">
                                {{product.brand_name}}
                            </div>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Grid View -->
            <div *ngIf="!showList && productDispList && productDispList.length > 0" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4">
                <a 
                    *ngFor="let product of productDispList"
                    [routerLink]="['/product/' + product.item_id]"
                    class="group bg-white dark:bg-[#1a1a1a] border border-gray-200 dark:border-[#333333] rounded-lg p-4 shadow-[0_0_5px_#0000001a] hover:shadow-[0_0_15px_#00000033] dark:hover:shadow-[0_0_15px_#ffffff1a] transition-all duration-300 hover:scale-[1.02] relative">
                    <!-- Blue accent bar -->
                    <div class="absolute left-0 top-[20px] w-0.5 h-8 bg-primary"></div>
                    
                    <h2 class="text-sm font-primary font-medium text-gray-900 dark:text-white mb-4 line-clamp-2 min-h-[42px]">
                        {{product.item_name}}
                    </h2>
                    
                    <div class="flex items-center justify-center w-full">
                        <img 
                            [src]="product.thumbnail" 
                            [alt]="product.item_name"
                            class="w-full h-[259px] 2xl:h-[245px] object-cover custum-size rounded-lg">
                    </div>
                </a>
            </div>
           
            <!-- Empty State - No Products Found -->
            <div *ngIf="!loading && productDispList && productDispList.length === 0" class="border border-gray-200 dark:border-[#2b2b2b] rounded-lg flex flex-col h-[calc(100vh-31vh)] items-center justify-center">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="w-16 h-16 text-gray-300 dark:text-gray-600">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                </svg>
                <p class="mt-4 text-gray-500 dark:text-gray-400 font-primary text-center">No products found</p>
            </div>

            <!-- Pagination -->
            <div *ngIf="pageCount > 1 && !loading" class="flex justify-center items-center gap-1.5 mt-4 mb-2">
                <button
                    type="button"
                    [disabled]="pageNum === 1"
                    (click)="pageNum > 1 && getProductsByPageID(pageNum-1, $event)"
                    [ngClass]="{'opacity-50 cursor-not-allowed': pageNum === 1, 'hover:bg-gray-50 dark:hover:bg-[#2a2a2a]': pageNum > 1}"
                    class="px-3 py-1.5 text-[13px] font-primary border border-gray-300 dark:border-[#333333] rounded-[5px] bg-white dark:bg-[#1a1a1a] text-gray-700 dark:text-gray-300 transition-colors disabled:cursor-not-allowed">
                    Previous
                </button>

                <div class="flex gap-1.5">
                    <ng-container *ngFor="let page of getPaginationPages()">
                        <!-- Ellipsis Button -->
                        <button
                            *ngIf="page === 'ellipsis-start' || page === 'ellipsis-end'"
                            type="button"
                            disabled
                            class="px-3 py-1.5 text-[13px] font-primary border border-gray-300 dark:border-[#333333] rounded-[5px] bg-white dark:bg-[#1a1a1a] text-gray-500 dark:text-gray-400 cursor-default min-w-[35px]">
                            ...
                        </button>
                        
                        <!-- Page Number Button -->
                        <button
                            *ngIf="typeof page === 'number'"
                            type="button"
                            [ngClass]="{
                                'border-primary bg-primary text-white dark:bg-primary dark:text-white': page === pageNum,
                                'border-gray-300 dark:border-[#333333] bg-white dark:bg-[#1a1a1a] text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-[#2a2a2a]': page !== pageNum
                            }"
                            (click)="getProductsByPageID(page, $event)"
                            class="px-3 py-1.5 text-[13px] font-primary border rounded-[5px] transition-colors min-w-[35px] text-center">
                            {{page}}
                        </button>
                    </ng-container>
                </div>

                <button
                    type="button"
                    [disabled]="pageNum === pageCount"
                    (click)="pageNum < pageCount && getProductsByPageID(pageNum+1, $event)"
                    [ngClass]="{'opacity-50 cursor-not-allowed': pageNum === pageCount, 'hover:bg-gray-50 dark:hover:bg-[#2a2a2a]': pageNum < pageCount}"
                    class="px-4 py-1.5 text-[13px] font-primary border border-gray-300 dark:border-[#333333] rounded-[5px] bg-white dark:bg-[#1a1a1a] text-gray-700 dark:text-gray-300 transition-colors disabled:cursor-not-allowed">
                    Next
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="flex justify-center items-center p-8">
            <app-loader-white></app-loader-white>
        </div>

        <!-- Error State -->
        <div *ngIf="loadingError" class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-[5px] mt-4">
            <p class="text-red-800 dark:text-red-200 text-sm">
                Something went wrong, please check your internet connection and try again!
            </p>
        </div>
    </div>
</div>