<!-- Bills Modal -->
<div
  *ngIf="showBillsModal"
  class="fixed inset-0 z-50 overflow-y-auto"
  aria-labelledby="billsModalLabel"
  role="dialog"
  aria-modal="true"
>
  <!-- Background overlay -->
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 dark:bg-black/50 dark:backdrop-blur-sm transition-opacity" (click)="closeBillsModal()"></div>
  
  <!-- Modal container -->
  <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
    <div class="relative transform overflow-hidden rounded-lg bg-white dark:bg-[#1f1f1f] text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
      <!-- Modal header -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4 border-b border-gray-200 dark:border-[#333333]">
        <div class="flex items-center justify-between">
          <h3 class="text-base font-semibold leading-6 text-gray-900 dark:text-neutral-200 font-primary" id="billsModalLabel">
            Print bill for this order
          </h3>
          <button
            type="button"
            id="close-bills"
            class="rounded-md bg-white dark:bg-[#1f1f1f] text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors"
            (click)="closeBillsModal()"
            aria-label="Close"
          >
            <span class="sr-only">Close</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Modal body -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4">
        <div class="mb-4">
          <h3 class="text-lg font-medium text-gray-900 dark:text-neutral-200 font-primary">Select paper size for print</h3>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <button
            type="button"
            (click)="getBills('A4')"
            class="flex flex-col items-center justify-center p-4 border border-gray-300 dark:border-[#333333] rounded-lg hover:border-primary dark:hover:border-primary hover:bg-gray-50 dark:hover:bg-[#2a2a2a] transition-colors cursor-pointer">
            <img class="w-16 h-16 mb-2" src="assets/images/a4.svg" alt="A4">
            <strong class="text-sm text-gray-900 dark:text-white font-primary">A4 Portrait Paper</strong>
          </button>
          <button
            type="button"
            (click)="getBills('A5')"
            class="flex flex-col items-center justify-center p-4 border border-gray-300 dark:border-[#333333] rounded-lg hover:border-primary dark:hover:border-primary hover:bg-gray-50 dark:hover:bg-[#2a2a2a] transition-colors cursor-pointer">
            <img class="w-16 h-16 mb-2" src="assets/images/a5.svg" alt="A5">
            <strong class="text-sm text-gray-900 dark:text-white font-primary">A5 Landscape Paper</strong>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Order details Popup - Full Screen -->
<div *ngIf="showDetailsModal" class="fixed inset-0 z-[1100]">
  <!-- Full screen modal container -->
  <div class="w-full h-full bg-white dark:bg-gray-900 flex flex-col">
    <button
      type="button"
      class="absolute top-2 right-2 z-[1101] rounded-md bg-white dark:bg-black text-gray-500 hover:text-gray-800 dark:hover:text-white focus:outline-none focus:ring-primary"
      (click)="showDetailsModal = false;closeDetailsModal()"
      aria-label="Close"
    >
      <span class="sr-only">Close</span>
      <svg class="h-[28px] w-[28px]" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Modal body - Scrollable content -->
    <div class="bg-white dark:bg-black px-4 py-8 flex-1 overflow-y-auto">
      <div class="w-full h-full">
        <div class="container mx-auto px-4 max-w-7xl">
          <div *ngIf="!activeOrder || !orderDetail" class="flex justify-center items-center p-8">
            <app-loader-white></app-loader-white>
          </div>

          <div *ngIf="activeOrder && orderDetail" class="bg-white dark:bg-black dark:border-[#333333] border p-6 rounded-lg relative shadow-[0_0_5px_#0000001a] dark:shadow-[0_0_5px_#ffffff1a]">
            <div class="flex mb-5 pb-2 border-b border-gray-300 dark:border-[#333333] font-primary">
              <div class="w-2/3 flex items-center OrderLogo">
                <img src="assets/images/sell-360.svg" alt="" class="max-h-10 dark:hidden" />
                <img src="assets/images/logo-w.svg" alt="" class="max-h-10 hidden dark:block" />
              </div>
              <div class="w-1/3 text-right flex items-center justify-end text-gray-900 dark:text-white">
                Invoice# <strong class="ml-1 font-medium">{{ activeOrder?.invoice_number }}</strong>
              </div>
            </div>

            <div class="flex flex-wrap OrderInfo font-primary text-gray-900 dark:text-white mb-6">
              <!-- Left column -->
              <div class="w-full md:w-3/4 mb-2 md:mb-0">
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Retailer Name:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.shop_name}}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Segment:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{ activeOrder?.segment }}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Phone No:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.retailer_phone}}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Address:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.retailer_address}}</strong>
                </p>
              </div>

              <!-- Right column -->
              <div class="w-full md:w-1/4 md:p-0">
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Status:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.status}}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Date:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.date}}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Order Booker:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{activeOrder?.order_booker}}</strong>
                </p>
                <p>
                  <span class="text-gray-600 dark:text-gray-300">Salesman:</span>
                  <strong class="ml-1 font-medium dark:text-white">{{ activeOrder?.salesman }}</strong>
                </p>
              </div>
            </div>

            <div class="w-full Order-Detail-table mt-6">
              <table class="table font-primary w-full border-collapse">
                <thead>
                  <tr class="bg-black dark:bg-[#252525] text-white">
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">Code</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">Product Name</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">B.QTY.</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">D.QTY.</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">E.QTY.</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">T.P</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">GR.AMNT.</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">T.O</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">T.Disc</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">SPC.Disc</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">Extra.Disc</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">TAX %</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">TAX AMNT.</strong></th>
                    <th class="border border-neutral-700 dark:border-[#333333] p-2 text-xs text-white"><strong class="font-primary font-medium">Net.AMNT</strong></th>
                  </tr>
                </thead>
                <tbody class="order_items_body">
                  <tr *ngFor="let item of orderDetail" class="text-gray-900 dark:text-white">
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.item_sku }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.item_name }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.booked_qty }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.delivered_qty }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.executed_qty }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.item_trade_price | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.gr_amount | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.trade_offer | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.trade_discount | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.special_discount | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.extra_discount | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.tax_in_percentage }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.tax_in_value | number: '1.2-2' }}</td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs dark:text-gray-200">{{ item.final_price | number: '1.2-2' }}</td>
                  </tr>
                  <!-- Footer Columns -->
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">G.AMNT</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.gross_amount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">T.O.Disc.</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.to_discount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">Trade Disc.</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.trade_discount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">Spc. Disc.</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.special_discount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">Extra. Disc.</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.booker_discount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">Discount PKR.</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.discount_pkr | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">Total TAX</strong></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold dark:text-gray-200"><strong class="font-primary font-medium">{{ orderDetail?.tax_amount | number: '1.2-2' }}</strong></td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold bg-gray-200 dark:bg-neutral-800 text-gray-900 dark:text-white">
                      <strong class="font-primary font-medium">Total AMNT.</strong>
                    </td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold bg-gray-200 dark:bg-neutral-800 text-gray-900 dark:text-white">
                      <strong class="font-primary font-medium">{{ orderDetail?.total_amount | number: '1.2-2' }}</strong>
                    </td>
                  </tr>
                  <tr class="bg-white dark:bg-black text-gray-900 dark:text-white">
                    <td class="border-0 border-right-1 border-neutral-700 dark:border-[#333333] p-2 text-xs" colspan="12"></td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold bg-gray-200 dark:bg-neutral-800 text-gray-900 dark:text-white">
                      <strong class="font-primary font-medium">Recovery AMNT.</strong>
                    </td>
                    <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs font-bold bg-gray-200 dark:bg-neutral-800 text-gray-900 dark:text-white">
                      <strong class="font-primary font-medium">{{ orderDetail?.recovery_amount | number: '1.2-2' }}</strong>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Payment Details -->
            <div class="flex justify-end mt-6">
              <div class="w-full md:w-1/3 Order-Detail-table">
                <h3 class="text-base font-medium text-gray-900 dark:text-white font-primary mb-3">Payment Details</h3>
                <table class="table font-primary w-full border-collapse">
                  <tbody class="order_items_body">
                    <tr class="text-gray-900 dark:text-white">
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">Cash</strong></td>
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">{{ (this.paymentInfo.cash ? this.paymentInfo.cash.amount : 0) | number: '1.2-2' }}</strong></td>
                    </tr>
                    <tr class="text-gray-900 dark:text-white">
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">Cheque</strong></td>
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">{{ (this.paymentInfo.cheque ? this.paymentInfo.cheque.amount : 0) | number: '1.2-2' }}</strong></td>
                    </tr>
                    <tr class="text-gray-900 dark:text-white">
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">Total Payment</strong></td>
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">0</strong></td>
                    </tr>
                    <tr class="text-gray-900 dark:text-white">
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">Credit</strong></td>
                      <td class="border border-neutral-700 dark:border-[#333333] p-2 text-xs"><strong class="font-primary font-medium">{{ (this.paymentInfo.credit ? this.paymentInfo.credit.amount : 0) | number: '1.2-2' }}</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Order Booker List -->
<div class="container mx-auto px-4 pb-24" id="retailer-list">
  <!-- Header -->
  <div class="mt-3 mb-3">
    <div class="flex justify-between items-center text-left">
      <div>
        <h1 class="text-lg text-secondary dark:text-neutral-200 font-primary font-medium mb-0">
          Sale Order <span class="font-light">History</span>
        </h1>
      </div>
      <div></div>
    </div>
  </div>

  <!-- Filter Bar -->
  <div *ngIf="!loading" class="p-2.5 border border-gray-200 dark:border-[#2b2b2b] bg-gray-50 dark:bg-[#141414] rounded-lg mb-3">
    <div class="grid grid-cols-12 gap-1.5 xl:gap-2 text-[13px]">
      <!-- Search Input -->
      <div class="col-span-8">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Search</div>

        <div class="relative w-full">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10 text-gray-500 dark:text-neutral-400">
            <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
            </svg>
          </div>
          <input 
            nz-input
            type="text" 
            id="search-order" 
            placeholder="Search orders..."
            autocomplete="off"
            class="w-full h-8 pl-10 pr-3 border border-gray-300 dark:border-[#333333] rounded-lg bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-primary dark:focus:border-primary font-primary text-sm"
            (input)="onQuickFilterChanged($event)"
          >
       </div>
      </div>
 
      <!-- Start Date Picker -->
      <div class="col-span-2">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Start Date</div>

        <nz-date-picker
          id="startDate"
          [(ngModel)]="startDate"
          (ngModelChange)="onStartDateChange($event)"
          nzPlaceHolder="Select Start Date"
          [nzFormat]="'yyyy-MM-dd'"
          class="w-full !rounded-[5px]">
        </nz-date-picker>
      </div>
      <!-- End Date Picker -->
      <div class="col-span-2">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">End Date</div>

        <nz-date-picker
          id="endDate"
          [(ngModel)]="endDate"
          (ngModelChange)="onEndDateChange($event)"
          nzPlaceHolder="Select End Date"
          [nzFormat]="'yyyy-MM-dd'"
          class="w-full !rounded-[5px]">
        </nz-date-picker>
      </div>
      <!-- Order Type Filter -->
      <div class="col-span-2">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Order Type</div>

        <nz-select
          nzShowSearch
          nzAllowClear
          id="OrderType"
          name="order-type"
          [(ngModel)]="OrderType"
          nzPlaceHolder="All Order Types"
          [nzDropdownMatchSelectWidth]="false"
          [nzDropdownStyle]="{ 'z-index': '9999' }"
          class="w-full">
          <nz-option
            [nzValue]="'0'"
            nzLabel="All">
          </nz-option>
          <nz-option
            [nzValue]="'executed'"
            nzLabel="Executed">
          </nz-option>
          <nz-option
            [nzValue]="'counter_sale'"
            nzLabel="Counter Sale">
          </nz-option>
          <nz-option
            [nzValue]="'spot_sale'"
            nzLabel="Spot Sale">
          </nz-option>
        </nz-select>
      </div>
      <!-- Salesman Filter -->
      <div class="col-span-3">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Salesman</div>

        <nz-select
          nzShowSearch
          nzAllowClear
          id="AllSalesmen"
          name="all-salesmen"
          [(ngModel)]="salesmanId"
          nzPlaceHolder="All Salesmen"
          [nzDropdownMatchSelectWidth]="false"
          [nzDropdownStyle]="{ 'z-index': '9999' }"
          class="w-full">
          <nz-option
            [nzValue]="'0'"
            nzLabel="All Salesmen">
          </nz-option>
          <nz-option
            *ngFor="let sman of criterias.salesmen"
            [nzValue]="sman.id.toString()"
            [nzLabel]="sman.name">
          </nz-option>
        </nz-select>
      </div>
      <!-- Order Booker Filter -->
      <div class="col-span-3">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Order Booker</div>

        <nz-select
          nzShowSearch
          nzAllowClear
          id="OrderBooker"
          name="OrderBooker"
          [(ngModel)]="OrderBooker"
          nzPlaceHolder="All Order Bookers"
          [nzDropdownMatchSelectWidth]="false"
          [nzDropdownStyle]="{ 'z-index': '9999' }"
          class="w-full">
          <nz-option
            *ngFor="let ob of criterias.order_booker"
            [nzValue]="ob.employee_id.toString()"
            [nzLabel]="ob.employee_name">
          </nz-option>
        </nz-select>
      </div>
      <!-- Segment Filter -->
      <div class="col-span-3">
      <div class="dark:text-gray-300 text-[12px] mb-1.5">Segment</div>

        <nz-select
          nzShowSearch
          nzAllowClear
          id="segment"
          name="segment"
          [(ngModel)]="segment"
          nzPlaceHolder="All Segments"
          [nzDropdownMatchSelectWidth]="false"
          [nzDropdownStyle]="{ 'z-index': '9999' }"
          class="w-full">
          <nz-option
            [nzValue]="'0'"
            nzLabel="All">
          </nz-option>
          <nz-option
            *ngFor="let s of criterias.segments"
            [nzValue]="s.id.toString()"
            [nzLabel]="s.name">
          </nz-option>
        </nz-select>
      </div>
      <div class="col-span-1 mt-auto">
        <button
          (click)="getOrderBookersList()"
          class="w-full px-3 py-2 leading-none text-[14px] border border-primary rounded-[5px] font-primary bg-primary text-white hover:bg-blue-700 hover:border-blue-700 focus:bg-blue-700 focus:border-blue-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-400 disabled:border-gray-400 disabled:text-gray-200 transition-all duration-200">
          Search
        </button>
      </div>
    </div>
  </div>

  <!-- AG Grid Section -->
  <div class="bg-white dark:bg-[#1a1a1a] border border-gray-200 dark:border-[#333333] rounded-lg shadow-[0_0_5px_#0000001a] dark:shadow-[0_0_5px_#ffffff1a]">
    <div>
      <!-- AG Grid with Quartz theme -->
      <div *ngIf="!loading" class="ag-theme-quartz ag-grid-container">
        <div class="flex justify-between items-center text-secondary dark:border-[#333333] border-b rounded-tl-lg rounded-tr-lg text-base py-[10px] px-[15px] relative bg-gradient-to-t from-[#f9f9f9] to-[#ffffff] dark:bg-black dark:from-transparent dark:to-transparent shadow-none">
          <div>
            <h2 class="relative pl-0 mb-0 text-secondary dark:text-gray-400 before:content-[''] before:absolute before:w-[2px] before:h-[18px] before:bg-primary before:left-[-16px] before:top-[5px] font-primary font-medium">
              Sale Order &nbsp;<span class="font-light">History List</span>
            </h2>
          </div>
          <div class="text-secondary dark:text-white">
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-4 w-4 text-gray-400" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5014 7.00039C11.5014 7.59133 11.385 8.1765 11.1588 8.72246C10.9327 9.26843 10.6012 9.7645 10.1833 10.1824C9.76548 10.6002 9.2694 10.9317 8.72344 11.1578C8.17747 11.384 7.59231 11.5004 7.00136 11.5004C6.41041 11.5004 5.82525 11.384 5.27929 11.1578C4.73332 10.9317 4.23725 10.6002 3.81938 10.1824C3.40152 9.7645 3.07005 9.26843 2.8439 8.72246C2.61776 8.1765 2.50136 7.59133 2.50136 7.00039C2.50136 5.80691 2.97547 4.66232 3.81938 3.81841C4.6633 2.97449 5.80789 2.50039 7.00136 2.50039C8.19484 2.50039 9.33943 2.97449 10.1833 3.81841C11.0273 4.66232 11.5014 5.80691 11.5014 7.00039ZM10.6814 11.7404C9.47574 12.6764 7.95873 13.1177 6.43916 12.9745C4.91959 12.8314 3.51171 12.1145 2.50211 10.9698C1.49252 9.8251 0.957113 8.33868 1.0049 6.81314C1.05268 5.28759 1.68006 3.83759 2.75932 2.75834C3.83857 1.67908 5.28856 1.0517 6.81411 1.00392C8.33966 0.956136 9.82608 1.49154 10.9708 2.50114C12.1154 3.51073 12.8323 4.91862 12.9755 6.43819C13.1187 7.95775 12.6773 9.47476 11.7414 10.6804L14.5314 13.4704C14.605 13.539 14.6642 13.6218 14.7051 13.7138C14.7461 13.8058 14.7682 13.9052 14.77 14.0059C14.7717 14.1066 14.7532 14.2066 14.7155 14.3C14.6778 14.3934 14.6216 14.4782 14.5504 14.5494C14.4792 14.6206 14.3943 14.6768 14.301 14.7145C14.2076 14.7522 14.1075 14.7708 14.0068 14.769C13.9061 14.7672 13.8068 14.7452 13.7148 14.7042C13.6228 14.6632 13.54 14.6041 13.4714 14.5304L10.6814 11.7404Z" fill="currentColor"></path>
                </svg>
              </div>
              <input 
                type="text" 
                id="filter-text-box-header" 
                placeholder="Search orders..." 
                autocomplete="off"
                class="w-56 pl-[34px] pr-4 py-2 h-[32px] border outline-none border-gray-300 dark:border-[#333333] rounded-lg bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 dark:focus:border-primary focus:border-primary font-primary text-sm"
                (input)="onQuickFilterChanged($event)"
              />
            </div>
          </div>
        </div>

        <ag-grid-angular
          [rowData]="orders"
          [columnDefs]="columnDefs"
          [defaultColDef]="defaultColDef"
          [pagination]="true"
          [paginationPageSize]="10"
          [paginationPageSizeSelector]="[10, 20, 50, 100]"
          [suppressPaginationPanel]="false"
          [domLayout]="'autoHeight'"
          [animateRows]="true"
          [rowSelection]="{ type: 'single' }"
          [theme]="'legacy'"
          (gridReady)="onGridReady($event)">
        </ag-grid-angular>
      </div>
      
      <div *ngIf="loading" class="flex justify-center items-center p-8">
        <app-loader-white></app-loader-white>
      </div>
    </div>
  </div>
</div>
