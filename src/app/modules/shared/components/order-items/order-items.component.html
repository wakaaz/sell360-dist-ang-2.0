
<!-- Delete Product Modal -->
<div
  *ngIf="showDeleteModal"
  class="fixed inset-0 z-50 overflow-y-auto"
  aria-labelledby="exampleModalLabel"
  role="dialog"
  aria-modal="true"
>
  <!-- Background overlay -->
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 dark:bg-black/50 dark:backdrop-blur-sm transition-opacity" (click)="closeDeleteModal()"></div>
  
  <!-- Modal container -->
  <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
    <div class="relative transform overflow-hidden rounded-lg bg-white dark:bg-[#1f1f1f] text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg" (click)="$event.stopPropagation()">
      <!-- Red top border -->
      <div class="h-1 bg-red-600"></div>
      
      <!-- Modal header -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4 border-b border-gray-200 dark:border-[#333333]">
        <div class="flex items-center justify-between">
          <h3 class="text-base font-semibold leading-6 text-gray-900 dark:text-neutral-200 font-primary" id="exampleModalLabel">
            Delete
          </h3>
          <button
            type="button"
            class="rounded-md bg-white dark:bg-[#1f1f1f] text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors"
            (click)="closeDeleteModal()"
            aria-label="Close"
          >
            <span class="sr-only">Close</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Modal body -->
      <div class="bg-white dark:bg-[#1f1f1f] px-3 pb-3 pt-4 sm:p-5 sm:pb-4">
        <div class="sm:flex sm:items-start">
          <div class="text-center sm:mt-0 sm:text-left w-full pb-6">
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Are you sure you want to delete?
            </p>
          </div>
        </div>
      </div>
      
      <!-- Modal footer -->
      <div class="bg-gray-50 dark:bg-[#151515] px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 border-t border-gray-200 dark:border-[#303030]">
        <div class="flex justify-end gap-2 flex-wrap">
          <button
            type="button"
            class="px-6 py-2 leading-none text-[13px] border border-primary rounded-[5px] font-primary bg-primary text-white hover:bg-primary hover:text-white focus:bg-primary focus:text-white transition-colors"
            (click)="deleteProductAndClose()"
          >
            Booked Qty
          </button>
          <button
            *ngIf="selecteddeleteSchemes?.length"
            type="button"
            class="px-6 py-2 leading-none text-[13px] border border-primary rounded-[5px] font-primary bg-primary text-white hover:bg-primary hover:text-white focus:bg-primary focus:text-white transition-colors"
            (click)="deleteProductAndClose(1)"
          >
            Booked Qty AND Schemes
          </button>
          <button
            type="button"
            class="px-6 py-2 leading-none text-[13px] rounded-[5px] font-primary border border-primary dark:border-[#717171] bg-transparent text-primary dark:text-white dark:opacity-70 hover:bg-red-600 hover:border-red-600 dark:hover:border-red-600 hover:text-white focus:bg-red-600 focus:border-red-600 focus:text-white transition-colors"
            (click)="closeDeleteModal()"
            aria-label="Close"
          >
            No
          </button>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="py-3 flex justify-between items-center">
  <h2 *ngIf="orderType === 'dispatch'"
  class="relative flex items-start text-base pl-0 text-secondary dark:text-neutral-300 before:content-[''] before:absolute before:w-[2px] before:h-[18px] before:bg-primary before:left-[-16px] before:top-[3px] font-primary font-medium">
  Product &nbsp;<span class="font-light">List</span>
</h2>

<h2  *ngIf="orderType === 'execution'"
class="relative ml-4 flex items-start text-base pl-0 text-secondary dark:text-neutral-300 before:content-[''] before:absolute before:w-[2px] before:h-[18px] before:bg-primary before:left-[-16px] before:top-[3px] font-primary font-medium">
Orders &nbsp;<span class="font-light">Detail</span>
</h2>

<a
  *ngIf="orderType === 'execution'"
  (click)="openReturnedProduct($event)"
  class="px-3 py-1.5 ml-auto mr-3 leading-none text-[13px] border border-primary rounded-[5px] font-primary bg-primary text-white hover:bg-primary hover:text-white focus:bg-primary focus:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors inline-flex items-center"
>
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="w-4 h-4 mr-0.5" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
</svg>
  <span>Add Return</span>
</a>

<a
  id="productlist01"
  (click)="openProductsList($event)"
  class="px-3 py-1.5 leading-none text-[13px] border border-primary rounded-[5px] font-primary bg-primary text-white hover:bg-primary hover:text-white focus:bg-primary focus:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors inline-flex items-center"
>
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="w-4 h-4 mr-0.5" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
</svg>
  <span>Add Product</span>
</a>

</div>

<div class="w-full">
  <div class="overflow-x-auto rounded-[5px] overflow-hidden">
    <table class="w-full border-collapse bg-white dark:bg-[#1a1a1a]">
    <thead>
        <tr class="bg-gray-100 dark:bg-[#2d2d2d]">
          <th class="font-primary font-medium w-[200px] text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px] text-left">Product Name</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-neutral-200 border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">{{ orderType === "dispatch" ? "Bkd Qty" : "Disp.Qty" }}</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">{{ orderType === "dispatch" ? "Dely.Qty" : "Exec.Qty" }}</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">T.P.</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">GR.Amt</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">T.O.</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">T.Disc</th>
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">Spec.Disc</th>
          <th *ngIf="permissions?.Secondary_Orders?.extra_discount" class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">B.Disc</th>
          <th title="General Sales Tax" class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">GST</th>
          <th title="Advance Income Tax" class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">AIT</th> 
          <th class="font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">Net Amt</th>
          <th class="w-[48px] font-primary font-medium text-[12px] text-gray-900 dark:text-[#e0e0e0] border border-white dark:border-[#333333] align-middle px-[5px] py-[2px]">Action</th>
      </tr>
    </thead>
      <tbody class="divide-y divide-gray-200 dark:divide-[#333333] bg-white dark:bg-[#1a1a1a]">
      <tr 
        *ngFor="let item of orderDetail?.items; let i = index"
          [ngClass]="((orderType !== 'execution' && !item.item_quantity_booker) || (orderType === 'execution' && !item.dispatch_qty)) && item.isDeleted ? 'hidden': 'hover:bg-gray-50 dark:hover:bg-[#2d2d2d]'"
          class="transition-colors bg-white dark:bg-[#1a1a1a]"
      >
          <td class="w-[200px] text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          {{ item.item_name }}  
          <!-- ({{item.selectedScheme ?item.selectedScheme.title:''}} id-{{item.scheme_id}}) (slb-id: {{item.slab_id}}) (LDIS:{{item.loyalty_offer_discount_pkr ? (+item.loyalty_offer_discount_pkr *  +item.stockQty | number: "1.2-2"):''}}) -->
        </td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ orderType !== "execution" ? item.item_quantity_booker : item.dispatch_qty || 0 }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <input
            type="number"
            (paste)="$event.preventDefault()"
            [id]="item.item_id"
            [disabled]="isChequeAdded || isCreditAdded"
            [name]="item.item_name"
            [autofocus]="item.item_id==item_id"
            (keyup)="setQuantity(item)"
            (keydown)="isNumber($event, 'quantity')"
            [(ngModel)]="item.stockQty"
              class="px-[2px] m-0 text-[12px] shadow-none h-[22px] w-[52px] border border-[#e2e6ea] dark:border-[#333333] bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white focus:outline-none focus:border-primary dark:focus:border-primary rounded-[5px]"
            placeholder="0"
          />
        </td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.item_trade_price | number: "1.2-2" }}</td> 
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ +(item.original_price?item.original_price:item.original_ampunt) * +item.stockQty || 0 | number: "1.2-2" }}</td>
          <td [ngClass]="item.scheme_quantity_free > 0 ? 'bg-[#05C71F6E] dark:bg-[#05C71F4D]' : ''" class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.scheme_id && item.scheme_type =='bundle_offer' ?  ( (+item.scheme_discount * +item.scheme_bundle_interval) | number: "1.2-2") : +item.stockQty * item.scheme_discount | number: "1.2-2" }} {{item.scheme_quantity_free > 0 ? "("+item.scheme_quantity_free+")":"" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.trade_discount }} {{ item.slab_discount_type == 'percentage' ? '%':''}} ({{item.trade_discount_pkr * item.stockQty  | number: "1.2-2"}})</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.special_discount * item.stockQty | number: "1.2-2" }}</td>
          <td *ngIf="permissions?.Secondary_Orders?.extra_discount" class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <input
            type="text" 
            (paste)="$event.preventDefault()"
            id="extraDiscount-{{item.item_id}}"
            [disabled]="isChequeAdded || isCreditAdded || +item.stockQty < 1"
            [name]="item.item_id"
            [(ngModel)]="item.extra_discount"
            (keyup)="calculateExtraDiscount(item)"
            (keydown)="isNumber($event)"
              class="px-[2px] m-0 text-[12px] shadow-none h-[22px] w-[52px] border border-[#e2e6ea] dark:border-[#333333] bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white focus:outline-none focus:border-primary dark:focus:border-primary disabled:opacity-50 disabled:cursor-not-allowed rounded-[5px]"
            placeholder="0"
          />
        </td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.gst_tax_amount_temp || 0 | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.adv_inc_tax_amount_temp || 0 | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.total_amount_after_tax || 0 | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <button
            *ngIf="!item.isDeleted"
            [disabled]="isChequeAdded || isCreditAdded"
            type="button"
            (click)="confirmDelete(item)"
              class="px-[4px] py-[4px] text-[11px] rounded-[5px] capitalize bg-[#e20000] hover:bg-[#c50000] text-white text-center font-semibold leading-none min-w-[22px] disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
          >
            Delete 
          </button>
        </td>
      </tr>
      <tr
        *ngFor="let item of orderDetail?.returned_items; let ind = index"
          [ngClass]="!item.item_quantity_booker && item.isDeleted ? 'hidden' : 'hover:bg-gray-50 dark:hover:bg-[#2d2d2d]'"
          class="transition-colors bg-white dark:bg-[#1a1a1a]"
        >
          <td class="w-[200px] text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.item_name }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.dispatch_qty || 0 }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <input
            type="text"
            (paste)="$event.preventDefault()"
            [id]="item.item_id"
            [disabled]="isChequeAdded || isCreditAdded"
            [name]="item.item_name"
            (keyup)="setReturnedQty(item)"
            (keydown)="isNumber($event, 'quantity')"
            [(ngModel)]="item.stockQty"
            [max]="999999"
              class="px-[2px] m-0 text-[12px] shadow-none h-[22px] w-[52px] border border-[#e2e6ea] dark:border-[#333333] bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white focus:outline-none focus:border-primary disabled:opacity-50 disabled:cursor-not-allowed rounded-[5px]"
            placeholder="0"
          />
        </td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.item_trade_price | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.gross_amount || 0 | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.scheme_discount | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.trade_discount }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.special_discount * item.stockQty | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <input
            type="text"
            (paste)="$event.preventDefault()"
            [disabled]="isChequeAdded || isCreditAdded || +item.stockQty < 1"
            id="extra-{{item.item_id}}"
            [name]="item.item_name" 
            [(ngModel)]="item.extra_discount"
            (keyup)="setExtraDiscount(item)"
            (keydown)="isNumber($event)"
              class="px-[2px] m-0 text-[12px] shadow-none h-[22px] w-[52px] border border-[#e2e6ea] dark:border-[#333333] bg-white dark:bg-[#1a1a1a] text-gray-900 dark:text-white focus:outline-none focus:border-primary disabled:opacity-50 disabled:cursor-not-allowed rounded-[5px]"
            placeholder="0"
          />
        </td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.gst_tax_amount_temp || 0 | number: "1.2-2"}}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.adv_inc_tax_amount_temp || 0 | number: "1.2-2"}}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">{{ item.total_amount_after_tax || 0 | number: "1.2-2" }}</td>
          <td class="text-[12px] text-gray-900 dark:text-[#e0e0e0] px-[4px] py-[5px] align-middle leading-none">
          <button
            *ngIf="!item.isDeleted"
            type="button"
            (click)="selectedItem = item"
              class="px-[4px] py-[4px] text-[11px] rounded-[5px] capitalize bg-[#e20000] hover:bg-[#c50000] text-white text-center font-semibold leading-none min-w-[22px] transition-colors"
            data-toggle="modal"
            data-target="#exampleModal-del"
          >
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  </div>
  <h4
    *ngIf="!orderDetail?.items?.length && !orderDetail?.returned_items?.length"
    class="text-center text-gray-300 dark:text-gray-600 mt-4"
  >
    No items to display yet please select order!
  </h4>

  <div class="flex justify-end gap-4 mt-4">
    <div class="flex-1"></div>
    <div class="w-[318px] min-h-[173px] text-[13px] px-2 py-[5px]  ml-auto mr-0 bg-[#f7f7f7] dark:bg-[#2d2d2d] rounded-md border border-[#ececec] dark:border-[#333333]">
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Gross Amount:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ grossAmount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Trade Offer:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ totalSchemeDiscount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Trade Discount:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ totalMerchantDiscount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Special Discount:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ totalSpecialDiscount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Booker Discount:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ totalBookerDiscount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Loyalty Discount:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ totalloyaltyDiscount | number: "1.2-2" }}</span>
        </div>
      </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300" title="General Sales Tax">General Sales Tax:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-neutral-300 text-right block">{{ gst_tax | number: "1.2-2" }}</span>
        </div>
      </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300" title="Advance Income Tax">Advance Income Tax:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-neutral-300 text-right block">{{ adv_inc_tax | number: "1.2-2" }}</span>
        </div>
      </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Total Tax:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-neutral-300 text-right block">{{ totalTax| number: "1.2-2" }}</span>
        </div>
          </div>
      <div *ngIf="orderType === 'execution'" class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-neutral-300">Less Return:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-neutral-300 text-right block">{{ returnAmount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div *ngIf="orderType !== 'execution'" class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-200">Total Amount Due:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-200">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-right block">{{ netAmount | number: "1.2-2" }}</span>
        </div>
      </div>
      <div *ngIf="orderType === 'execution'" class="flex border-b border-[#e8e6e6] dark:border-[#363636]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-200">Total Bill:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-200">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-right block">{{
              grossAmount - 
              totalSchemeDiscount - 
              totalMerchantDiscount - 
              totalSpecialDiscount - 
              totalloyaltyDiscount - 
              totalBookerDiscount + 
              returnAmount +
                totalTax | number: "1.2-2"
            }}</span>
          </div>
        </div>
      </div>
    <div *ngIf="orderType === 'execution'" class="w-[318px] min-h-[173px] text-[13px] px-2 py-[5px] ml-auto mr-0 bg-[#f7f7f7] dark:bg-[#2d2d2d] rounded-md border border-[#ececec] dark:border-[#333333]">
      <!-- <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Amount Due:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ dueAmount | number: "1.2-2" }}</span>
          </div>
        </div> -->
      <!-- <div *ngIf="currentTab === 1" class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Recovery:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <div class="w-1/2 float-right">
              <input
                type="number"
              class="text-right font-[Rationale,sans-serif] text-[18px] px-[2px] h-[calc(1.25rem+2px)] text-gray-900 dark:text-[#e0e0e0] bg-white dark:bg-[#1a1a1a] border border-[#e2e6ea] dark:border-[#333333]"
                [disabled]="isChequeAdded || isCreditAdded"
                name="recovered"
                id="recovered"
                [(ngModel)]="orderDetail.recovered"
                (keydown)="isNumber($event)"
                (keyup)="checkRecovery()"
              />
            </div>
          </div>
        </div> -->
      <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Net Receivable:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ receivableAmount | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Cheque:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ cheque?.amount_received || 0 | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Cash Payment:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ cash?.amount_received || 0 | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-300">Total Payment</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-[#0038ba] dark:text-neutral-300">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-right block">{{ totalPayment | number: "1.2-2" }}</span>
        </div>
          </div>
      <div class="flex border-b border-[#e8e6e6] dark:border-[#333333]">
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary text-gray-900 dark:text-[#e0e0e0]">Credit:</div>
        <div class="w-1/2 px-[2px] leading-[1.5] font-primary">
          <span class="font-[Rationale,sans-serif] leading-[1.1] text-[18px] text-gray-900 dark:text-[#e0e0e0] text-right block">{{ credit?.amount_received || 0 | number: "1.2-2" }}</span>
        </div>
      </div>
    </div>
  </div>
</div>


